name = "clawverify"
account_id = "b8f2c66f1848dff476faa874282d781e"
main = "src/index.ts"
compatibility_date = "2026-02-11"

routes = [
  { pattern = "clawverify.com/*", zone_name = "clawverify.com" },
  { pattern = "www.clawverify.com/*", zone_name = "clawverify.com" }
]

[vars]
ENVIRONMENT = "production"
CLAWCLAIM_BASE_URL = "https://clawclaim.com"
CLAWSCOPE_BASE_URL = "https://clawscope.com"
CONTROL_VERIFY_TIMEOUT_MS = "5000"
CONTROL_KEY_TRANSPARENCY_MAX_AGE_SECONDS = "3600"

# Comma-separated allowlist of trusted gateway receipt signer DIDs (did:key:...)
# Required for fail-closed receipt verification.
# Set this via Cloudflare dashboard or wrangler vars/secrets.
# GATEWAY_RECEIPT_SIGNER_DIDS = "did:key:..."

# Comma-separated allowlist of trusted attester DIDs (did:key:...) for proof bundle attestations.
# Without this, attestations do NOT uplift trust tiers (fail-closed).
# ATTESTATION_SIGNER_DIDS = "did:key:..."

# Comma-separated allowlist of trusted signer DIDs (did:key:...) for witnessed web receipts (POH-US-018).
# Required for fail-closed web receipt verification.
# WEB_RECEIPT_SIGNER_DIDS = "did:key:..."

# Comma-separated allowlist of trusted signer DIDs (did:key:...) for execution_attestation verification (CEA-US-010).
# Required for fail-closed execution attestation verification and proof_tier uplift.
# EXECUTION_ATTESTATION_SIGNER_DIDS = "did:key:..."

# Comma-separated allowlist of trusted TEE root IDs for tee_execution attestations (POHVN-US-008).
# Required for fail-closed tee_execution verification.
# TEE_ATTESTATION_ROOT_ALLOWLIST = "tee_root_prod_v1"

# Comma-separated allowlist of trusted TCB versions for tee_execution attestations (POHVN-US-008).
# Required for fail-closed tee_execution verification.
# TEE_ATTESTATION_TCB_ALLOWLIST = "tcb_prod_2026q1"

# Optional comma-separated revocation deny lists for tee_execution policy checks.
# TEE_ATTESTATION_ROOT_REVOKED = "tee_root_compromised"
# TEE_ATTESTATION_TCB_REVOKED = "tcb_revoked_2026q1"

# Comma-separated allowlist of trusted repo_claim_id values for commit_proof verification.
# Required for fail-closed commit proof verification.
# Set via: wrangler secret put CLAWCLAIM_REPO_CLAIM_ALLOWLIST
# CLAWCLAIM_REPO_CLAIM_ALLOWLIST = "repo:github:clawbureau/clawbureau"

[[d1_databases]]
binding = "AUDIT_LOG_DB"
database_name = "clawverify-audit-log"
database_id = "9150187b-07b2-4b44-9be8-46d8934ab785"

[env.staging]
name = "clawverify-staging"
routes = [
  { pattern = "staging.clawverify.com/*", zone_name = "clawverify.com" }
]

[env.staging.vars]
ENVIRONMENT = "staging"
CLAWCLAIM_BASE_URL = "https://staging.clawclaim.com"
CLAWSCOPE_BASE_URL = "https://staging.clawscope.com"
CONTROL_VERIFY_TIMEOUT_MS = "5000"
CONTROL_KEY_TRANSPARENCY_MAX_AGE_SECONDS = "3600"

[[env.staging.d1_databases]]
binding = "AUDIT_LOG_DB"
database_name = "clawverify-audit-log-staging"
database_id = "1aa0fbf8-6464-42e9-afaf-676535bcbef1"
