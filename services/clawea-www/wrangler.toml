# clawea-www -- Enterprise marketing + SEO site for clawea.com
#
# This worker serves the public-facing marketing pages, programmatic SEO
# content, sitemap, and robots.txt. The platform API worker handles /v1/*
# routes on the same domain.
#
# Route precedence: this worker catches /* EXCEPT /v1/*, /health, /staging/*
# which the platform API worker handles via its own route bindings.

name = "clawea-www"
account_id = "b8f2c66f1848dff476faa874282d781e"
main = "src/index.ts"
compatibility_date = "2026-02-01"

routes = [
  { pattern = "clawea.com/*", zone_name = "clawea.com" },
  { pattern = "www.clawea.com/*", zone_name = "clawea.com" }
]

[vars]
ENVIRONMENT = "production"
SITE_URL = "https://www.clawea.com"
INDEXNOW_KEY = "edf20368863e485aa92e1b95fa15872a"
INDEXNOW_MAX_ATTEMPTS = "4"
INDEXNOW_RETRY_BASE_MS = "900"
INDEXNOW_RETRY_MAX_MS = "30000"
GOOGLE_INDEX_MAX_ATTEMPTS = "4"
GOOGLE_INDEX_RETRY_BASE_MS = "1200"
GOOGLE_INDEX_RETRY_MAX_MS = "45000"
INDEX_QUEUE_ENABLED = "1"
INDEX_QUEUE_MAX_ENTRIES_PER_RUN = "40"
INDEX_QUEUE_INDEXNOW_MAX_ATTEMPTS = "8"
INDEX_QUEUE_GOOGLE_MAX_ATTEMPTS = "6"
INDEX_QUEUE_RETRY_BASE_MS = "60000"
INDEX_QUEUE_RETRY_MAX_MS = "3600000"

# Secrets (set with `wrangler secret put <NAME>`):
# - INDEX_AUTOMATION_TOKEN
# - GOOGLE_INDEXING_SERVICE_ACCOUNT_JSON

[placement]
mode = "smart"

[triggers]
crons = ["*/20 * * * *"]

# ---------- R2 (article storage) ----------
[[r2_buckets]]
binding = "ARTICLES"
bucket_name = "clawea-www"

# ---------- Staging ----------
[env.staging]
name = "clawea-www-staging"
routes = [
  { pattern = "staging-www.clawea.com/*", zone_name = "clawea.com" }
]

[env.staging.triggers]
crons = ["*/20 * * * *"]

[env.staging.vars]
ENVIRONMENT = "staging"
SITE_URL = "https://staging-www.clawea.com"
INDEXNOW_KEY = "edf20368863e485aa92e1b95fa15872a"
INDEXNOW_MAX_ATTEMPTS = "4"
INDEXNOW_RETRY_BASE_MS = "900"
INDEXNOW_RETRY_MAX_MS = "30000"
GOOGLE_INDEX_MAX_ATTEMPTS = "4"
GOOGLE_INDEX_RETRY_BASE_MS = "1200"
GOOGLE_INDEX_RETRY_MAX_MS = "45000"
INDEX_QUEUE_ENABLED = "1"
INDEX_QUEUE_MAX_ENTRIES_PER_RUN = "20"
INDEX_QUEUE_INDEXNOW_MAX_ATTEMPTS = "6"
INDEX_QUEUE_GOOGLE_MAX_ATTEMPTS = "6"
INDEX_QUEUE_RETRY_BASE_MS = "30000"
INDEX_QUEUE_RETRY_MAX_MS = "1800000"

[[env.staging.r2_buckets]]
binding = "ARTICLES"
bucket_name = "clawea-www-staging"
