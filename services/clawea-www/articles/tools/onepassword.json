{
  "slug": "tools/onepassword",
  "title": "1Password for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "\n<p>1Password stores the credentials your agents need to authenticate with external services: API keys, OAuth tokens, database passwords, and service account secrets. When an OpenClaw agent retrieves a secret from 1Password via official API, the risk is not the vault itself but the execution layer around it: a misconfigured skill or malicious plugin can exfiltrate, over-scope, or replay those credentials without constraint. The fix is policy-as-code enforcement through Work Policy Contracts (WPC), scoped tokens (CST), and gateway receipts, not prompt-level instructions that the model can ignore.</p>\n\n<p>1Password can be connected via official API with enterprise buildout controls. It is not available as a native connector today. Write and admin actions require WPC approval gates, scoped tokens, and explicit least-privilege auth scopes.</p>\n\n<h2>Step-by-step runbook</h2>\n\n<ol>\n<li><strong>Create a 1Password Service Account.</strong> In your 1Password admin console, provision a service account with read-only access to a single vault designated for agent secrets. Do not grant write or admin permissions at this stage.</li>\n\n<li><strong>Author a WPC for vault access.</strong> Define a Work Policy Contract that pins the allowed 1Password vault ID, the permitted operations (read-only item retrieval), and the maximum secret categories the agent may request (e.g., <code>API_CREDENTIAL</code>, <code>DATABASE</code>). Register it in the WPC registry served by clawcontrols.</li>\n\n<li><strong>Issue a job-scoped CST.</strong> Use clawscope to mint a scoped token bound to the WPC policy hash. The CST restricts the agent session to the specific job and vault scope. Pin the policy hash so the token cannot be reused against a different or relaxed policy.</li>\n\n<li><strong>Wire the 1Password SDK call through clawproxy.</strong> Route the agent's HTTP calls to the 1Password Connect Server or SDK endpoint through clawproxy. This produces gateway receipts for every secret-fetch operation, recording the timestamp, target endpoint, and CST used.</li>\n\n<li><strong>Enable sandbox isolation.</strong> Run the agent session with OpenClaw sandboxing set to <code>\"all\"</code> mode. Do not bind-mount the 1Password service account token file into the container; inject it as an environment variable scoped to the sandbox session.</li>\n\n<li><strong>Collect the proof bundle.</strong> After the job completes, the harness assembles a proof bundle containing all gateway receipts, the WPC hash, and the CST scope hash. Store the resulting Trust Pulse artifact for audit and replay checks.</li>\n</ol>\n\n<h2>Threat model</h2>\n\n<table>\n<thead>\n<tr><th>Threat</th><th>What happens</th><th>Control</th></tr>\n</thead>\n<tbody>\n<tr>\n<td>Malicious plugin exfiltrates secrets to external endpoint</td>\n<td>Plugin reads a vault item, then POSTs the plaintext to an attacker-controlled URL</td>\n<td>Egress allowlists (planned, can be implemented outside clawproxy) restrict outbound destinations. Sandbox network isolation limits reachable hosts.</td>\n</tr>\n<tr>\n<td>Over-scoped service account</td>\n<td>Agent retrieves secrets from vaults it should never access (HR, finance, infrastructure)</td>\n<td>WPC pins the allowed vault ID and item categories. CST policy hash pinning ensures the token only works against that exact policy.</td>\n</tr>\n<tr>\n<td>Credential replay across jobs</td>\n<td>A CST or fetched secret is reused in a later, unauthorized job</td>\n<td>Marketplace anti-replay binding ties the CST to a single job. Gateway receipts record each fetch, making replay detectable in the proof bundle.</td>\n</tr>\n<tr>\n<td>Prompt injection triggers write operation</td>\n<td>Injected prompt convinces agent to update or delete a vault item</td>\n<td>WPC explicitly restricts operations to read-only. The 1Password service account itself should have no write grants. Policy-as-code blocks the call before it reaches the vault.</td>\n</tr>\n<tr>\n<td>Secret logged in model context</td>\n<td>Retrieved password appears in model call, persisted in logs</td>\n<td>OpenClaw's <code>logging.redactSensitive</code> setting should be active. Gateway receipts record the model call metadata but not the secret payload.</td>\n</tr>\n</tbody>\n</table>\n\n<p>Prompt-only guardrails (\"do not leak secrets\") fail because the model has no enforcement mechanism. A WPC is a signed, hash-addressed artifact that the proxy and token issuer verify before the call executes. The model never gets to decide whether the policy applies.</p>\n\n<h2>Policy-as-code example</h2>\n\n<pre><code>{\n  \"wpc_version\": \"1.0\",\n  \"name\": \"1password-readonly-agent\",\n  \"tool_scope\": {\n    \"integration\": \"onepassword\",\n    \"auth_mode\": \"service_account\",\n    \"allowed_vaults\": [\"vault_agent_secrets_prod\"],\n    \"allowed_operations\": [\"read_item\"],\n    \"allowed_categories\": [\"API_CREDENTIAL\", \"DATABASE\"],\n    \"deny_operations\": [\"create_item\", \"update_item\", \"delete_item\"]\n  },\n  \"cst_constraints\": {\n    \"max_ttl_seconds\": 900,\n    \"policy_hash_pin\": true,\n    \"job_scoped\": true\n  },\n  \"sandbox\": {\n    \"mode\": \"all\",\n    \"network_egress\": [\"connect.1password.com\", \"api.1password.com\"],\n    \"workspace_access\": \"none\"\n  }\n}</code></pre>\n\n<p>The <code>deny_operations</code> array is enforced at the WPC level, not as a prompt suggestion. The <code>network_egress</code> field documents the intended allowlist; note that egress allowlists enforced outside clawproxy are planned and can be implemented as part of enterprise buildout.</p>\n\n<h2>What proof do you get?</h2>\n\n<p>Model-assisted runs that touch 1Password produce gateway receipts and proof bundles for audit and replay checks. Each gateway receipt records the proxied call metadata: target endpoint, HTTP method, timestamp, and the CST that authorized it. Receipts are signed by clawproxy.</p>\n\n<p>The proof bundle aggregates all receipts from the job session, the WPC policy hash, and the CST scope hash into a single verifiable artifact. This bundle can be submitted to clawverify for trust-tier and proof-tier assessment. The resulting Trust Pulse artifact is stored in the marketplace viewer for compliance teams and auditors to inspect.</p>\n\n<p>What you can confirm from the bundle: which vault items were accessed, when, under which policy, and by which scoped token. What you cannot confirm (yet): whether the 1Password Connect Server itself was unmodified. Transparency log inclusion proofs for vault-side operations are planned.</p>\n\n<h2>Rollback posture</h2>\n\n<table>\n<thead>\n<tr><th>Action</th><th>Safe rollback</th><th>Evidence</th></tr>\n</thead>\n<tbody>\n<tr>\n<td>Agent read a secret it should not have</td>\n<td>Rotate the exposed credential in 1Password. Revoke the CST via clawscope. Update the WPC to narrow <code>allowed_categories</code>.</td>\n<td>Gateway receipts show exactly which items were fetched and when.</td>\n</tr>\n<tr>\n<td>Service account was over-scoped</td>\n<td>Restrict the 1Password service account to the correct vault. Re-register a tighter WPC.</td>\n<td>Proof bundle shows the vault IDs accessed under the old policy.</td>\n</tr>\n<tr>\n<td>Suspected secret exfiltration</td>\n<td>Rotate all secrets in the affected vault. Revoke all active CSTs for the job. Review sandbox network logs.</td>\n<td>Gateway receipts plus sandbox logs (if captured) identify the window of exposure.</td>\n</tr>\n<tr>\n<td>WPC was too permissive</td>\n<td>Publish a new WPC version with narrower scope. Old hash becomes invalid for new CST issuance.</td>\n<td>WPC registry retains both versions for diff and audit.</td>\n</tr>\n</tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is 1Password integration available as a native connector today?</h3>\n<p>No. 1Password can be connected via official API with enterprise buildout controls. The integration is planned and uses OAuth, API key, or service account authentication modes. Do not assume out-of-the-box support before release gates pass.</p>\n\n<h3>Why can't I just tell the agent \"don't leak secrets\" in the system prompt?</h3>\n<p>Prompt instructions are suggestions to the model, not enforcement boundaries. A sufficiently creative prompt injection or a malicious plugin can override them. A WPC is a signed policy artifact verified by clawproxy and clawscope before any call executes. The model never evaluates the policy; the infrastructure does.</p>\n\n<h3>Can the agent write to 1Password vaults?</h3>\n<p>Only if the WPC explicitly allows write operations and the 1Password service account has write grants. The recommended default is read-only. Write and admin actions require WPC approval gates, scoped tokens, and explicit least-privilege auth scopes.</p>\n\n<h3>How do I limit which secrets the agent can see?</h3>\n<p>Use two layers: the 1Password service account should be scoped to a single vault with only the items the agent needs. The WPC should further restrict <code>allowed_categories</code> so the agent cannot request item types outside its task scope.</p>\n\n<h3>What happens if the CST expires mid-job?</h3>\n<p>The clawproxy rejects the next API call with an authorization error. The agent cannot fall back to a cached token because CSTs are job-scoped and verified on each request. The operator must issue a new CST or extend the <code>max_ttl_seconds</code> in the WPC for longer-running jobs.</p>\n\n<h2>Sources</h2>\n<ul>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security</a></li>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandboxing.md\">OpenClaw: Sandboxing</a></li>\n<li><a href=\"https://1password.com/press/2025/april/agentic-ai\">1Password Introduces Agentic AI Security for Enterprise Automation</a></li>\n<li><a href=\"https://blog.1password.com/where-mcp-fits-and-where-it-doesnt\">Securing the agentic future: Where MCP fits and where it doesn't</a></li>\n<li><a href=\"https://1password.com/press/2025/oct/browserbase-ai-security-partnership\">1Password and Browserbase Partner to Secure AI Browser Automation</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "1Password stores the credentials your agents need to authenticate with external services: API keys, OAuth tokens, database passwords, and service account secrets. When an OpenClaw agent retrieves a secret from 1Password ",
  "faqs": [
    {
      "q": "Is 1Password integration available as a native connector today?",
      "a": "No. 1Password can be connected via official API with enterprise buildout controls. The integration is planned and uses OAuth, API key, or service account authentication modes. Do not assume out-of-the-box support before release gates pass."
    },
    {
      "q": "Why can't I just tell the agent \"don't leak secrets\" in the system prompt?",
      "a": "Prompt instructions are suggestions to the model, not enforcement boundaries. A sufficiently creative prompt injection or a malicious plugin can override them. A WPC is a signed policy artifact verified by clawproxy and clawscope before any call executes. The model never evaluates the policy; the infrastructure does."
    },
    {
      "q": "Can the agent write to 1Password vaults?",
      "a": "Only if the WPC explicitly allows write operations and the 1Password service account has write grants. The recommended default is read-only. Write and admin actions require WPC approval gates, scoped tokens, and explicit least-privilege auth scopes."
    },
    {
      "q": "How do I limit which secrets the agent can see?",
      "a": "Use two layers: the 1Password service account should be scoped to a single vault with only the items the agent needs. The WPC should further restrict allowed_categories so the agent cannot request item types outside its task scope."
    },
    {
      "q": "What happens if the CST expires mid-job?",
      "a": "The clawproxy rejects the next API call with an authorization error. The agent cannot fall back to a cached token because CSTs are job-scoped and verified on each request. The operator must issue a new CST or extend the max_ttl_seconds in the WPC for longer-running jobs."
    }
  ],
  "sources": [
    {
      "title": "1Password Introduces Agentic AI Security for Enterprise Automation | 1Password",
      "uri": "https://1password.com/press/2025/april/agentic-ai"
    },
    {
      "title": "Enterprise Password Manager: Protecting Employees | 1Password",
      "uri": "http://1password.com/securitynow"
    },
    {
      "title": "1Password and AWS Partner to Advance Secure Access for Cloud and AI Enterprises | 1Password",
      "uri": "http://1password.com/press/2025/jun/aws-strategic-collaboration-agreement"
    },
    {
      "title": "Why Omdia recommends Extended Access Management to secure agentic AI | 1Password",
      "uri": "https://blog.1password.com/why-omdia-recommends-extended-access-management-to-secure-agentic-ai"
    },
    {
      "title": "1Password and Browserbase Partner to Secure AI Browser Automation | 1Password",
      "uri": "https://1password.com/press/2025/oct/browserbase-ai-security-partnership"
    },
    {
      "title": "Securing the agentic future: Where MCP fits and where it doesnâ€™t | 1Password",
      "uri": "https://blog.1password.com/where-mcp-fits-and-where-it-doesnt"
    },
    {
      "title": "Why Omdia recommends Extended Access Management to secure agentic AI | 1Password",
      "uri": "https://1password.com/blog/why-omdia-recommends-extended-access-management-to-secure-agentic-ai"
    },
    {
      "title": "https://1password.com/files/annual-report-2025.pdf",
      "uri": "https://1password.com/files/annual-report-2025.pdf"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:30:01.911Z",
  "indexable": true
}