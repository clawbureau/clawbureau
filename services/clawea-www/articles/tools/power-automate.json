{
  "slug": "tools/power-automate",
  "title": "Power Automate for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<p>Power Automate is a high-impact automation surface: it can move data, trigger downstream systems, and run on schedules or events. To use it with enterprise agents safely, you need permissioned execution that is enforced outside the prompt, using policy-as-code gates for every write or admin action.</p>\n<p>Claw EA runs agents on OpenClaw as the baseline runtime, then applies Work Policy Contracts (WPC), CST (scoped token), gateway receipts, and proof bundles so Power Automate actions can be authorized, limited, and audited when connected via official API with enterprise buildout controls.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Inventory the flows you care about and classify them into read-only, write, and admin. For each, identify what would constitute an irreversible change (for example: creating approvals, updating records, posting messages, or changing connectors).</p>\n  </li>\n  <li>\n    <p>Define a WPC that expresses exactly which Power Automate operations the agent may perform, and under what conditions. Keep the policy tight and treat “create or update flow” and “admin environment changes” as separate from “run an existing flow.”</p>\n  </li>\n  <li>\n    <p>Issue a CST (scoped token) from clawscope for the job, with the scope hash aligned to the WPC and optional policy hash pinning. Use job-scoped CST binding so a token from one run cannot be replayed against another run.</p>\n  </li>\n  <li>\n    <p>Connect Power Automate via official API, using least-privilege Microsoft Graph permissions and Power Platform permissions appropriate to the specific action. If you use Entra ID, align authentication with Conditional Access and require a controlled identity (service principal or managed identity, depending on your environment).</p>\n  </li>\n  <li>\n    <p>Route model calls through clawproxy for gateway receipts, and store the resulting proof bundle at the end of the run. Keep Power Automate credentials out of prompts and tool output, and prefer tool-level parameter passing with redaction.</p>\n  </li>\n  <li>\n    <p>Run in a sandboxed OpenClaw tool environment where possible, and keep elevated execution off unless you have a documented reason. After the run, verify the proof bundle and attach it to the change record, incident ticket, or deployment artifact as needed.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Power Automate risk is less about a single API call and more about chained effects: a small write can trigger other flows, which then touch mail, files, CRM, tickets, and external SaaS. Prompt-only constraints fail because the model can be induced to ignore instructions or to misinterpret what is “safe,” so you need machine-enforced gates.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection via email, chat, or documents</td>\n      <td>The agent is tricked into creating or modifying a flow, or running a flow with attacker-controlled inputs that exfiltrate data.</td>\n      <td>WPC must deny flow creation and connector changes by default; allow only explicit operations. Use CST scope hash aligned to the WPC so calls fail closed when scope does not match.</td>\n    </tr>\n    <tr>\n      <td>Over-permissioned identity in Entra ID</td>\n      <td>A token with broad Microsoft Graph permissions allows unintended mailbox, files, or directory actions during automation.</td>\n      <td>Least-privilege Microsoft Graph permissions and environment roles; separate identities for read vs write. Put “write and admin actions” behind WPC approval gates.</td>\n    </tr>\n    <tr>\n      <td>Flow chaining and hidden side effects</td>\n      <td>A “safe” update triggers a downstream flow that posts externally, changes permissions, or syncs data out of tenant.</td>\n      <td>WPC should specify allowed flow IDs or allowed action families, not just “Power Automate access.” Treat “run flow” as a controlled capability and require explicit allowlists in policy.</td>\n    </tr>\n    <tr>\n      <td>Replay of a prior run</td>\n      <td>An attacker reuses an old token or request to rerun automation, causing repeated changes or repeated data movement.</td>\n      <td>Marketplace anti-replay binding with job-scoped CST binding. Store proof bundles and require verification before accepting a run as legitimate.</td>\n    </tr>\n    <tr>\n      <td>Disputed actions during audit</td>\n      <td>You cannot prove which model, policy, and identity produced the automation change.</td>\n      <td>Gateway receipts from clawproxy for model calls, and proof bundles that tie receipts, policy hash, and job metadata together for verification.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This illustrates the shape of a WPC: deny-by-default, explicit allow for read, and approval-gated allow for write. The important part is that the policy is signed and hash-addressed, then fetched and verified during execution rather than “promised” in the prompt.</p>\n\n<pre>{\n  \"wpc_version\": \"1\",\n  \"policy_name\": \"power-automate-permissioned-agent\",\n  \"default\": \"deny\",\n  \"power_automate\": {\n    \"allow\": [\n      { \"action\": \"flows.read\", \"resource\": \"environment:prod\" },\n      { \"action\": \"runs.read\",  \"resource\": \"environment:prod\" }\n    ],\n    \"allow_with_approval\": [\n      {\n        \"action\": \"flows.run\",\n        \"resource\": \"flow:FIN-AP-ApproveInvoice\",\n        \"constraints\": {\n          \"input_schema_hash\": \"sha256:...expected...\",\n          \"max_run_seconds\": 300\n        }\n      },\n      {\n        \"action\": \"flows.update\",\n        \"resource\": \"flow:FIN-AP-ApproveInvoice\",\n        \"constraints\": { \"change_window\": \"requires-ticket\" }\n      }\n    ],\n    \"deny\": [\n      { \"action\": \"flows.create\", \"resource\": \"*\" },\n      { \"action\": \"connectors.manage\", \"resource\": \"*\" },\n      { \"action\": \"environments.admin\", \"resource\": \"*\" }\n    ]\n  },\n  \"auth\": {\n    \"cst\": {\n      \"require_scope_hash\": true,\n      \"optional_policy_hash_pinning\": true\n    }\n  },\n  \"logging\": {\n    \"require_gateway_receipts\": true,\n    \"redact_secrets\": true\n  }\n}</pre>\n\n<h2>What proof do you get?</h2>\n<p>Every model call routed through clawproxy yields gateway receipts that can be verified later. Those receipts are packaged into a proof bundle alongside run metadata such as the WPC hash, the CST scope hash, and the job binding details.</p>\n<p>Operationally, this lets you answer: which policy was in force, which scoped authorization was used, and what the model actually requested. If you need an audit-friendly artifact for review, you can store and view the run as a Trust Pulse.</p>\n\n<h2>Rollback posture</h2>\n<p>Automation changes are often not fully reversible, so rollback is mostly about containment and proving what happened. Design your posture per action type: stop further runs, invalidate authorization, and revert flows only when you can do so deterministically.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Agent ran an existing flow with bad inputs</td>\n      <td>Disable the flow or block the triggering event; revoke the CST and rotate the Entra ID credential used for API calls if needed.</td>\n      <td>Proof bundle showing the model request path plus WPC and CST binding; flow run records from Microsoft side for cross-checking.</td>\n    </tr>\n    <tr>\n      <td>Agent updated a flow definition</td>\n      <td>Restore from version history or redeploy a known-good export; require approval gate for any subsequent update actions.</td>\n      <td>Proof bundle plus the policy hash that allowed the update; change ticket that authorized the WPC change.</td>\n    </tr>\n    <tr>\n      <td>Agent created new automation or connectors</td>\n      <td>Remove the new assets and quarantine the identity; tighten WPC to deny those actions and re-issue CST with narrower scope hash.</td>\n      <td>WPC decision trail plus receipts for the model’s tool selection; inventory diff of environments performed by admins.</td>\n    </tr>\n    <tr>\n      <td>Suspected replay of a prior job</td>\n      <td>Reject runs that do not verify, and re-run the job with a new CST; investigate any side effects as an incident.</td>\n      <td>Marketplace anti-replay binding results and verification outcome on the proof bundle.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is Power Automate support available as a native connector in Claw EA?</h3>\n<p>No. Power Automate can be connected via official API with enterprise buildout controls; do not assume out-of-the-box support.</p>\n\n<h3>Why is prompt-only control not enough for Power Automate actions?</h3>\n<p>Because prompts are not enforcement. A misconfigured tool, a malicious plugin, or prompt injection can push the model into high-impact operations, so write and admin actions need WPC approval gates and CST-scoped authorization that fails closed.</p>\n\n<h3>How do WPC and CST work together in a run?</h3>\n<p>The WPC defines what is allowed, and the CST is minted to match that policy via scope hash and optional policy hash pinning. If the agent attempts an operation outside the policy, the call should be rejected even if the prompt asks for it.</p>\n\n<h3>What can I show an auditor after an automated run?</h3>\n<p>Gateway receipts for model calls plus a proof bundle tying receipts to the job context, WPC hash, and CST binding. For centralized review, you can store the artifact as a Trust Pulse.</p>\n\n<h3>Does this replace Microsoft governance like Conditional Access, PIM, or DLP?</h3>\n<p>No. Use Microsoft controls for identity, access, and tenant governance, and use Claw EA to make the agent’s execution permissioned and verifiable. They address different layers and are most effective when used together.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security\">Secure AI agents at scale using Microsoft Agent 365</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ai-agents/governance-security-across-organization\">Governance and security for AI agents across the organization</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Power Automate is a high-impact automation surface: it can move data, trigger downstream systems, and run on schedules or events. To use it with enterprise agents safely, you need permissioned execution that is enforced ",
  "faqs": [
    {
      "q": "Is Power Automate support available as a native connector in Claw EA?",
      "a": "No. Power Automate can be connected via official API with enterprise buildout controls; do not assume out-of-the-box support."
    },
    {
      "q": "Why is prompt-only control not enough for Power Automate actions?",
      "a": "Because prompts are not enforcement. A misconfigured tool, a malicious plugin, or prompt injection can push the model into high-impact operations, so write and admin actions need WPC approval gates and CST-scoped authorization that fails closed."
    },
    {
      "q": "How do WPC and CST work together in a run?",
      "a": "The WPC defines what is allowed, and the CST is minted to match that policy via scope hash and optional policy hash pinning. If the agent attempts an operation outside the policy, the call should be rejected even if the prompt asks for it."
    },
    {
      "q": "What can I show an auditor after an automated run?",
      "a": "Gateway receipts for model calls plus a proof bundle tying receipts to the job context, WPC hash, and CST binding. For centralized review, you can store the artifact as a Trust Pulse."
    },
    {
      "q": "Does this replace Microsoft governance like Conditional Access, PIM, or DLP?",
      "a": "No. Use Microsoft controls for identity, access, and tenant governance, and use Claw EA to make the agent’s execution permissioned and verifiable. They address different layers and are most effective when used together."
    }
  ],
  "sources": [
    {
      "title": "Secure AI agents at scale using Microsoft Agent 365",
      "uri": "https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security"
    },
    {
      "title": "Configure Global Secure Access, the Secure Web and AI Gateway for agents (preview)",
      "uri": "https://learn.microsoft.com/en-us/power-platform/admin/security/secure-web-ai-gateway-agents"
    },
    {
      "title": "Build Secure and Compliant AI Agents | Automate with Agentforce",
      "uri": "https://admin.salesforce.com/blog/2025/build-secure-and-compliant-ai-agents-automate-with-agentforce"
    },
    {
      "title": "Process to build agents across your organization - Microsoft Learn",
      "uri": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ai-agents/build-secure-process"
    },
    {
      "title": "Create Autonomous AI Agent Workflows - Azure Logic Apps",
      "uri": "https://learn.microsoft.com/en-us/azure/logic-apps/create-autonomous-agent-workflows"
    },
    {
      "title": "Security and governance - Microsoft Copilot Studio",
      "uri": "https://learn.microsoft.com/en-us/microsoft-copilot-studio/security-and-governance"
    },
    {
      "title": "Configure data policies for agents - Microsoft Copilot Studio",
      "uri": "https://learn.microsoft.com/en-us/microsoft-copilot-studio/admin-data-loss-prevention"
    },
    {
      "title": "Governance and security for AI agents across the organization",
      "uri": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ai-agents/governance-security-across-organization"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:51:09.950Z",
  "indexable": true
}