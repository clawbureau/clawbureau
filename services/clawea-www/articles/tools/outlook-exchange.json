{
  "slug": "tools/outlook-exchange",
  "title": "Outlook / Exchange for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<h1>Outlook / Exchange for Permissioned Agents</h1>\n\n\n<p>Outlook and Exchange give agents access to email send, calendar manipulation, and contact reads via Microsoft Graph. An unpermissioned agent with <code>Mail.Send</code> scope can exfiltrate data, impersonate users, or spam external recipients in seconds. Connecting Outlook / Exchange to an OpenClaw agent requires enterprise buildout via the official Microsoft Graph API, gated by a Work Policy Contract (WPC) that pins exactly which Graph scopes, mailboxes, and actions the agent may touch.</p>\n\n<p>This integration is not available as a native connector today. It can be connected via official API with enterprise buildout controls, and write or admin actions require WPC approval gates, scoped tokens (CST), and explicit least-privilege auth scopes.</p>\n\n<h2>Step-by-step runbook</h2>\n\n<ol>\n<li><strong>Register an Entra ID app registration.</strong> Request only the minimum Microsoft Graph permissions needed: <code>Mail.Read</code> for inbox triage, <code>Calendars.ReadWrite</code> for scheduling. Do not grant <code>Mail.Send</code> unless the WPC explicitly authorizes outbound email.</li>\n\n<li><strong>Author a WPC for the Outlook skill.</strong> Define allowed Graph scopes, target mailboxes (by UPN or group), and action verbs (read, draft, send, delete). The WPC is signed and hash-addressed in clawcontrols, so any mutation is detectable.</li>\n\n<li><strong>Issue a job-scoped CST.</strong> Use clawscope to mint a scoped token pinned to the WPC policy hash. The CST binds the agent session to the specific job, preventing token reuse across unrelated runs.</li>\n\n<li><strong>Route model calls through clawproxy.</strong> All LLM inference for the Outlook skill flows through clawproxy, which emits gateway receipts for each model call. This creates a verifiable record of what the model was asked to do and what it returned.</li>\n\n<li><strong>Configure Conditional Access in Entra ID.</strong> Restrict the app registration to named locations, compliant devices, or specific IP ranges. Layer Privileged Identity Management (PIM) for any admin-level Exchange scopes.</li>\n\n<li><strong>Collect proof bundle after each run.</strong> The proof bundle aggregates gateway receipts, the WPC hash, CST metadata, and action logs into a single auditable artifact.</li>\n\n<li><strong>Review Trust Pulse artifacts.</strong> Store completed proof bundles as Trust Pulse artifacts in the marketplace for post-run audit and replay verification.</li>\n</ol>\n\n<h2>Threat model</h2>\n\n<p>Prompt-only guardrails (\"please do not send emails to external domains\") fail under adversarial input. An injected prompt in an email body can override system instructions. Policy-as-code enforced at the execution layer is the only reliable control because it operates below the model's decision boundary.</p>\n\n<table>\n<thead>\n<tr><th>Threat</th><th>What happens</th><th>Control</th></tr>\n</thead>\n<tbody>\n<tr><td>Prompt injection via inbound email body</td><td>Agent reads a crafted email that instructs it to forward all inbox contents to an external address</td><td>WPC restricts <code>Mail.Send</code> to internal domains only; CST scope hash prevents scope escalation</td></tr>\n<tr><td>Over-scoped Graph permissions</td><td>Agent granted <code>Mail.ReadWrite</code> + <code>Mail.Send</code> deletes evidence emails after exfiltration</td><td>WPC allowlists only <code>Mail.Read</code>; Entra ID Conditional Access blocks write scopes outside approved contexts</td></tr>\n<tr><td>Token replay across jobs</td><td>Stolen CST reused to access a different user's mailbox in a later session</td><td>Marketplace anti-replay binding ties CST to a single job; clawscope revocation invalidates the token post-run</td></tr>\n<tr><td>Calendar manipulation for social engineering</td><td>Agent creates fake meeting invites from an executive's calendar</td><td>WPC limits <code>Calendars.ReadWrite</code> to specific calendar IDs; gateway receipts log every model decision leading to the action</td></tr>\n</tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n\n<pre><code>{\n  \"wpc_version\": \"1.0\",\n  \"integration\": \"outlook-exchange\",\n  \"allowed_graph_scopes\": [\n    \"Mail.Read\",\n    \"Calendars.Read\"\n  ],\n  \"denied_graph_scopes\": [\n    \"Mail.Send\",\n    \"Mail.ReadWrite\",\n    \"Contacts.ReadWrite\"\n  ],\n  \"mailbox_allowlist\": [\n    \"support-queue@contoso.com\",\n    \"scheduling@contoso.com\"\n  ],\n  \"external_send_domains\": [],\n  \"max_actions_per_run\": 50,\n  \"require_human_approval\": [\"Mail.Send\"],\n  \"cst_policy_hash_pin\": true\n}</code></pre>\n\n<p>This WPC blocks all send and write scopes by default. If <code>Mail.Send</code> is ever added to <code>allowed_graph_scopes</code>, the <code>require_human_approval</code> gate forces a human confirmation before each outbound email. The signed WPC hash changes on any edit, so clawproxy will reject requests carrying a stale policy reference.</p>\n\n<h2>What proof do you get?</h2>\n\n<p><strong>Gateway receipts</strong> are emitted by clawproxy for every model call made during the Outlook skill run. Each receipt includes a timestamp, model identifier, token counts, and the CST scope hash that authorized the call.</p>\n\n<p><strong>Proof bundles</strong> aggregate all gateway receipts for a job alongside the WPC hash, CST metadata, and action-level logs. Model-assisted runs against Outlook / Exchange can produce these bundles for audit and replay checks.</p>\n\n<p><strong>Trust Pulse artifacts</strong> store the completed proof bundle in the marketplace viewer, giving auditors and compliance teams a single place to verify what the agent did, which policy governed it, and whether any scope violations occurred.</p>\n\n<h2>Rollback posture</h2>\n\n<table>\n<thead>\n<tr><th>Action</th><th>Safe rollback</th><th>Evidence</th></tr>\n</thead>\n<tbody>\n<tr><td>Email sent to wrong recipient</td><td>Recall via Graph <code>message/recall</code> endpoint (Exchange Online only); notify recipient manually if recall fails</td><td>Gateway receipt logs the model call that produced the send decision; proof bundle preserves full chain</td></tr>\n<tr><td>Calendar event created in error</td><td>Delete event via Graph API; attendees receive cancellation automatically</td><td>WPC action log records the calendar ID and event payload hash</td></tr>\n<tr><td>Inbox rules modified</td><td>Revert via <code>mailboxSettings</code> Graph endpoint; compare against pre-run snapshot</td><td>Proof bundle includes pre/post state hashes if the skill captures them</td></tr>\n<tr><td>CST compromised mid-run</td><td>Revoke CST immediately via clawscope; anti-replay binding prevents reuse</td><td>Revocation event logged in clawscope audit trail</td></tr>\n</tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is Outlook / Exchange available as a native Claw EA connector today?</h3>\n<p>No. Outlook / Exchange can be connected via the official Microsoft Graph API with enterprise buildout controls. It is not shipped as an out-of-the-box connector. The integration requires an Entra ID app registration and a WPC that defines allowed scopes and mailboxes.</p>\n\n<h3>Why can't prompt-level instructions replace policy-as-code for email?</h3>\n<p>Email bodies are attacker-controlled input. A prompt injection embedded in a message can override system-level instructions, causing the agent to ignore \"do not send externally\" rules. A WPC enforced at the execution layer operates independently of the model's output and cannot be overridden by prompt content.</p>\n\n<h3>Which Microsoft Graph scopes should an Outlook agent start with?</h3>\n<p>Start with <code>Mail.Read</code> and <code>Calendars.Read</code> only. Add write or send scopes to the WPC only when a specific workflow requires them, and gate those scopes behind <code>require_human_approval</code>. Use Entra ID Conditional Access to further restrict when and where those scopes are exercisable.</p>\n\n<h3>How do gateway receipts help if something goes wrong?</h3>\n<p>Each gateway receipt is a signed record of a model call, including what the model was asked and what it returned. During incident response, you can replay the receipt chain from the proof bundle to identify exactly which model output led to an unauthorized action, without relying on the agent's self-reported logs.</p>\n\n<h3>Can I enforce cost budgets on Outlook agent runs automatically?</h3>\n<p>Automatic cost budget enforcement is planned but not shipped. Today, you can set <code>max_actions_per_run</code> in the WPC and monitor token usage via gateway receipts. Hard spending caps at the proxy layer are on the roadmap.</p>\n\n<h2>Sources</h2>\n\n<ul>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security</a></li>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n<li><a href=\"https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security\">Secure AI agents at scale using Microsoft Agent 365</a></li>\n<li><a href=\"https://learn.microsoft.com/en-us/copilot/microsoft-365/microsoft-365-copilot-privacy\">Data, Privacy, and Security for Microsoft 365 Copilot</a></li>\n<li><a href=\"https://learn.microsoft.com/en-us/microsoft-agent-365/developer/identity\">Agent 365 Identity</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Outlook and Exchange give agents access to email send, calendar manipulation, and contact reads via Microsoft Graph. An unpermissioned agent with Mail.Send scope can exfiltrate data, impersonate users, or spam external r",
  "faqs": [
    {
      "q": "Is Outlook / Exchange available as a native Claw EA connector today?",
      "a": "No. Outlook / Exchange can be connected via the official Microsoft Graph API with enterprise buildout controls. It is not shipped as an out-of-the-box connector. The integration requires an Entra ID app registration and a WPC that defines allowed scopes and mailboxes."
    },
    {
      "q": "Why can't prompt-level instructions replace policy-as-code for email?",
      "a": "Email bodies are attacker-controlled input. A prompt injection embedded in a message can override system-level instructions, causing the agent to ignore \"do not send externally\" rules. A WPC enforced at the execution layer operates independently of the model's output and cannot be overridden by prompt content."
    },
    {
      "q": "Which Microsoft Graph scopes should an Outlook agent start with?",
      "a": "Start with Mail.Read and Calendars.Read only. Add write or send scopes to the WPC only when a specific workflow requires them, and gate those scopes behind require_human_approval . Use Entra ID Conditional Access to further restrict when and where those scopes are exercisable."
    },
    {
      "q": "How do gateway receipts help if something goes wrong?",
      "a": "Each gateway receipt is a signed record of a model call, including what the model was asked and what it returned. During incident response, you can replay the receipt chain from the proof bundle to identify exactly which model output led to an unauthorized action, without relying on the agent's self-reported logs."
    },
    {
      "q": "Can I enforce cost budgets on Outlook agent runs automatically?",
      "a": "Automatic cost budget enforcement is planned but not shipped. Today, you can set max_actions_per_run in the WPC and monitor token usage via gateway receipts. Hard spending caps at the proxy layer are on the roadmap."
    }
  ],
  "sources": [
    {
      "title": "Use Microsoft Purview to manage data security & compliance for ...",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-agent-365"
    },
    {
      "title": "Manage Microsoft Agent 365 agents in the Microsoft 365 admin center",
      "uri": "https://learn.microsoft.com/en-us/microsoft-agent-365/admin/manage-agents"
    },
    {
      "title": "Secure AI agents at scale using Microsoft Agent 365",
      "uri": "https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security"
    },
    {
      "title": "Data, Privacy, and Security for Microsoft 365 Copilot",
      "uri": "https://learn.microsoft.com/en-us/copilot/microsoft-365/microsoft-365-copilot-privacy"
    },
    {
      "title": "Enterprise data protection in Microsoft 365 Copilot and Microsoft 365 ...",
      "uri": "https://learn.microsoft.com/en-us/copilot/microsoft-365/enterprise-data-protection"
    },
    {
      "title": "Considerations to manage Microsoft 365 Copilot and Channel Agent ...",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-m365-copilot-considerations"
    },
    {
      "title": "Manage Copilot agents in the Microsoft 365 admin center",
      "uri": "https://learn.microsoft.com/en-us/microsoft-365/admin/manage/manage-copilot-agents-integrated-apps?view=o365-worldwide"
    },
    {
      "title": "Agent 365 Identity | Microsoft Learn",
      "uri": "https://learn.microsoft.com/en-us/microsoft-agent-365/developer/identity"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:33:38.015Z",
  "indexable": true
}