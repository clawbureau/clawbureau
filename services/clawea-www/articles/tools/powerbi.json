{
  "slug": "tools/powerbi",
  "title": "Power BI for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<h2>Direct Answer</h2>\n<p>Power BI is a high-impact surface for enterprise agents because it can reveal sensitive business metrics and, via official API with enterprise buildout controls, can also change content like datasets, reports, workspaces, and sharing. Claw EA runs agents on OpenClaw as the baseline runtime, then adds permissioned execution so every Power BI action is allowed by policy-as-code, not just a “please be careful” prompt.</p>\n<p>Prompt-only controls fail because a malicious or misconfigured skill can still call APIs once it has credentials. Use a WPC = Work Policy Contract to declare what the agent may do, issue a CST = scoped token bound to that policy, and require proof artifacts (gateway receipts and proof bundles) for audit and replay checks.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Define the Power BI job boundary. Start with a single workspace, a small set of datasets or semantic models, and a narrow task like “refresh and read metrics” or “export a report snapshot for finance review.”</p>\n  </li>\n  <li>\n    <p>Choose identity and least-privilege scopes in Microsoft terms. Use Entra ID app registration or a service principal with explicit Microsoft Graph permissions and Power BI permissions/scopes that match your task, and keep “admin” capabilities off by default.</p>\n  </li>\n  <li>\n    <p>Write a WPC that gates Power BI operations. The WPC should enumerate allowed API families (read vs write vs admin), allowed workspace IDs, and any required human approval steps for write or sharing actions.</p>\n  </li>\n  <li>\n    <p>Issue a CST from clawscope for the specific job. Pin the CST scope hash and optionally pin the WPC policy hash so the runtime fails closed if a different policy is presented.</p>\n  </li>\n  <li>\n    <p>Run the agent in OpenClaw with tool policy and sandboxing set to minimize blast radius. Keep the Power BI capability as an explicit tool, deny generic “HTTP to anywhere” patterns, and avoid elevated host execution unless there is a documented reason.</p>\n  </li>\n  <li>\n    <p>Route model calls through clawproxy where applicable. This produces gateway receipts for model calls, which later become part of the proof bundle for the run.</p>\n  </li>\n  <li>\n    <p>Export and store the proof bundle for audit. Attach the bundle to your ticket, store it in your evidence system, or publish it to Trust Pulse when you need a marketplace-stored artifact for audit/viewing.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Over-broad Power BI permissions</td>\n      <td>The agent can enumerate workspaces, read unintended datasets, or change content outside the intended business unit.</td>\n      <td>Entra ID least-privilege app permissions plus a WPC that restricts workspace IDs and action families (read vs write vs admin).</td>\n    </tr>\n    <tr>\n      <td>Prompt injection through descriptions, report text, or dataset fields</td>\n      <td>Model output is steered into unsafe tool calls, such as sharing a report externally or exporting more data than needed.</td>\n      <td>Policy-as-code gates for write/share/export, plus OpenClaw tool allow/deny profiles so the model cannot call arbitrary tools when it is manipulated.</td>\n    </tr>\n    <tr>\n      <td>Misconfigured sharing and access grants</td>\n      <td>The agent adds users/groups, changes workspace roles, or generates sharing links that widen access.</td>\n      <td>Write and admin actions require WPC approval gates, CST enforcement, and explicit least-privilege auth scopes. Use PIM for admin elevation outside the agent path.</td>\n    </tr>\n    <tr>\n      <td>Data exfiltration via exports</td>\n      <td>The agent exports reports or underlying data and writes it to a location that is not approved.</td>\n      <td>WPC restricts export operations and destinations at the tool layer. Egress allowlists can be implemented outside clawproxy (optional) if you need network-level enforcement.</td>\n    </tr>\n    <tr>\n      <td>Replay of prior authorizations</td>\n      <td>A captured token or workflow artifact is reused to repeat a sensitive operation later.</td>\n      <td>Marketplace anti-replay binding using job-scoped CST binding, and proof bundles that tie receipts and run metadata to a specific job.</td>\n    </tr>\n    <tr>\n      <td>Unverifiable “what did the model see and decide?”</td>\n      <td>You cannot reconstruct why a report was modified or why a set of data was queried.</td>\n      <td>Route model calls through clawproxy to emit gateway receipts, then bundle them into a proof bundle for verification and audit.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This example shows the shape of a WPC for a Power BI job. It separates read actions from write/admin actions, pins the allowed workspaces, and requires an explicit approval gate for anything that changes sharing or permissions.</p>\n<pre>{\n  \"wpc_version\": \"1\",\n  \"tool\": \"powerbi\",\n  \"connection\": {\n    \"mode\": \"official_api\",\n    \"auth\": {\n      \"entra_id\": {\n        \"principal_type\": \"service_principal\",\n        \"tenant\": \"YOUR_TENANT_ID\"\n      },\n      \"required_scopes\": [\n        \"PowerBI.Read.All\"\n      ]\n    }\n  },\n  \"limits\": {\n    \"allowed_workspaces\": [\"WORKSPACE_ID_FINANCE\"],\n    \"allowed_actions\": [\n      \"list_reports\",\n      \"get_report\",\n      \"query_dataset\",\n      \"refresh_dataset_status\"\n    ],\n    \"deny_actions\": [\n      \"add_workspace_user\",\n      \"update_workspace_role\",\n      \"create_sharing_link\",\n      \"publish_report\",\n      \"update_dataset\",\n      \"delete_report\"\n    ]\n  },\n  \"approval_gates\": [\n    {\n      \"when_action_in\": [\n        \"add_workspace_user\",\n        \"update_workspace_role\",\n        \"create_sharing_link\",\n        \"publish_report\",\n        \"update_dataset\",\n        \"delete_report\"\n      ],\n      \"require\": \"human_approval\"\n    }\n  ],\n  \"attestation\": {\n    \"require_gateway_receipts\": true,\n    \"require_proof_bundle\": true,\n    \"cst_policy_hash_pinning\": \"optional\"\n  }\n}</pre>\n<p>Operationally, the CST is minted for this job and is only valid for the policy scope hash. If an agent tries to step outside the allowed workspaces or actions, the run should fail closed at the execution layer, not rely on the model to self-correct.</p>\n\n<h2>What proof do you get?</h2>\n<p>For model calls routed through clawproxy, you get gateway receipts: signed receipts emitted by clawproxy for model calls. These receipts are designed to make later verification possible without trusting the agent’s own logs.</p>\n<p>For the overall run, you get a proof bundle: a harness artifact bundling receipts and related metadata for audit/verification. If you use Trust Pulse, you can store and view the artifact as a marketplace-stored artifact for audit/viewing, which helps when you need to share evidence across teams.</p>\n<p>For Power BI itself, evidence still depends on what Microsoft logs you already retain. The Claw EA side focuses on proving the agent’s execution path, the policy in effect (WPC hash), and the job binding (CST binding) used to authorize the work.</p>\n\n<h2>Rollback posture</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence to check</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Agent queried more data than intended</td>\n      <td>Revoke the CST, tighten the WPC allowed_actions, and re-run with narrower dataset queries or a smaller workspace list.</td>\n      <td>Proof bundle showing the WPC hash used, job-scoped CST binding, and gateway receipts for the model calls that led to the query.</td>\n    </tr>\n    <tr>\n      <td>Agent changed a report or dataset</td>\n      <td>Disable write actions in the WPC, rotate Entra ID credentials if needed, then restore Power BI content using your standard workspace versioning or admin recovery process.</td>\n      <td>Proof bundle for the run that performed write attempts, plus Microsoft audit logs and workspace activity logs where available.</td>\n    </tr>\n    <tr>\n      <td>Agent modified sharing or permissions</td>\n      <td>Remove added principals, revert workspace roles, and require PIM elevation for any future permission changes. Add a permanent WPC approval gate for sharing-related actions.</td>\n      <td>WPC approval records (if you require them), proof bundle and receipts for the run, and Entra ID or Power BI audit logs showing the access change.</td>\n    </tr>\n    <tr>\n      <td>Suspected prompt injection from report content</td>\n      <td>Freeze the integration by revoking CST issuance for the tool, quarantine the affected dataset/report, and re-run only after adding explicit deny rules and narrowing tool access in OpenClaw.</td>\n      <td>Gateway receipts around the injection window and the proof bundle event metadata that ties the run to the affected session.</td>\n    </tr>\n  </tbody>\n</table>\n<p>This rollback posture assumes Power BI is connected via official API with enterprise buildout controls, not a native connector. If you need network-level containment, egress allowlists enforced outside clawproxy can be implemented (optional) as part of an enterprise buildout.</p>\n\n<h2>FAQ</h2>\n<h3>Why isn’t prompt-only guidance enough for Power BI access?</h3>\n<p>Because once the agent has credentials, a malicious or coerced tool call can still hit the API. Permissioned execution uses a WPC and CST enforcement so the platform can refuse actions even when the model tries to do them.</p>\n\n<h3>Is this a native Power BI connector in Claw EA today?</h3>\n<p>No. Power BI can be connected via official API with enterprise buildout controls, and you should plan for explicit policy gates and least-privilege scopes for each action.</p>\n\n<h3>How do WPC and CST map to Microsoft controls like Entra ID and Conditional Access?</h3>\n<p>Entra ID and Conditional Access govern who can obtain tokens and under what conditions. WPC and CST govern what the agent is permitted to do once it is running, and they make that permission set portable and hash-addressed for audit.</p>\n\n<h3>What should require approval versus being fully automated?</h3>\n<p>Read-only analytics tasks can usually be automated when constrained to a known workspace and dataset set. Write, publish, share, and permission changes should be gated by WPC approval rules and backed by explicit admin scopes, ideally with PIM for any human elevation path.</p>\n\n<h3>What artifacts should my auditors expect to see?</h3>\n<p>Expect the WPC hash, the job-scoped CST binding, gateway receipts for model calls (when routed via clawproxy), and a proof bundle tying the run together. Pair that with Microsoft audit logs for the Power BI tenant and the specific workspace actions.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/fabric/enterprise/powerbi/service-admin-power-bi-security\">Power BI Security - Microsoft Fabric</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/entra/agent-id/identity-professional/security-for-ai\">Security for AI agents with Microsoft Entra Agent ID</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/power-bi/create-reports/copilot-introduction\">Overview of Copilot for Power BI</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/fabric/fundamentals/copilot-power-bi-privacy-security\">Privacy, security, and responsible use for Copilot in Power BI</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Power BI is a high-impact surface for enterprise agents because it can reveal sensitive business metrics and, via official API with enterprise buildout controls, can also change content like datasets, reports, workspaces",
  "faqs": [
    {
      "q": "Why isn’t prompt-only guidance enough for Power BI access?",
      "a": "Because once the agent has credentials, a malicious or coerced tool call can still hit the API. Permissioned execution uses a WPC and CST enforcement so the platform can refuse actions even when the model tries to do them."
    },
    {
      "q": "Is this a native Power BI connector in Claw EA today?",
      "a": "No. Power BI can be connected via official API with enterprise buildout controls, and you should plan for explicit policy gates and least-privilege scopes for each action."
    },
    {
      "q": "How do WPC and CST map to Microsoft controls like Entra ID and Conditional Access?",
      "a": "Entra ID and Conditional Access govern who can obtain tokens and under what conditions. WPC and CST govern what the agent is permitted to do once it is running, and they make that permission set portable and hash-addressed for audit."
    },
    {
      "q": "What should require approval versus being fully automated?",
      "a": "Read-only analytics tasks can usually be automated when constrained to a known workspace and dataset set. Write, publish, share, and permission changes should be gated by WPC approval rules and backed by explicit admin scopes, ideally with PIM for any human elevation path."
    },
    {
      "q": "What artifacts should my auditors expect to see?",
      "a": "Expect the WPC hash, the job-scoped CST binding, gateway receipts for model calls (when routed via clawproxy), and a proof bundle tying the run together. Pair that with Microsoft audit logs for the Power BI tenant and the specific workspace actions."
    }
  ],
  "sources": [
    {
      "title": "Consume a data agent from Copilot in Power BI (preview)",
      "uri": "https://learn.microsoft.com/en-us/fabric/data-science/data-agent-copilot-powerbi"
    },
    {
      "title": "Security for AI agents with Microsoft Entra Agent ID",
      "uri": "https://learn.microsoft.com/en-us/entra/agent-id/identity-professional/security-for-ai"
    },
    {
      "title": "Fabric data agent sharing and permission management ...",
      "uri": "https://learn.microsoft.com/en-us/fabric/data-science/data-agent-sharing"
    },
    {
      "title": "Privacy, security, and responsible use for Copilot in Power BI - Microsoft Fabric",
      "uri": "https://learn.microsoft.com/en-us/fabric/fundamentals/copilot-power-bi-privacy-security"
    },
    {
      "title": "Fabric data agent concepts (preview)",
      "uri": "https://learn.microsoft.com/en-us/fabric/data-science/concept-data-agent"
    },
    {
      "title": "Semantic model best practices for data agent - Microsoft Fabric",
      "uri": "https://learn.microsoft.com/en-us/fabric/data-science/semantic-model-best-practices"
    },
    {
      "title": "Power BI Security - Microsoft Fabric",
      "uri": "https://learn.microsoft.com/en-us/fabric/enterprise/powerbi/service-admin-power-bi-security"
    },
    {
      "title": "Overview of Copilot for Power BI",
      "uri": "https://learn.microsoft.com/en-us/power-bi/create-reports/copilot-introduction"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:52:01.464Z",
  "indexable": true
}