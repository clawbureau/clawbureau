{
  "slug": "tools/google-drive",
  "title": "Google Drive for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<p>Google Drive is a high-risk tool for enterprise agents because it combines broad read access, easy sharing, and the ability to overwrite source-of-truth documents. For permissioned agents, you should connect Drive via official API with enterprise buildout controls, and run every write, share, move, delete, and permission change behind a Work Policy Contract (WPC) gate.</p>\n<p>OpenClaw is a solid baseline runtime for tool execution, but prompt-only “be careful” rules do not hold under prompt injection or plugin mistakes. You need policy-as-code that is verified at execution time, with scoped tokens (CST) and auditable artifacts like gateway receipts and proof bundles.</p>\n\n<h2>Step-by-step runbook</h2>\n<p>Use this runbook to make Drive access useful without giving an agent a “delete the company’s files” lever. The key is to separate discovery from mutation, and to require explicit approvals for anything that changes Drive state.</p>\n<ol>\n  <li>\n    <p><strong>Define a WPC for Drive work.</strong> Make the WPC enumerate allowed actions (read, list, export) and a separate section for mutations (create, update, move, delete, share). Keep mutation default-deny, and require an approval gate for each mutation class.</p>\n  </li>\n  <li>\n    <p><strong>Choose the smallest feasible auth model.</strong> For enterprise buildout you typically use OAuth or a service account (if applicable to your org’s Drive model) via official API. Map each agent job to a distinct identity or delegated context so you can reason about least privilege and revocation.</p>\n  </li>\n  <li>\n    <p><strong>Issue a CST per job from clawscope.</strong> Bind the CST to the job and (optionally) pin the policy hash so the tool can only run under the intended WPC. Treat the CST as short-lived and non-reusable across jobs.</p>\n  </li>\n  <li>\n    <p><strong>Enforce “read-first” workflows.</strong> Require the agent to list files and present a plan including file IDs, target folders, and a diff-like summary before any write. Only then request WPC-gated approval for the exact file IDs and operations.</p>\n  </li>\n  <li>\n    <p><strong>Route model calls through clawproxy when the model is involved.</strong> When the agent uses a model to interpret file content, classify documents, or generate edits, route those calls through clawproxy to emit gateway receipts for model calls. This makes later dispute resolution possible when someone asks “why did the agent do that?”</p>\n  </li>\n  <li>\n    <p><strong>Bundle evidence at the end of the run.</strong> Produce a proof bundle that ties together the CST scope hash, WPC hash, and gateway receipts (plus your run metadata). Store or publish the artifact to Trust Pulse when you need a durable audit/viewing surface.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Drive failures tend to be irreversible in human time, even if the API supports recovery, because the damage spreads through sharing, sync clients, and downstream copies. Model behavior plus a permissive token often equals a large blast radius.</p>\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control (permissioned execution)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection from a document</td>\n      <td>The agent reads a file that contains instructions to exfiltrate content, broaden sharing, or delete competing evidence.</td>\n      <td>WPC denies share/delete by default; CST is scoped to read-only unless an approval gate is satisfied. Use “read-first” plus explicit file-ID allowlists per job.</td>\n    </tr>\n    <tr>\n      <td>Overbroad OAuth scopes or delegated access</td>\n      <td>The agent can access the entire Drive, including sensitive folders unrelated to the task.</td>\n      <td>Least-privilege scopes and narrow resource targeting in the WPC (folder IDs, shared drive IDs, file patterns). Use a dedicated identity per workflow where possible and rotate access frequently.</td>\n    </tr>\n    <tr>\n      <td>Accidental destructive writes</td>\n      <td>The agent overwrites the wrong file, replaces a template, or edits a policy doc in-place.</td>\n      <td>WPC requires “create new draft” instead of in-place edit for high-value folders; mutation operations require explicit approval and target constraints (specific file IDs only).</td>\n    </tr>\n    <tr>\n      <td>Permission sprawl via sharing</td>\n      <td>The agent shares a folder to the wrong domain or makes files discoverable to “anyone with the link”.</td>\n      <td>WPC blocks public-link sharing and external domains; require an approval gate with a concrete recipient list. Keep a second, stricter WPC for permission changes than for content edits.</td>\n    </tr>\n    <tr>\n      <td>Replay or cross-job token reuse</td>\n      <td>A token captured from logs or a prior run is reused to perform actions later.</td>\n      <td>Job-scoped CST binding (anti-replay) and short TTL; store secrets outside prompt-visible logs. Validate the CST scope hash and (optionally) policy hash pinning on every call.</td>\n    </tr>\n    <tr>\n      <td>Silent policy drift</td>\n      <td>Someone updates a prompt or tool config and the agent starts doing broader actions without a clear change record.</td>\n      <td>WPC is signed and hash-addressed; pin to the policy hash so runs fail closed if the policy changes. Store proof bundles for each job to show what policy was in force.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This is a JSON-like sketch of the kind of WPC you want for Drive. The point is to make the allowed operations explicit and machine-verifiable, not implied by a prompt.</p>\n<pre>{\n  \"wpc_version\": \"1\",\n  \"tool\": \"google_drive_via_official_api\",\n  \"policy\": {\n    \"default\": \"deny\",\n    \"allow\": [\n      { \"action\": \"drive.files.list\", \"constraints\": { \"folder_ids\": [\"FOLDER_123\"], \"max_results\": 50 } },\n      { \"action\": \"drive.files.get\", \"constraints\": { \"file_ids\": [\"FILE_A\", \"FILE_B\"], \"export_formats\": [\"text/plain\", \"application/pdf\"] } }\n    ],\n    \"approval_gates\": [\n      {\n        \"gate\": \"human_approval\",\n        \"allows\": [\n          { \"action\": \"drive.files.create\", \"constraints\": { \"parent_folder_id\": \"FOLDER_123\", \"name_prefix\": \"agent-draft-\" } },\n          { \"action\": \"drive.files.update\", \"constraints\": { \"file_ids\": [\"FILE_A\"], \"require_etag_match\": true } },\n          { \"action\": \"drive.permissions.create\", \"constraints\": { \"file_ids\": [\"FILE_A\"], \"allow_domains\": [\"example.com\"], \"deny_public_link\": true } },\n          { \"action\": \"drive.files.delete\", \"constraints\": { \"file_ids\": [\"FILE_TMP_ONLY\"], \"deny_shared_drives\": true } }\n        ]\n      }\n    ],\n    \"logging\": { \"redact\": [\"file_content\", \"oauth_tokens\"] }\n  },\n  \"cst_requirements\": {\n    \"require_job_binding\": true,\n    \"require_scope_hash_match\": true,\n    \"optional_policy_hash_pinning\": true\n  }\n}</pre>\n<p>In practice you also add folder-level “crown jewels” rules: policies, legal, payroll, and key customer folders should be read-only for agents unless a separate break-glass WPC is used. If you cannot express those rules cleanly, the tool should not be enabled.</p>\n\n<h2>What proof do you get?</h2>\n<p>For model-involved steps, clawproxy emits gateway receipts for model calls. Those receipts let you verify which model was called, when, and under which job context, instead of relying on logs that can be incomplete or tampered with.</p>\n<p>At the end of a job, you can produce a proof bundle that packages receipts plus the run metadata you care about, including the WPC hash and CST scope hash. When you need a durable audit/viewing record, store the bundle as a Trust Pulse artifact so reviewers can reference the exact run that made a Drive change.</p>\n<p>This matters most for Drive write paths: a change ticket should be able to point to a specific proof bundle, not a screenshot of a chat. If an incident happens, you can answer: what policy allowed it, what token scope permitted it, and what model calls influenced the decision.</p>\n\n<h2>Rollback posture</h2>\n<p>Drive supports recovery patterns, but an agent can still do damage faster than humans can respond. Your rollback strategy should assume partial recovery and focus on preventing unsafe mutations in the first place.</p>\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence to retain</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Create new files (draft outputs)</td>\n      <td>Delete drafts, or move them to a quarantine folder; prefer drafts in a dedicated folder to simplify cleanup.</td>\n      <td>WPC hash, CST scope hash, file IDs created, and the proof bundle for the job.</td>\n    </tr>\n    <tr>\n      <td>Update existing files</td>\n      <td>Restore from prior revisions where available; require pre-write snapshotting in your workflow.</td>\n      <td>Before/after metadata, revision identifiers if captured, and any gateway receipts tied to content generation.</td>\n    </tr>\n    <tr>\n      <td>Move/rename</td>\n      <td>Move back using recorded file IDs and previous parent folder IDs; avoid path-based logic.</td>\n      <td>Move plan, target folder IDs, and the approval record referenced by the WPC gate.</td>\n    </tr>\n    <tr>\n      <td>Permission changes and sharing</td>\n      <td>Revoke permissions; re-check inheritance and link-sharing settings; notify affected owners.</td>\n      <td>Exact recipients/domains changed, timestamped approval context, and proof bundle pointer in Trust Pulse.</td>\n    </tr>\n    <tr>\n      <td>Delete</td>\n      <td>Recover from trash if possible; treat as break-glass only and deny by default in the primary WPC.</td>\n      <td>Deletion intent record, file IDs, and proof bundle showing the specific approval gate used.</td>\n    </tr>\n  </tbody>\n</table>\n<p>If you want stronger containment, egress allowlists enforced outside clawproxy can be implemented as an extra layer, but you should still assume the agent can make harmful API calls if you grant broad Drive permissions. Keep the WPC as the primary decision point for what the agent is allowed to do.</p>\n\n<h2>FAQ</h2>\n<h3>Is this a native Google Drive connector in Claw EA?</h3>\n<p>No. Google Drive can be connected via official API with enterprise buildout controls, and you should treat it as an integration that is implemented and governed per environment.</p>\n\n<h3>Why isn’t a “don’t delete files” prompt enough?</h3>\n<p>Prompts are not enforcement. Prompt injection, tool bugs, and mis-scoped credentials turn a suggestion into a best-effort, so the execution layer must be permissioned with policy-as-code that is evaluated at the moment of the API call.</p>\n\n<h3>What Drive actions should always require approval?</h3>\n<p>Start with share/permission changes, deletes, moves across shared drives, and edits to high-value folders. In many enterprises, even “update” should be restricted to draft-only workflows unless the file is explicitly allowlisted by ID.</p>\n\n<h3>How do CST and WPC work together for Drive?</h3>\n<p>The CST is the scoped token presented by the job, and the WPC is the signed Work Policy Contract that describes what the job is allowed to do. You validate the CST scope hash and optionally pin the policy hash so a token cannot be reused under a different policy.</p>\n\n<h3>What audit artifacts should we expect after a Drive-writing job?</h3>\n<p>Expect gateway receipts for model calls (when the model is used) and a proof bundle tying together receipts, WPC hash, CST scope hash, and run metadata. If you store it as a Trust Pulse artifact, reviewers can reference a stable record for audits or incident response.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandboxing.md\">OpenClaw: Sandboxing</a></li>\n  <li><a href=\"https://docs.cloud.google.com/gemini/enterprise/docs/gdrive\">Overview | Gemini Enterprise (Google Drive data store)</a></li>\n  <li><a href=\"https://docs.cloud.google.com/gemini/enterprise/docs/access-control\">IAM roles and permissions | Gemini Enterprise</a></li>\n  <li><a href=\"https://cloud.google.com/blog/products/identity-security/cloud-ciso-perspectives-how-google-secures-ai-agents/\">Cloud CISO Perspectives: How Google secures AI Agents</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Google Drive is a high-risk tool for enterprise agents because it combines broad read access, easy sharing, and the ability to overwrite source-of-truth documents. For permissioned agents, you should connect Drive via of",
  "faqs": [
    {
      "q": "Is this a native Google Drive connector in Claw EA?",
      "a": "No. Google Drive can be connected via official API with enterprise buildout controls, and you should treat it as an integration that is implemented and governed per environment."
    },
    {
      "q": "Why isn’t a “don’t delete files” prompt enough?",
      "a": "Prompts are not enforcement. Prompt injection, tool bugs, and mis-scoped credentials turn a suggestion into a best-effort, so the execution layer must be permissioned with policy-as-code that is evaluated at the moment of the API call."
    },
    {
      "q": "What Drive actions should always require approval?",
      "a": "Start with share/permission changes, deletes, moves across shared drives, and edits to high-value folders. In many enterprises, even “update” should be restricted to draft-only workflows unless the file is explicitly allowlisted by ID."
    },
    {
      "q": "How do CST and WPC work together for Drive?",
      "a": "The CST is the scoped token presented by the job, and the WPC is the signed Work Policy Contract that describes what the job is allowed to do. You validate the CST scope hash and optionally pin the policy hash so a token cannot be reused under a different policy."
    },
    {
      "q": "What audit artifacts should we expect after a Drive-writing job?",
      "a": "Expect gateway receipts for model calls (when the model is used) and a proof bundle tying together receipts, WPC hash, CST scope hash, and run metadata. If you store it as a Trust Pulse artifact, reviewers can reference a stable record for audits or incident response."
    }
  ],
  "sources": [
    {
      "title": "IAM roles and permissions | Gemini Enterprise",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/access-control"
    },
    {
      "title": "Overview | Gemini Enterprise | Google Cloud Documentation",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/gdrive"
    },
    {
      "title": "Gemini Enterprise security overview | Google Cloud Documentation",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/security-overview"
    },
    {
      "title": "Access control with IAM",
      "uri": "https://cloud.google.com/agentspace/agentspace-enterprise/docs/access-control"
    },
    {
      "title": "Agentspace security overview",
      "uri": "https://cloud.google.com/agentspace/docs/security-overview"
    },
    {
      "title": "Cloud CISO Perspectives: How Google secures AI Agents",
      "uri": "https://cloud.google.com/blog/products/identity-security/cloud-ciso-perspectives-how-google-secures-ai-agents/"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T12:24:46.315Z",
  "indexable": true
}