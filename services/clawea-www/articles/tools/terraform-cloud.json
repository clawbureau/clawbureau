{
  "slug": "tools/terraform-cloud",
  "title": "Terraform Cloud for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "\n<p>Terraform Cloud can be connected to OpenClaw agents via official API with enterprise buildout controls, but it must not be exposed without policy-as-code enforcement. An agent with unconstrained Terraform Cloud access can create, modify, or destroy infrastructure across every workspace it can reach. The execution layer requires Work Policy Contracts (WPC), scoped tokens (CST), and gateway receipts to ensure that every plan and apply is authorized, scoped, and auditable before it touches your state files.</p>\n\n<p>Prompt-level instructions alone cannot prevent a misconfigured or compromised agent from running <code>terraform apply</code> on the wrong workspace. Policy-as-code binds the agent to a signed contract that clawproxy and clawcontrols enforce at the network layer, not at the model's discretion.</p>\n\n<h2>Step-by-step runbook</h2>\n\n<ol>\n<li><strong>Create a Terraform Cloud API token with least-privilege scope.</strong> Use a team-level or project-scoped token, not an organization token. Restrict it to the specific workspaces the agent needs. Store the token in your secrets manager, never in agent config.</li>\n\n<li><strong>Author a Work Policy Contract (WPC).</strong> Define the allowed Terraform Cloud workspaces, permitted operations (plan-only vs. plan-and-apply), and any resource-type restrictions. Sign and publish the WPC to the clawcontrols registry.</li>\n\n<li><strong>Issue a scoped token (CST) pinned to the WPC hash.</strong> Use clawscope to mint a CST with the policy hash pinned. This ensures the agent can only operate under the exact policy version you approved.</li>\n\n<li><strong>Route model calls through clawproxy.</strong> All model interactions during the Terraform run produce gateway receipts. These receipts record which model was called, what the agent requested, and the timestamp, giving you a verifiable chain of reasoning.</li>\n\n<li><strong>Gate apply operations on explicit approval.</strong> Configure the WPC so that <code>terraform apply</code> requires a human approval step or a secondary CST with elevated scope. Plan-only runs can proceed autonomously; state-mutating runs must not.</li>\n\n<li><strong>Collect the proof bundle after each run.</strong> The proof bundle aggregates gateway receipts, the WPC hash, CST metadata, and run identifiers into a single auditable artifact. Store it alongside your Terraform state version for traceability.</li>\n\n<li><strong>Review via Trust Pulse.</strong> Publish the proof bundle as a Trust Pulse artifact for your compliance team to inspect without needing direct access to Terraform Cloud or the agent runtime.</li>\n</ol>\n\n<h2>Threat model</h2>\n\n<table>\n<thead>\n<tr><th>Threat</th><th>What happens</th><th>Control</th></tr>\n</thead>\n<tbody>\n<tr><td>Agent applies destructive plan to production workspace</td><td>Resources deleted or misconfigured; outage or data loss</td><td>WPC restricts allowed workspaces and blocks apply without approval gate</td></tr>\n<tr><td>Prompt injection tricks agent into changing target workspace</td><td>Agent runs plan/apply against unintended infrastructure</td><td>CST is pinned to specific workspace identifiers in the WPC; clawproxy rejects out-of-scope calls</td></tr>\n<tr><td>Stolen Terraform Cloud API token used outside agent context</td><td>Unauthorized infrastructure changes with no audit trail</td><td>CST job-scoped binding (marketplace anti-replay) ensures the token is only valid within a specific job; gateway receipts provide tamper-evident logs</td></tr>\n<tr><td>Agent exfiltrates state file containing secrets</td><td>Credentials, connection strings, or private keys exposed</td><td>WPC denies read access to state endpoints; egress allowlists (planned) can further restrict outbound destinations</td></tr>\n<tr><td>Model hallucinates valid-looking HCL that passes plan</td><td>Subtly wrong infrastructure deployed</td><td>Gateway receipts capture the model's reasoning; proof bundle enables post-hoc audit of what the model proposed vs. what was applied</td></tr>\n</tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n\n<pre><code>{\n  \"wpc_version\": \"1.0\",\n  \"name\": \"terraform-cloud-staging-only\",\n  \"tool\": \"terraform-cloud\",\n  \"connection\": \"official-api\",\n  \"permissions\": {\n    \"workspaces\": [\"ws-staging-app\", \"ws-staging-db\"],\n    \"operations\": [\"plan\"],\n    \"apply\": {\n      \"allowed\": true,\n      \"requires_approval\": true,\n      \"approvers\": [\"infra-lead@example.com\"]\n    },\n    \"state_read\": false\n  },\n  \"cst_constraints\": {\n    \"max_ttl_seconds\": 1800,\n    \"policy_hash_pin\": true,\n    \"job_scoped\": true\n  },\n  \"audit\": {\n    \"gateway_receipts\": \"required\",\n    \"proof_bundle\": \"required\"\n  }\n}</code></pre>\n\n<p>This WPC limits the agent to two staging workspaces, allows plan freely, requires human approval for apply, and blocks state reads entirely. The CST expires after 30 minutes and is bound to a single job.</p>\n\n<h2>What proof do you get?</h2>\n\n<p>Every model call the agent makes during a Terraform run produces a <strong>gateway receipt</strong> from clawproxy. Each receipt is signed and includes the model identifier, request hash, and timestamp. These receipts are not deniable after the fact.</p>\n\n<p>At job completion, receipts are bundled with the WPC hash, CST metadata, and Terraform run ID into a <strong>proof bundle</strong>. This bundle is a single artifact your auditors can verify independently using clawverify, without needing access to the agent or Terraform Cloud.</p>\n\n<p>The proof bundle can be published as a <strong>Trust Pulse</strong> artifact for marketplace-level visibility. This gives compliance reviewers a read-only view of what the agent did, what policy it operated under, and which model calls drove its decisions.</p>\n\n<h2>Rollback posture</h2>\n\n<table>\n<thead>\n<tr><th>Action</th><th>Safe rollback</th><th>Evidence</th></tr>\n</thead>\n<tbody>\n<tr><td>Agent runs unauthorized apply</td><td>Revert to previous Terraform state version; Terraform Cloud retains state history per workspace</td><td>Proof bundle shows which model call triggered the apply; gateway receipts identify the exact reasoning chain</td></tr>\n<tr><td>CST compromised mid-job</td><td>Revoke CST via clawscope; job-scoped binding prevents reuse in any other context</td><td>CST revocation event logged; anti-replay binding confirms no parallel usage</td></tr>\n<tr><td>WPC found to be overly permissive</td><td>Publish a new WPC version with tighter constraints; old hash is no longer pinned to new CSTs</td><td>WPC registry retains both versions; diff is auditable</td></tr>\n<tr><td>Agent produces incorrect plan</td><td>Discard the plan; no state mutation occurs until apply is approved</td><td>Gateway receipts capture the model output that generated the plan; proof bundle preserves the full decision trail</td></tr>\n</tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is Terraform Cloud integration available as a native connector today?</h3>\n<p>No. Terraform Cloud is connectable via official API with enterprise buildout controls. It is not shipped as a native connector. The integration requires configuring API tokens, WPC policies, and CST scoping as described in the runbook above.</p>\n\n<h3>Why can't prompt instructions replace policy-as-code for Terraform runs?</h3>\n<p>Prompt instructions are advisory. A model can ignore, misinterpret, or be manipulated past them via prompt injection. A WPC is a signed, hash-addressed artifact enforced by clawproxy at the network layer. The agent cannot bypass it regardless of what the model decides to do.</p>\n\n<h3>Can the agent be restricted to plan-only with no apply capability?</h3>\n<p>Yes. Set <code>\"operations\": [\"plan\"]</code> in the WPC and omit or disable the apply permission. The CST issued against this WPC will not authorize apply calls through the Terraform Cloud API.</p>\n\n<h3>How do gateway receipts help if something goes wrong in production?</h3>\n<p>Each receipt records the exact model call, including the prompt content hash and model response hash. During incident review, you can reconstruct the full chain of reasoning that led to a Terraform action, identify where the model went wrong, and determine whether the policy should have caught it.</p>\n\n<h3>Can I enforce cost budgets on Terraform runs automatically?</h3>\n<p>Automatic cost budget enforcement is planned but not yet shipped. Today, you can set workspace-level cost estimation in Terraform Cloud itself and use WPC approval gates to require human review before any apply that exceeds your threshold.</p>\n\n<h2>Sources</h2>\n\n<ul>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security</a></li>\n<li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n<li><a href=\"https://docs.aws.amazon.com/wellarchitected/latest/generative-ai-lens/gensec05-bp01.html\">AWS Well-Architected: Least Privilege for Agentic Workflows</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Terraform Cloud can be connected to OpenClaw agents via official API with enterprise buildout controls, but it must not be exposed without policy-as-code enforcement. An agent with unconstrained Terraform Cloud access ca",
  "faqs": [
    {
      "q": "Is Terraform Cloud integration available as a native connector today?",
      "a": "No. Terraform Cloud is connectable via official API with enterprise buildout controls. It is not shipped as a native connector. The integration requires configuring API tokens, WPC policies, and CST scoping as described in the runbook above."
    },
    {
      "q": "Why can't prompt instructions replace policy-as-code for Terraform runs?",
      "a": "Prompt instructions are advisory. A model can ignore, misinterpret, or be manipulated past them via prompt injection. A WPC is a signed, hash-addressed artifact enforced by clawproxy at the network layer. The agent cannot bypass it regardless of what the model decides to do."
    },
    {
      "q": "Can the agent be restricted to plan-only with no apply capability?",
      "a": "Yes. Set \"operations\": [\"plan\"] in the WPC and omit or disable the apply permission. The CST issued against this WPC will not authorize apply calls through the Terraform Cloud API."
    },
    {
      "q": "How do gateway receipts help if something goes wrong in production?",
      "a": "Each receipt records the exact model call, including the prompt content hash and model response hash. During incident review, you can reconstruct the full chain of reasoning that led to a Terraform action, identify where the model went wrong, and determine whether the policy should have caught it."
    },
    {
      "q": "Can I enforce cost budgets on Terraform runs automatically?",
      "a": "Automatic cost budget enforcement is planned but not yet shipped. Today, you can set workspace-level cost estimation in Terraform Cloud itself and use WPC approval gates to require human review before any apply that exceeds your threshold."
    }
  ],
  "sources": [
    {
      "title": "GENSEC05-BP01 Implement least privilege access and permissions boundaries for agentic workflows",
      "uri": "https://docs.aws.amazon.com/wellarchitected/latest/generative-ai-lens/gensec05-bp01.html"
    },
    {
      "title": "Identity and permissions",
      "uri": "https://cloud.google.com/agentspace/agentspace-enterprise/docs/identity"
    },
    {
      "title": "Access control with IAM",
      "uri": "https://cloud.google.com/agentspace/agentspace-enterprise/docs/access-control"
    },
    {
      "title": "Managing access for deployed agents",
      "uri": "https://docs.cloud.google.com/agent-builder/agent-engine/manage/access"
    },
    {
      "title": "Create and grant roles to service agents",
      "uri": "https://cloud.google.com/iam/docs/create-service-agents"
    },
    {
      "title": "Managing access for deployed agents",
      "uri": "https://cloud.google.com/vertex-ai/generative-ai/docs/agent-engine/manage/access"
    },
    {
      "title": "Getting started with the Security Foundations Blueprint automation ...",
      "uri": "https://cloud.google.com/blog/topics/developers-practitioners/getting-started-security-foundations-blueprint-automation-repo"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:40:43.954Z",
  "indexable": true
}