{
  "slug": "tools/gmail",
  "title": "Gmail for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<p>Gmail is a high-impact surface for enterprise agents because it combines sensitive data access with the ability to send messages that look official. In Claw EA, you should treat Gmail actions as permissioned execution: a Work Policy Contract (WPC) must explicitly allow what the agent can read, draft, send, label, or delete, and the run must be bound to scoped tokens (CST) so access is least-privilege and revocable.</p>\n<p>OpenClaw is the baseline agent runtime, but prompt-only instructions are not an authorization system. You need policy-as-code because Gmail risks come from tool calls, OAuth scopes, and misconfiguration, not just from what the model says it intends to do.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Define the Gmail use case and separate it into read-only and write paths. Treat “send email”, “modify mailbox state”, and “admin-like operations” as distinct capabilities with separate approvals.</p>\n  </li>\n  <li>\n    <p>Implement the Gmail connection via official API with enterprise buildout controls (this is not a native connector by default). Use OAuth or service account patterns appropriate to your Google Workspace setup, and choose explicit least-privilege Gmail API scopes for the path you are enabling.</p>\n  </li>\n  <li>\n    <p>Write a WPC that enumerates allowed Gmail actions, allowed target identities (which mailbox, which domain), and required human gates for high-risk steps. Publish the WPC to the WPC registry so it is signed and hash-addressed.</p>\n  </li>\n  <li>\n    <p>Issue a CST (from clawscope) for the job, and pin the CST to the WPC hash when you want the run to fail closed if policy changes. Use the job-scoped CST binding to reduce replay risk if a token leaks.</p>\n  </li>\n  <li>\n    <p>Run the agent in OpenClaw with a tight tool profile and sandboxing on, then expose Gmail as a single tool with narrow methods. Avoid giving the agent generic HTTP tooling to reach Gmail directly unless you can enforce the same WPC gates on those calls.</p>\n  </li>\n  <li>\n    <p>Route model calls through clawproxy so you get gateway receipts for model calls, then package the run outputs into a proof bundle. Store the proof bundle (or a pointer) in Trust Pulse when you need a durable audit artifact.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection via email content</td>\n      <td>An attacker sends an email that instructs the agent to forward threads, exfiltrate attachments, or change settings. The model may comply if it can reach Gmail tools without hard gates.</td>\n      <td>WPC rules that limit actions to a safe subset, plus tool policy in OpenClaw so Gmail is not callable outside approved flows. Keep read-only and write capabilities separated, and require approvals for “send” and “modify”.</td>\n    </tr>\n    <tr>\n      <td>OAuth scope overreach</td>\n      <td>The integration is authorized with broad scopes, so even a benign bug becomes a mailbox-wide incident. A single token can enable reading and sending across too much data.</td>\n      <td>Explicit least-privilege auth scopes, documented in the WPC and enforced in review. Use CST scope hash and optional policy hash pinning so jobs cannot silently expand privileges.</td>\n    </tr>\n    <tr>\n      <td>Impersonation and fraudulent outbound email</td>\n      <td>The agent sends convincing emails to vendors or employees, creating financial or legal exposure. Reply chains can amplify the impact because the message inherits trust.</td>\n      <td>WPC approval gates for outbound send, plus constraints like allowed recipient domains, allowed sender identity, and message templates. Add “draft only” mode as the default and require explicit promotion to “send”.</td>\n    </tr>\n    <tr>\n      <td>Mailbox state corruption</td>\n      <td>Misconfigured automation marks items as read, deletes messages, or mutates labels at scale. Recovery can be slow and incomplete.</td>\n      <td>WPC limits on batch size, label namespaces, and disallowed destructive actions by default. Prefer idempotent actions and require human gate for deletes or permanent changes.</td>\n    </tr>\n    <tr>\n      <td>Token replay across jobs</td>\n      <td>A leaked token is reused to run new actions outside the original job context. The attacker does not need the original agent state.</td>\n      <td>Marketplace anti-replay binding using job-scoped CST binding, plus short TTLs and revocation procedures. Bind each job to a specific WPC hash when the operation is sensitive.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This is a JSON-like sketch of a WPC for Gmail. The point is to make the allowed operations machine-checkable, not implied by a prompt like “only send safe emails”.</p>\n<pre>\n{\n  \"tool\": \"gmail\",\n  \"connection\": \"via_official_api_enterprise_buildout\",\n  \"identities\": {\n    \"allowedMailbox\": \"ops-triage@company.com\",\n    \"allowedSenderAliases\": [\"ops-triage@company.com\"]\n  },\n  \"auth\": {\n    \"oauthScopes\": [\n      \"gmail.readonly\",\n      \"gmail.send\"\n    ]\n  },\n  \"actions\": {\n    \"read\": {\n      \"allowed\": true,\n      \"queryAllowlist\": [\"label:inbox\", \"newer_than:14d\"],\n      \"attachmentPolicy\": { \"downloadAllowed\": false }\n    },\n    \"draft\": {\n      \"allowed\": true,\n      \"recipientDomainAllowlist\": [\"company.com\", \"trusted-vendor.com\"]\n    },\n    \"send\": {\n      \"allowed\": true,\n      \"requiresApproval\": true,\n      \"maxPerJob\": 10\n    },\n    \"modify\": {\n      \"allowed\": true,\n      \"labelAllowlist\": [\"triage/*\"],\n      \"deleteAllowed\": false\n    }\n  },\n  \"jobBinding\": {\n    \"requireCST\": true,\n    \"pinPolicyHash\": true\n  }\n}\n</pre>\n<p>In practice, your enterprise buildout should make “send” and “modify” fail closed unless the WPC is present and verified. If the agent lacks WPC approval for a method, the tool should refuse the call even if the prompt asks for it.</p>\n\n<h2>What proof do you get?</h2>\n<p>For model calls, clawproxy emits gateway receipts that can be verified later. This is especially useful when you route OpenRouter via fal through clawproxy, because you can prove which model endpoint was called and when.</p>\n<p>Claw EA bundles those receipts with policy and run metadata into a proof bundle. At minimum, you should expect the proof bundle to include the WPC hash that governed the run, the CST scope hash used for authorization, and job identifiers used for anti-replay binding.</p>\n<p>Trust Pulse can store and display the resulting artifact for audit viewing. If your Gmail integration is implemented via official API, the Gmail API call evidence typically comes from your integration logs and the Google Workspace audit trail, and can be attached to the same case file alongside the proof bundle in your enterprise process.</p>\n\n<h2>Rollback posture</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Stop new Gmail actions immediately</td>\n      <td>Revoke the CST and rotate to a new CST policy tier, then publish a new WPC revision that removes Gmail permissions. The agent continues to run, but Gmail tool calls fail closed.</td>\n      <td>WPC hash change record plus CST issuance and revocation records, and the proof bundle showing which WPC was active for the job.</td>\n    </tr>\n    <tr>\n      <td>Contain suspected token leakage</td>\n      <td>Invalidate the OAuth credentials used for Gmail access and re-consent with narrowed scopes. If using job-scoped CST binding, ensure old job tokens cannot be replayed into new jobs.</td>\n      <td>Proof bundle job metadata plus your OAuth provider logs and the before-and-after scope set documented in the WPC.</td>\n    </tr>\n    <tr>\n      <td>Undo mailbox state changes</td>\n      <td>Prefer reversible operations: labels instead of deletes, drafts instead of sends, “archive” with limits. For destructive actions, require approvals and keep batch sizes low so recovery is bounded.</td>\n      <td>Tool invocation summaries in run logs, Gmail audit trail, and the proof bundle tying the action window to a specific job.</td>\n    </tr>\n    <tr>\n      <td>Post-incident verification</td>\n      <td>Re-run verification on the proof bundle, then review gateway receipts to confirm which model calls occurred during the incident window. Use this to separate model behavior from tool authorization failures.</td>\n      <td>Gateway receipts for model calls and the associated proof bundle stored for the job, optionally published to Trust Pulse for consistent review.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is Gmail supported as a native connector in Claw EA today?</h3>\n<p>Not as a default native connector. Gmail can be connected via official API with enterprise buildout controls, and you should treat it as a high-risk tool that requires explicit WPC approval gates and least-privilege auth scopes.</p>\n\n<h3>Why is prompt-only control not enough for Gmail agents?</h3>\n<p>Because the real failure mode is a tool call with broad OAuth scopes, not an “unsafe sentence” in the prompt. Policy-as-code in a WPC makes the authorization boundary explicit and machine-enforced, even under prompt injection.</p>\n\n<h3>What should require approval for Gmail?</h3>\n<p>At minimum: send, delete, bulk modify, forwarding rules, and any action that affects external recipients. Many teams start with “draft only” and then gate “send” behind an approval step written into the WPC.</p>\n\n<h3>What do CST and WPC actually change operationally?</h3>\n<p>A CST scopes what a specific job is allowed to do and can be revoked quickly. A WPC is the signed policy artifact that defines the allowed Gmail actions and constraints, and you can pin the CST to the WPC hash to prevent policy drift during execution.</p>\n\n<h3>What audit artifacts should I keep for a Gmail incident?</h3>\n<p>Keep the proof bundle for the job, including gateway receipts for model calls, plus the WPC hash and CST scope hash that governed execution. Pair that with your Google Workspace audit logs for Gmail API activity and OAuth changes.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://cloud.google.com/gemini/enterprise/docs/connect-gmail\">Google Cloud: Connect to Gmail</a></li>\n  <li><a href=\"https://docs.cloud.google.com/gemini/enterprise/docs/security-overview\">Gemini Enterprise security overview</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Gmail is a high-impact surface for enterprise agents because it combines sensitive data access with the ability to send messages that look official. In Claw EA, you should treat Gmail actions as permissioned execution: a",
  "faqs": [
    {
      "q": "Is Gmail supported as a native connector in Claw EA today?",
      "a": "Not as a default native connector. Gmail can be connected via official API with enterprise buildout controls, and you should treat it as a high-risk tool that requires explicit WPC approval gates and least-privilege auth scopes."
    },
    {
      "q": "Why is prompt-only control not enough for Gmail agents?",
      "a": "Because the real failure mode is a tool call with broad OAuth scopes, not an “unsafe sentence” in the prompt. Policy-as-code in a WPC makes the authorization boundary explicit and machine-enforced, even under prompt injection."
    },
    {
      "q": "What should require approval for Gmail?",
      "a": "At minimum: send, delete, bulk modify, forwarding rules, and any action that affects external recipients. Many teams start with “draft only” and then gate “send” behind an approval step written into the WPC."
    },
    {
      "q": "What do CST and WPC actually change operationally?",
      "a": "A CST scopes what a specific job is allowed to do and can be revoked quickly. A WPC is the signed policy artifact that defines the allowed Gmail actions and constraints, and you can pin the CST to the WPC hash to prevent policy drift during execution."
    },
    {
      "q": "What audit artifacts should I keep for a Gmail incident?",
      "a": "Keep the proof bundle for the job, including gateway receipts for model calls, plus the WPC hash and CST scope hash that governed execution. Pair that with your Google Workspace audit logs for Gmail API activity and OAuth changes."
    }
  ],
  "sources": [
    {
      "title": "Gemini Enterprise: Best of Google AI for Business",
      "uri": "https://cloud.google.com/gemini-enterprise"
    },
    {
      "title": "Agentspace security overview",
      "uri": "https://cloud.google.com/agentspace/docs/security-overview"
    },
    {
      "title": "Connect to Gmail",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/connect-gmail"
    },
    {
      "title": "Connect to Gmail",
      "uri": "https://cloud.google.com/gemini/enterprise/docs/connect-gmail"
    },
    {
      "title": "Gemini Enterprise security overview | Google Cloud Documentation",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/security-overview"
    },
    {
      "title": "IAM roles and permissions | Gemini Enterprise",
      "uri": "https://docs.cloud.google.com/gemini/enterprise/docs/access-control"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T12:21:32.084Z",
  "indexable": true
}