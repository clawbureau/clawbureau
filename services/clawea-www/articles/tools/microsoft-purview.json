{
  "slug": "tools/microsoft-purview",
  "title": "Microsoft Purview for Permissioned Agents | Claw EA",
  "category": "tools",
  "html": "<h2>Direct Answer</h2>\n<p>Microsoft Purview helps you apply Microsoft 365 security and compliance controls (for example DLP, sensitivity labels, and auditing) to AI interactions and content. For enterprise AI agents, Purview is necessary but not sufficient because Purview does not control your agent’s execution path, tool selection, or privilege escalation.</p>\n<p>Claw EA runs agents on OpenClaw as the baseline agent runtime, then adds permissioned execution using policy-as-code: WPC = Work Policy Contract (signed, hash-addressed policy artifact; served by clawcontrols), CST = scoped token (issued by clawscope), gateway receipts (from clawproxy), and proof bundles. This is the layer that makes “who did what, under which policy, with which authority” enforceable and auditable, instead of depending on prompt wording.</p>\n\n<h2>Step-by-step runbook</h2>\n<p>Below is an operational way to connect Microsoft Purview via official API with enterprise buildout controls, while keeping the agent permissioned and reviewable. The goal is to let the agent read what it must, gate write and admin operations, and leave behind verifiable artifacts.</p>\n<ol>\n  <li>\n    <p><strong>Define the Purview blast radius per job.</strong> Decide which Purview areas the agent can touch (for example: read-only discovery versus configuration changes). List the specific data types and workloads in scope, and explicitly mark anything that is out of scope for agents.</p>\n  </li>\n  <li>\n    <p><strong>Model your identity and privileges in Entra ID.</strong> Use a dedicated app registration or workload identity for the agent integration, and restrict Microsoft Graph permissions/scopes to least privilege. If write or admin operations are needed, require Privileged Identity Management (PIM) activation and align Conditional Access policies to the service principal and the operator path.</p>\n  </li>\n  <li>\n    <p><strong>Write a WPC that encodes allowed operations.</strong> Put the Purview actions that are allowed into a WPC, including constraints like tenant, environment, and required approvals. Store the signed WPC in the WPC registry, and configure the runtime so policy hash pinning is used where you want the job to be immutable.</p>\n  </li>\n  <li>\n    <p><strong>Issue CST for the job and bind it to the policy.</strong> For each run, issue a CST with a scope hash that matches the WPC and (optionally) a pinned policy hash. Use job-scoped CST binding to reduce replay risk across jobs and environments.</p>\n  </li>\n  <li>\n    <p><strong>Route model calls through clawproxy.</strong> Run the agent so that LLM traffic is proxied by clawproxy, which emits gateway receipts for model calls. If you use OpenRouter via fal, keep it behind clawproxy so the receipts are generated consistently.</p>\n  </li>\n  <li>\n    <p><strong>Connect Purview via official API under an approval gate.</strong> Implement the Purview tool as an enterprise buildout that only executes write and admin actions after WPC approval gates pass, and only with explicit least-privilege auth scopes. For higher risk operations, require a second party approval in your control plane before the tool is allowed to run.</p>\n  </li>\n  <li>\n    <p><strong>Export a proof bundle and store the run artifact.</strong> At the end of the job, export a proof bundle that includes gateway receipts and run metadata, then store it for audit. For cross-team review, publish the run’s proof artifact into Trust Pulse for viewing.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Purview touches governance and compliance controls, so small mistakes can have broad impact. The table below lists concrete failure modes for agent-based access to Purview, and the controls that should be enforced at the execution layer.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection causes unintended Purview changes</td>\n      <td>The agent follows instructions embedded in email or documents and attempts to change DLP policies, labels, or investigation settings.</td>\n      <td>Permissioned execution: write and admin actions require WPC approval gates, and the Purview tool refuses calls that are not in-policy. CST scope hash is checked so off-policy calls fail closed.</td>\n    </tr>\n    <tr>\n      <td>Over-scoped Graph permissions</td>\n      <td>A misconfigured Entra ID app has broad Microsoft Graph permissions, so any compromise becomes tenant-wide.</td>\n      <td>Least privilege scopes, Conditional Access, and PIM for privileged operations. WPC lists required scopes and the runtime verifies the intended action matches the policy before execution.</td>\n    </tr>\n    <tr>\n      <td>Malicious or misconfigured plugin/tool</td>\n      <td>A tool claims to “query Purview” but also exfiltrates content, or quietly writes configuration changes.</td>\n      <td>OpenClaw tool policy allowlists and sandboxing reduce local blast radius, and WPC restricts which tool functions can execute. Proof bundles make later investigation concrete by showing what the agent actually called.</td>\n    </tr>\n    <tr>\n      <td>Replay of a previously valid job</td>\n      <td>A captured token or request is replayed to perform actions outside the original approval context.</td>\n      <td>Marketplace anti-replay binding using job-scoped CST binding. Jobs that do not match the intended binding are rejected.</td>\n    </tr>\n    <tr>\n      <td>Unverifiable “we think the agent did X” incidents</td>\n      <td>After an incident, you cannot prove which model calls occurred, or which policy version was in effect.</td>\n      <td>Gateway receipts from clawproxy plus proof bundles bind the run to model calls and policy identifiers. Verification can be done independently from the agent process logs.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>Prompt-only controls fail because the agent can be convinced to ignore them, and because reviewers cannot reliably determine what was enforced at runtime. A WPC makes the rules machine-checkable and hash-addressed, so the job can be pinned to an exact policy artifact.</p>\n\n<p>Example WPC-style constraints for a Purview tool (JSON-like):</p>\n<pre>\n{\n  \"policy_name\": \"purview-agent-readmostly\",\n  \"policy_hash\": \"b64u:... (pinned by job where required)\",\n  \"actor\": {\n    \"entra_tenant_id\": \"00000000-0000-0000-0000-000000000000\",\n    \"service_principal_id\": \"11111111-1111-1111-1111-111111111111\",\n    \"conditional_access_required\": true,\n    \"pim_required_for\": [\"purview.write\", \"purview.admin\"]\n  },\n  \"tools\": {\n    \"allow\": [\n      { \"tool\": \"purview.api\", \"actions\": [\"read:*\"] },\n      { \"tool\": \"purview.api\", \"actions\": [\"write:dlpPolicy\"], \"requires_approval\": true },\n      { \"tool\": \"purview.api\", \"actions\": [\"admin:*\"], \"deny\": true }\n    ],\n    \"deny\": [\n      { \"tool\": \"http\", \"reason\": \"no generic egress for this job\" }\n    ]\n  },\n  \"data\": {\n    \"allow_sensitivity_labels\": [\"Public\", \"Internal\"],\n    \"deny_sensitivity_labels\": [\"Confidential\", \"Highly Confidential\"]\n  },\n  \"attestation\": {\n    \"require_gateway_receipts\": true,\n    \"emit_proof_bundle\": true\n  }\n}\n</pre>\n\n<h2>What proof do you get?</h2>\n<p>For model calls, clawproxy emits gateway receipts that can be checked later to confirm which model was called, when, and under which job context. These receipts are designed to survive log shipping issues because they are separate signed artifacts.</p>\n<p>At the job level, Claw EA produces a proof bundle that packages the receipts plus metadata such as the job identity and policy identifiers (including WPC hash). For audit and sharing, you can store the relevant artifact in Trust Pulse for viewing, without requiring investigators to access the live runtime.</p>\n\n<h2>Rollback posture</h2>\n<p>Purview-related failures should be treated like configuration incidents: contain first, then restore from known-good policy and identity posture. The table below focuses on actions your team can take quickly, and what evidence you should preserve.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence to keep</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Suspected off-policy Purview write</td>\n      <td>Disable the agent job, revoke the CST, and revert Purview configuration via your standard change process. Re-run with a read-only WPC until the cause is confirmed.</td>\n      <td>Proof bundle, the WPC hash used, and gateway receipts for the time window.</td>\n    </tr>\n    <tr>\n      <td>Service principal permissions found too broad</td>\n      <td>Reduce Microsoft Graph permissions/scopes to least privilege, rotate credentials, and require Conditional Access checks. If PIM is used, tighten eligible roles and activation conditions.</td>\n      <td>Identity change records, affected job IDs, and the CST scope hashes issued during the exposure window.</td>\n    </tr>\n    <tr>\n      <td>Plugin/tool behavior is suspicious</td>\n      <td>Remove the tool from the OpenClaw allowlist and redeploy with a minimal tool profile. Only re-enable after code review and a new WPC that restricts the action surface.</td>\n      <td>Tool version identifiers, proof bundles from before and after, and any OpenClaw security audit output you captured.</td>\n    </tr>\n    <tr>\n      <td>Need to prove what happened to compliance</td>\n      <td>Freeze the run artifacts, verify the proof bundle, and share a Trust Pulse artifact for review. Do not rely on reconstructed chat transcripts as your primary evidence.</td>\n      <td>Verified receipts, the proof bundle, and the job-scoped CST binding context.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Is this a native Microsoft Purview connector in Claw EA?</h3>\n<p>No. Microsoft Purview can be connected via official API with enterprise buildout controls, and you should assume integration work is required for your tenant and your chosen Purview features.</p>\n\n<h3>Why do I need policy-as-code if Purview already has compliance controls?</h3>\n<p>Purview helps govern data and AI interactions, but it does not control which tools your agent executes or whether it attempts an out-of-scope write. WPC-enforced permissioning makes the execution layer fail closed, even when the prompt is manipulated.</p>\n\n<h3>How do you keep write and admin actions from happening accidentally?</h3>\n<p>Write and admin actions require WPC approval gates, CST, and explicit least-privilege auth scopes. If the job is not authorized for a specific action, the tool should refuse to execute it regardless of what the model requests.</p>\n\n<h3>What do auditors get that is better than logs?</h3>\n<p>Gateway receipts for model calls and a proof bundle for the job provide tamper-resistant artifacts tied to policy identifiers and job context. This makes it practical to verify what was executed without trusting a single log pipeline.</p>\n\n<h3>Does OpenClaw matter if we run agents somewhere else?</h3>\n<p>It matters because OpenClaw is the baseline runtime that enforces tool policy and optional sandboxing close to execution. Even if you later swap runtimes, the Claw Bureau primitives (WPC, CST, gateway receipts, proof bundles) give you a portable control plane for permissioned runs.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://learn.microsoft.com/en-us/purview/ai-agents\">Use Microsoft Purview to manage data security &amp; compliance for AI agents</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/purview/ai-microsoft-purview\">Microsoft Purview data security and compliance protections for generative AI apps</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/agent-framework/integrations/use-purview-with-agent-framework-sdk\">Use Microsoft Purview SDK with Agent Framework</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Microsoft Purview helps you apply Microsoft 365 security and compliance controls (for example DLP, sensitivity labels, and auditing) to AI interactions and content. For enterprise AI agents, Purview is necessary but not ",
  "faqs": [
    {
      "q": "Is this a native Microsoft Purview connector in Claw EA?",
      "a": "No. Microsoft Purview can be connected via official API with enterprise buildout controls, and you should assume integration work is required for your tenant and your chosen Purview features."
    },
    {
      "q": "Why do I need policy-as-code if Purview already has compliance controls?",
      "a": "Purview helps govern data and AI interactions, but it does not control which tools your agent executes or whether it attempts an out-of-scope write. WPC-enforced permissioning makes the execution layer fail closed, even when the prompt is manipulated."
    },
    {
      "q": "How do you keep write and admin actions from happening accidentally?",
      "a": "Write and admin actions require WPC approval gates, CST, and explicit least-privilege auth scopes. If the job is not authorized for a specific action, the tool should refuse to execute it regardless of what the model requests."
    },
    {
      "q": "What do auditors get that is better than logs?",
      "a": "Gateway receipts for model calls and a proof bundle for the job provide tamper-resistant artifacts tied to policy identifiers and job context. This makes it practical to verify what was executed without trusting a single log pipeline."
    },
    {
      "q": "Does OpenClaw matter if we run agents somewhere else?",
      "a": "It matters because OpenClaw is the baseline runtime that enforces tool policy and optional sandboxing close to execution. Even if you later swap runtimes, the Claw Bureau primitives (WPC, CST, gateway receipts, proof bundles) give you a portable control plane for permissioned runs."
    }
  ],
  "sources": [
    {
      "title": "Microsoft Purview data security and compliance protections for ...",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-microsoft-purview"
    },
    {
      "title": "Use Microsoft Purview to manage data security & compliance for AI agents",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-agents"
    },
    {
      "title": "Use Microsoft Purview to manage data security & compliance for ...",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-agent-365"
    },
    {
      "title": "Use Microsoft Purview SDK with Agent Framework",
      "uri": "https://learn.microsoft.com/en-us/agent-framework/integrations/use-purview-with-agent-framework-sdk"
    },
    {
      "title": "Security Copilot Agents in Microsoft Purview overview (preview)",
      "uri": "https://learn.microsoft.com/en-us/purview/copilot-in-purview-agents-overview"
    },
    {
      "title": "Get started with Microsoft Purview Posture Agent in Data Security ...",
      "uri": "https://learn.microsoft.com/en-us/purview/copilot-in-purview-posture-agent-get-started"
    },
    {
      "title": "Use Microsoft Purview to manage data security & compliance for ...",
      "uri": "https://learn.microsoft.com/en-us/purview/ai-copilot-studio"
    },
    {
      "title": "Get started with the Microsoft Purview Agents",
      "uri": "https://learn.microsoft.com/en-us/purview/copilot-in-purview-agents-get-started"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T16:48:15.127Z",
  "indexable": true
}