{
  "slug": "workflows/knowledge-base-updates",
  "title": "Knowledge base updates with review | Secure Agent Workflow | Claw EA",
  "category": "workflows",
  "html": "<h2>Direct Answer</h2>\n<p>This workflow lets an OpenClaw-based agent propose knowledge base (KB) changes while keeping publishing permissioned and reviewable. The agent can draft, cite sources, and open a change request, but it cannot publish until two humans approve under a Work Policy Contract (WPC).</p>\n<p>Prompt-only guardrails fail when the agent is given real credentials or tool access. Claw EA enforces policy-as-code with WPC and scoped tokens (CST), then produces gateway receipts and a proof bundle so you can verify what happened and roll back safely.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p><strong>Define the KB update boundary and “irreversible” actions.</strong> Treat “publish KB article” and “edit policies” as high risk. Everything else (read, summarize, draft, open PR) stays in the low risk lane by default.</p>\n    <p>Write this boundary into a WPC so the execution layer can enforce it even if the prompt is manipulated.</p>\n  </li>\n  <li>\n    <p><strong>Register a WPC and pin it for the job.</strong> Store the signed WPC in the WPC registry (served by clawcontrols). Configure the run so the CST includes optional policy hash pinning, meaning the token is only valid for that exact WPC.</p>\n    <p>This prevents “policy drift” mid-run and makes approvals reference a stable policy hash.</p>\n  </li>\n  <li>\n    <p><strong>Issue a CST that can draft but cannot publish.</strong> Use a CST (issued by clawscope) that only allows read access to the KB and writing drafts or change requests. If you use Git-based docs, allow “create branch / open PR” actions, but do not allow merging to protected branches.</p>\n    <p>Bind the CST to the job scope so replaying the token in a different job is rejected (marketplace anti-replay binding).</p>\n  </li>\n  <li>\n    <p><strong>Run the authoring agent in OpenClaw with a constrained tool profile.</strong> Use OpenClaw tool policy to expose only the “kb.read”, “kb.write_draft”, and “submit_for_review” tools you intend, and keep tool execution sandboxed where feasible. Run OpenClaw’s security audit regularly to catch common configuration footguns before you scale this workflow out.</p>\n    <p>Route model calls through clawproxy so each call produces gateway receipts that you can later verify.</p>\n  </li>\n  <li>\n    <p><strong>Perform step-up approvals with a two-person rule.</strong> Reviewer 1 checks content quality, citations, and that the change matches the request. Reviewer 2 confirms risk posture (no secrets, no policy changes, no unsafe instructions) and approves publication.</p>\n    <p>Only after both approvals are recorded do you mint a second, short-lived CST that includes the publish scope for that single article revision.</p>\n  </li>\n  <li>\n    <p><strong>Publish using a separate “publisher” action under the step-up CST.</strong> The publish action is a distinct tool call and should require explicit human confirmation in the control plane. The approval metadata (reviewers, timestamps, artifact hashes) should be attached to the run record so it is included in the proof bundle.</p>\n    <p>If the KB system is external, publishing is performed via official API or via an MCP server, with the publish CST restricted to only the minimum endpoint and object identifiers needed.</p>\n  </li>\n  <li>\n    <p><strong>Retain evidence and store the run artifact.</strong> Persist the proof bundle produced by the harness, including the WPC hash, CST scope hash, gateway receipts, and content hashes for drafts and published versions. Store the bundle in Trust Pulse for later viewing and audit review.</p>\n    <p>This evidence retention is what makes rollback practical: you can identify exactly what changed, by which token, under which policy.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>The core risks are not “bad text”; they are unauthorized tool use, replay of credentials, and silent changes that cannot be reconstructed later. The controls below assume the attacker can influence prompts, retrieved content, and chat messages, and that failures must be detectable after the fact.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection triggers “publish now”</td>\n      <td>The agent attempts to bypass review and publishes a KB article directly.</td>\n      <td>WPC denies publish tool unless step-up approval conditions are satisfied; publish requires a separate CST with publish scope and short TTL.</td>\n    </tr>\n    <tr>\n      <td>Single reviewer rubber-stamps changes</td>\n      <td>One compromised account approves harmful content or policy edits.</td>\n      <td>Two-person rule: two distinct human approvals required before minting the step-up publish CST; approvals are bound into the proof bundle metadata.</td>\n    </tr>\n    <tr>\n      <td>Replay of a token in another job</td>\n      <td>A CST captured from logs is reused to publish different content later.</td>\n      <td>Marketplace anti-replay binding (job-scoped CST binding) plus optional policy hash pinning so the CST is valid only for the intended WPC and job.</td>\n    </tr>\n    <tr>\n      <td>Model call disputes and “we never sent that”</td>\n      <td>After an incident, you cannot prove which model calls happened or what input constraints were applied.</td>\n      <td>Gateway receipts emitted by clawproxy for model calls, assembled into a proof bundle for verification and audit.</td>\n    </tr>\n    <tr>\n      <td>Agent edits governance policy instead of KB content</td>\n      <td>The agent changes permissions, review rules, or tool access to widen its own capabilities.</td>\n      <td>WPC explicitly blocks policy-edit tools; policy changes are treated as high risk and require a separate workflow and CST, not the KB update job.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This snippet is intentionally “JSON-like” to show the operational shape. Your actual WPC should enumerate the specific tools, object IDs, and approval requirements your KB platform needs.</p>\n\n<pre>\n{\n  \"wpc_version\": \"1\",\n  \"policy_name\": \"kb-updates-with-review\",\n  \"risk\": {\n    \"high_risk_actions\": [\"kb.publish\", \"governance.policy_edit\"]\n  },\n  \"tools\": {\n    \"allow\": [\n      \"kb.read\",\n      \"kb.write_draft\",\n      \"kb.create_change_request\",\n      \"kb.attach_citations\",\n      \"notifications.request_review\"\n    ],\n    \"deny\": [\n      \"governance.policy_edit\"\n    ],\n    \"gates\": [\n      {\n        \"tool\": \"kb.publish\",\n        \"requires\": {\n          \"step_up_approvals\": 2,\n          \"two_person_rule\": true,\n          \"artifact_hash_match\": true\n        }\n      }\n    ]\n  },\n  \"auth\": {\n    \"cst\": {\n      \"policy_hash_pinning\": \"optional\",\n      \"job_scoped_binding\": true\n    }\n  },\n  \"model_traffic\": {\n    \"proxy_required\": \"clawproxy\",\n    \"receipts_required\": true\n  }\n}\n</pre>\n\n<p>Why this must be policy-as-code: a prompt can ask the agent to “ignore prior instructions,” but the WPC is enforced by the execution layer. The result is fail-closed behavior for publish and policy-edit actions, regardless of what the model says.</p>\n\n<h2>What proof do you get?</h2>\n<p>Every model call routed through clawproxy yields gateway receipts that can be verified later. These receipts are not “logs”; they are signed artifacts intended for downstream verification and dispute resolution.</p>\n<p>At the end of the run, Claw EA produces a proof bundle that packages the gateway receipts with run metadata such as WPC hash, CST scope hash, timestamps, and content hashes of drafts and published outputs. You can store the proof bundle in Trust Pulse so reviewers and auditors can view the artifact without rerunning the job.</p>\n<p>If you need external verification, you can hand the proof bundle to a verifier workflow and check that the receipts match the policy constraints you expected. Operationally, this is how you prove “publishing happened only after two approvals” instead of trusting a UI screenshot.</p>\n\n<h2>Rollback posture</h2>\n<p>KB updates should be treated like production changes: they need a clear revert path and evidence that the revert restored the last known good state. The table below maps common actions to safe rollback steps and the evidence you should retain.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence to retain</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Draft created or edited</td>\n      <td>Discard the draft or revert to the previous draft revision; keep the change request open for re-review.</td>\n      <td>Proof bundle with draft content hash and the tool call sequence that produced it.</td>\n    </tr>\n    <tr>\n      <td>Change request opened (PR or KB review ticket)</td>\n      <td>Close or supersede the request; link to the replacement request so audit trails remain linear.</td>\n      <td>WPC hash, CST scope hash, and the review comments captured alongside the run record.</td>\n    </tr>\n    <tr>\n      <td>KB article published</td>\n      <td>Revert to the last published version or unpublish if your KB system supports it; then rotate the step-up CST issuance policy.</td>\n      <td>Gateway receipts for model calls plus the publish event metadata (article ID, version, timestamps) in the proof bundle.</td>\n    </tr>\n    <tr>\n      <td>Policy or permission changed (should be blocked here)</td>\n      <td>Revert the policy artifact to the prior WPC; revoke any CST issued under the widened policy.</td>\n      <td>Proof bundle showing the denied attempt (or the separate policy-change workflow’s bundle if it occurred outside this job).</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>Rollback is also where replay resistance matters. If a publish CST can be replayed, “rollback” becomes a loop of re-compromise, so keep publish CSTs short-lived, job-bound, and pinned to the WPC when possible.</p>\n\n<h2>FAQ</h2>\n\n<h3>How does review work without blocking productivity?</h3>\n<p>The agent does the time-consuming part: gather references, propose diffs, and format the draft consistently. Humans only step in at defined gates, and publishing is a separate step with a step-up CST.</p>\n\n<h3>What stops prompt injection from publishing directly?</h3>\n<p>The WPC denies publish by default, and the authoring CST does not include publish scope. Even if the model asks for publish, the tool call fails closed until two approvals trigger a separate, short-lived publish CST.</p>\n\n<h3>Can this workflow update SharePoint, Confluence, or another KB system?</h3>\n<p>Yes, via official API or via an MCP server, but you should treat “publish” as a distinct tool with its own approval gate. Keep API permissions narrow (object and scope restricted) and avoid giving the authoring CST any tenant-wide write rights.</p>\n\n<h3>What evidence can we show to auditors after an incident?</h3>\n<p>You can provide the proof bundle containing the WPC hash, CST scope hash, gateway receipts from clawproxy, and content hashes for what was drafted and what was published. That lets an auditor verify that publishing occurred under the intended policy and after the two-person approval gate.</p>\n\n<h3>How do we handle urgent hotfixes to a broken article?</h3>\n<p>Create a separate “emergency publish” WPC that still requires two-person approval but relaxes non-essential checks, then expire it quickly. Keep emergency publishes isolated so they do not become the default path for routine edits.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ai-agents/build-secure-process\">Process to build agents across your organization (Microsoft Learn)</a></li>\n  <li><a href=\"https://aws.amazon.com/blogs/security/the-agentic-ai-security-scoping-matrix-a-framework-for-securing-autonomous-ai-systems/\">The Agentic AI Security Scoping Matrix (AWS Security Blog)</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "This workflow lets an OpenClaw-based agent propose knowledge base (KB) changes while keeping publishing permissioned and reviewable. The agent can draft, cite sources, and open a change request, but it cannot publish unt",
  "faqs": [
    {
      "q": "How does review work without blocking productivity?",
      "a": "The agent does the time-consuming part: gather references, propose diffs, and format the draft consistently. Humans only step in at defined gates, and publishing is a separate step with a step-up CST."
    },
    {
      "q": "What stops prompt injection from publishing directly?",
      "a": "The WPC denies publish by default, and the authoring CST does not include publish scope. Even if the model asks for publish, the tool call fails closed until two approvals trigger a separate, short-lived publish CST."
    },
    {
      "q": "Can this workflow update SharePoint, Confluence, or another KB system?",
      "a": "Yes, via official API or via an MCP server, but you should treat “publish” as a distinct tool with its own approval gate. Keep API permissions narrow (object and scope restricted) and avoid giving the authoring CST any tenant-wide write rights."
    },
    {
      "q": "What evidence can we show to auditors after an incident?",
      "a": "You can provide the proof bundle containing the WPC hash, CST scope hash, gateway receipts from clawproxy, and content hashes for what was drafted and what was published. That lets an auditor verify that publishing occurred under the intended policy and after the two-person approval gate."
    },
    {
      "q": "How do we handle urgent hotfixes to a broken article?",
      "a": "Create a separate “emergency publish” WPC that still requires two-person approval but relaxes non-essential checks, then expire it quickly. Keep emergency publishes isolated so they do not become the default path for routine edits."
    }
  ],
  "sources": [
    {
      "title": "Microsoft Security Copilot Access Review Agent in Microsoft Entra - Microsoft Entra ID Governance",
      "uri": "https://learn.microsoft.com/en-us/entra/id-governance/access-review-agent"
    },
    {
      "title": "Process to build agents across your organization - Microsoft Learn",
      "uri": "https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/ai-agents/build-secure-process"
    },
    {
      "title": "The Agentic AI Security Scoping Matrix: A framework for ... - AWS",
      "uri": "https://aws.amazon.com/blogs/security/the-agentic-ai-security-scoping-matrix-a-framework-for-securing-autonomous-ai-systems/"
    },
    {
      "title": "Securing Agentic AI: The Agentic AI Security Scoping Matrix",
      "uri": "https://aws.amazon.com/ai/security/agentic-ai-scoping-matrix/"
    },
    {
      "title": "CSM AI Agent Collection: Triage cases agentic workflow",
      "uri": "https://www.servicenow.com/community/csm-articles/csm-ai-agent-collection-triage-cases-agentic-workflow/ta-p/3426619"
    },
    {
      "title": "Latest access control security enhancements for AI Agents and Skill Kit [Updated Zurich Patch 4]",
      "uri": "https://www.servicenow.com/community/now-assist-articles/latest-access-control-security-enhancements-for-ai-agents-and/ta-p/3374036"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T11:42:26.424Z",
  "indexable": true
}