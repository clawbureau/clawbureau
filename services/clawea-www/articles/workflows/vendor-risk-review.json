{
  "slug": "workflows/vendor-risk-review",
  "title": "Vendor risk review and security questionnaire automation | Secure Agent Workflow | Claw EA",
  "category": "workflows",
  "html": "<p>Use Claw EA to run a vendor risk review agent on OpenClaw with permissioned execution: the agent can draft questionnaire responses and analyze vendor evidence, but it cannot send questionnaires or share evidence without explicit, policy-gated approval.</p>\n<p>The control plane is policy-as-code, enforced by a Work Policy Contract (WPC), not prompt-only. Prompts can be ignored or manipulated; the execution layer must fail closed on high-risk actions and produce auditable proof for every external model call and release.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Define the workflow boundary and classify irreversible actions. Treat “send vendor questionnaires” and “share security evidence” as high risk and require step-up approvals for both.</p>\n    <p>Decide what the agent is allowed to do without approvals: read-only intake, summarization, mapping answers to a template, and generating a draft response pack.</p>\n  </li>\n  <li>\n    <p>Write a WPC that constrains tools, data handling, and approval gates. Store the signed, hash-addressed WPC in the WPC registry and configure your agent run to fetch and verify it before execution.</p>\n    <p>Keep the WPC narrow: allow only the minimum tools needed for intake, drafting, and producing redacted artifacts.</p>\n  </li>\n  <li>\n    <p>Issue a CST (scoped token) for the job from clawscope and pin it to the intended scope hash, optionally also pinning to the WPC policy hash. Use a new CST per questionnaire job to support marketplace anti-replay binding.</p>\n    <p>Do not reuse long-lived tokens for vendor communications workflows. Job scoping is what keeps later replay of approvals or sends from looking legitimate.</p>\n  </li>\n  <li>\n    <p>Route all model calls through clawproxy and keep the agent runtime honest. This yields gateway receipts for each model call and provides a stable boundary for later verification and audit.</p>\n    <p>If you use OpenRouter via fal, keep it routed through clawproxy so you still get gateway receipts and consistent policy enforcement at the proxy boundary.</p>\n  </li>\n  <li>\n    <p>Run the agent in a sandboxed tool environment and enforce local tool policy. OpenClaw supports sandboxing and tool allow/deny controls; use that as the local safety boundary around file access and execution.</p>\n    <p>Run OpenClaw’s security audit regularly to catch common footguns like overly open inbound policies or logging settings that could leak secrets.</p>\n  </li>\n  <li>\n    <p>Implement DLP and redaction as a required pre-send step. Require the agent to produce two artifacts: (1) a redacted “vendor-safe” packet, and (2) a private internal packet that never leaves the environment.</p>\n    <p>Make the redaction step machine-checked and deterministic, then require a human approver to confirm the final outbound payload and destination.</p>\n  </li>\n  <li>\n    <p>Gate outbound actions with step-up approvals and log the decision. The agent can propose an action plan and pre-fill a send payload, but the final “send questionnaire” and “share evidence” operations must require an explicit approval event tied to the job CST.</p>\n    <p>At the end of the run, export a proof bundle and store it for audit, optionally publishing the run artifact into Trust Pulse for viewing.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Vendor risk review workflows are high-leverage for data leakage because the agent handles security evidence, internal control descriptions, and operational details. The most damaging failures are outbound: sending the wrong content to the wrong party, or sending content that should never be external.</p>\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control (permissioned execution)</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection via vendor-provided documents</td>\n      <td>The agent is instructed to bypass process, exfiltrate internal evidence, or “just email it.”</td>\n      <td>WPC tool allowlist plus step-up approval gates for irreversible actions. The agent can draft but cannot send or share without a policy-checked approval event.</td>\n    </tr>\n    <tr>\n      <td>Wrong-recipient outbound send</td>\n      <td>Questionnaire or evidence is shared to the wrong vendor contact or wrong portal workspace.</td>\n      <td>Outbound destinations are constrained in WPC (domain allowlist or explicit recipient list) and the final send payload requires human approval with job binding.</td>\n    </tr>\n    <tr>\n      <td>Data leakage through model calls</td>\n      <td>Sensitive controls, keys, or internal architecture get included in prompts to the model provider.</td>\n      <td>DLP and redaction rules in WPC plus proxy routing through clawproxy, producing gateway receipts. The receipts support later review of what was sent to the model.</td>\n    </tr>\n    <tr>\n      <td>Replay of prior approvals</td>\n      <td>A previously-approved “send” is replayed later with modified content or destination.</td>\n      <td>Marketplace anti-replay binding using job-scoped CST binding. Approvals are tied to the specific job CST and cannot be reused across jobs.</td>\n    </tr>\n    <tr>\n      <td>Over-broad local tool access</td>\n      <td>The agent reads unintended files or accesses host execution paths.</td>\n      <td>OpenClaw sandboxing plus tool policy controls reduce blast radius. Keep elevated execution off unless explicitly required and justified in the WPC.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This is a compact, JSON-like sketch of the kind of policy you put into a WPC. It shows the operational controls that matter for vendor workflows: DLP and redaction, step-up approvals for irreversible actions, and job binding via CST policy pinning.</p>\n<pre>{\n  \"wpc_version\": \"1\",\n  \"policy_name\": \"vendor-risk-review-questionnaire\",\n  \"policy_hash_pinning\": {\n    \"require_wpc_hash\": true,\n    \"require_cst_scope_hash\": true\n  },\n  \"runtime\": {\n    \"baseline\": \"OpenClaw\",\n    \"sandbox\": { \"mode\": \"all\", \"workspaceAccess\": \"ro\" },\n    \"tools\": {\n      \"allow\": [\n        \"read\",\n        \"write\",\n        \"pdf_extract\",\n        \"doc_parse\",\n        \"template_fill\",\n        \"redact\",\n        \"summarize\"\n      ],\n      \"deny\": [ \"shell\", \"browser_control\", \"elevated_exec\" ]\n    }\n  },\n  \"dlp\": {\n    \"redaction_required\": true,\n    \"redaction_rules\": [\n      { \"type\": \"pattern\", \"name\": \"secrets\", \"match\": [\"API_KEY\", \"PRIVATE_KEY\", \"PASSWORD=\"], \"action\": \"remove\" },\n      { \"type\": \"pattern\", \"name\": \"customer_pii\", \"match\": [\"SSN\", \"DOB\", \"AccountNumber\"], \"action\": \"remove\" },\n      { \"type\": \"allowlist\", \"name\": \"approved_evidence_sections\", \"match\": [\"SOC2_summary\", \"security_overview\"], \"action\": \"keep_only\" }\n    ],\n    \"outbound_artifacts\": [\n      { \"name\": \"vendor_safe_packet\", \"must_be_redacted\": true },\n      { \"name\": \"internal_working_packet\", \"must_be_redacted\": false, \"must_not_leave_env\": true }\n    ]\n  },\n  \"irreversible_actions\": [\n    {\n      \"name\": \"send_vendor_questionnaire\",\n      \"requires_step_up_approval\": true,\n      \"approval_scope\": \"job\",\n      \"destination_constraints\": { \"allowed_email_domains\": [\"vendor-example.com\"] }\n    },\n    {\n      \"name\": \"share_security_evidence\",\n      \"requires_step_up_approval\": true,\n      \"approval_scope\": \"job\",\n      \"destination_constraints\": { \"allowed_portals\": [\"via official API\", \"via MCP server\"] }\n    }\n  ],\n  \"model_calls\": {\n    \"must_route_via\": \"clawproxy\",\n    \"receipts_required\": true\n  }\n}</pre>\n<p>In practice, you keep “destination_constraints” concrete and minimal. If a destination cannot be constrained by policy at runtime, treat it as “enterprise buildout” and require a manual send outside the agent boundary.</p>\n\n<h2>What proof do you get?</h2>\n<p>For every model call routed through clawproxy, you get gateway receipts that can be verified later. This matters when a vendor disputes what was asked, or when your internal review needs to confirm that sensitive evidence was not included in prompts.</p>\n<p>Each run produces a proof bundle that ties together: the WPC identity (hash-addressed policy), the CST identity (scope hash and job binding), and the set of gateway receipts for model calls. You can store or share the proof bundle for audit, and optionally publish the artifact into Trust Pulse for viewing.</p>\n<p>Operationally, this lets you answer two questions with evidence: what policy governed the run, and what external model interactions occurred under that policy. It also helps you separate “drafting” (reversible) from “release” (irreversible) with clear approval checkpoints.</p>\n\n<h2>Rollback posture</h2>\n<p>Vendor risk review is not just about preventing bad sends. It is also about having a safe rollback path when something goes wrong, with evidence that supports the rollback decision.</p>\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Agent drafted incorrect answers</td>\n      <td>Discard the draft packet, rerun with corrected internal inputs, and keep outbound actions disabled until review.</td>\n      <td>Proof bundle showing the WPC, CST job binding, and gateway receipts for the drafting run.</td>\n    </tr>\n    <tr>\n      <td>Agent prepared an outbound send payload but did not send</td>\n      <td>Revoke the job CST and invalidate the pending approval path. Require a new job CST for the next attempt.</td>\n      <td>CST issuance and revocation trail plus the proof bundle that shows no “send” step was approved.</td>\n    </tr>\n    <tr>\n      <td>Outbound send approved but destination looks wrong</td>\n      <td>Stop the workflow before execution and rotate to a new job with a corrected destination constraint set. If your outbound channel cannot be transactionally canceled, keep the actual send outside the agent boundary.</td>\n      <td>WPC destination constraints and the approval event binding to the job-scoped CST.</td>\n    </tr>\n    <tr>\n      <td>Suspicion of replay or copied approval artifact</td>\n      <td>Force new job scope and invalidate all previous job-scoped CSTs. Audit recent proof bundles for matching job bindings.</td>\n      <td>Marketplace anti-replay binding (job-scoped CST binding) and proof bundles for impacted jobs.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>What parts of vendor risk review can you safely automate?</h3>\n<p>Automate intake, normalization, and drafting: extracting vendor responses, mapping to your questionnaire format, summarizing evidence, and producing a redacted vendor-safe packet. Keep “send questionnaire” and “share evidence” behind step-up approvals and destination constraints.</p>\n\n<h3>Why is prompt-only control not enough for security questionnaires?</h3>\n<p>Because the failure mode is not “bad text,” it is an irreversible external action with sensitive data. Policy-as-code in a WPC enforces what tools can run and what actions require approvals, even if the prompt is manipulated.</p>\n\n<h3>How do you prevent the agent from leaking sensitive evidence to the model?</h3>\n<p>Require DLP and redaction before any outbound artifact is created, and route model calls through clawproxy so you have gateway receipts. This gives you an audit trail to confirm what was sent to the model provider during drafting.</p>\n\n<h3>What stops someone from replaying an approval to resend or share different content?</h3>\n<p>Use a job-scoped CST and marketplace anti-replay binding so approvals and sends are bound to that job. If anything looks off, revoke the CST and require a new job run under a new binding.</p>\n\n<h3>Do you integrate with vendor portals and ticketing systems?</h3>\n<p>Claw EA runs OpenClaw agents and enforces policy and proof at the execution layer. Portal and system actions can be implemented via official API, via MCP server, or as an enterprise buildout, with the same approval and proof requirements applied to the irreversible steps.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://aws.amazon.com/marketplace/pp/prodview-s6yu6zchpcjc4\">AWS Marketplace: Vendict GenAI for Security Questionnaire Automation</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Use Claw EA to run a vendor risk review agent on OpenClaw with permissioned execution: the agent can draft questionnaire responses and analyze vendor evidence, but it cannot send questionnaires or share evidence without ",
  "faqs": [
    {
      "q": "What parts of vendor risk review can you safely automate?",
      "a": "Automate intake, normalization, and drafting: extracting vendor responses, mapping to your questionnaire format, summarizing evidence, and producing a redacted vendor-safe packet. Keep “send questionnaire” and “share evidence” behind step-up approvals and destination constraints."
    },
    {
      "q": "Why is prompt-only control not enough for security questionnaires?",
      "a": "Because the failure mode is not “bad text,” it is an irreversible external action with sensitive data. Policy-as-code in a WPC enforces what tools can run and what actions require approvals, even if the prompt is manipulated."
    },
    {
      "q": "How do you prevent the agent from leaking sensitive evidence to the model?",
      "a": "Require DLP and redaction before any outbound artifact is created, and route model calls through clawproxy so you have gateway receipts. This gives you an audit trail to confirm what was sent to the model provider during drafting."
    },
    {
      "q": "What stops someone from replaying an approval to resend or share different content?",
      "a": "Use a job-scoped CST and marketplace anti-replay binding so approvals and sends are bound to that job. If anything looks off, revoke the CST and require a new job run under a new binding."
    },
    {
      "q": "Do you integrate with vendor portals and ticketing systems?",
      "a": "Claw EA runs OpenClaw agents and enforces policy and proof at the execution layer. Portal and system actions can be implemented via official API, via MCP server, or as an enterprise buildout, with the same approval and proof requirements applied to the irreversible steps."
    }
  ],
  "sources": [
    {
      "title": "Trustero AI Driven Advisor for Governance, Risk, and Compliance",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-fycxdxxhez46q"
    },
    {
      "title": "Vendict GenAI for Security Questionnaire Automation - AWS",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-s6yu6zchpcjc4"
    },
    {
      "title": "AWS Marketplace: Venminder Third-Party Risk Enterprise Platform",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-eqtecv5ydfhxs"
    },
    {
      "title": "Vendor Management Hub - AWS Marketplace - Amazon.com",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-at7yzdzkavsls"
    },
    {
      "title": "Vendict GenAI for Security Questionnaire Automation",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-tr62uejctgzog"
    },
    {
      "title": "AWS Marketplace: SecurityScorecard [Private Offer Only]",
      "uri": "https://aws.amazon.com/marketplace/pp/prodview-dopiois7lvf24"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T11:54:00.947Z",
  "indexable": true
}