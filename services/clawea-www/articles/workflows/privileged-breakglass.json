{
  "slug": "workflows/privileged-breakglass",
  "title": "Privileged break-glass workflows (timeboxed) | Secure Agent Workflow | Claw EA",
  "category": "workflows",
  "html": "<h2>Direct Answer</h2>\n<p>A timeboxed privileged break-glass workflow lets an OpenClaw-based agent perform a narrowly scoped, high-risk action (like temporary admin grant or disabling a control) only after step-up approvals, with an explicit expiry and a pre-planned rollback.</p>\n<p>In Claw EA, this is enforced at the execution layer with policy-as-code, not prompt-only instructions, using a WPC = Work Policy Contract (signed, hash-addressed policy artifact; served by clawcontrols) plus a CST = scoped token (issued by clawscope) that is pinned to that policy and job.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p><strong>Define the break-glass objective and rollback before you run anything.</strong> Write down the exact irreversible action (for example: “temporarily activate Entra ID privileged role for user X” or “temporarily exclude a device group from Conditional Access”) and the precise rollback (for example: “remove role assignment, restore policy, validate sign-in logs”).</p>\n    <p>Keep the rollback mechanically executable, not a narrative. If you cannot articulate rollback, treat the action as not eligible for agent execution.</p>\n  </li>\n  <li>\n    <p><strong>Create a timeboxed WPC and publish it.</strong> The WPC should define the allowed tools, allowed targets, and a hard TTL for privilege. Keep it task-specific and prohibit tool expansion during the run.</p>\n    <p>Host it in the WPC registry and require proxy fetch/verify so the running agent cannot silently swap policy.</p>\n  </li>\n  <li>\n    <p><strong>Issue a job-scoped CST that is pinned to the WPC.</strong> The CST should include a scope hash and optional policy hash pinning, and it must be bound to a single job to prevent replay.</p>\n    <p>Use short TTLs. Make renewal require the same approvals as the original break-glass request.</p>\n  </li>\n  <li>\n    <p><strong>Enforce the two-person rule with step-up approvals.</strong> Require two separate humans to approve: one requester and one approver who is not the requester. For Microsoft actions, align approval to your existing control plane (for example: Entra ID PIM approval workflows) and treat the agent as the executor, not the policy decision-maker.</p>\n    <p>If the approvals are outside Claw EA, treat them as prerequisites and record the approval identifiers in job metadata for audit correlation.</p>\n  </li>\n  <li>\n    <p><strong>Run under constrained execution, not prompt promises.</strong> Use OpenClaw as the baseline runtime and enforce tool policy and sandboxing so the agent can only execute the exact “break-glass tool” path. Do not rely on “the prompt says do not do X”; prompts do not stop tool calls when a model is confused or injected.</p>\n    <p>For model traffic, route through clawproxy so you get Gateway receipts = signed receipts emitted by clawproxy for model calls.</p>\n  </li>\n  <li>\n    <p><strong>Execute the privileged step via official API, then verify state.</strong> If the action touches Microsoft, execute via Microsoft Graph via official API using explicit Graph permissions/scopes that match the minimum operation. Immediately perform a verification read to confirm the change took effect and that no additional principals were modified.</p>\n    <p>Keep “verification reads” in-scope in the same WPC so verification cannot be skipped without failing policy.</p>\n  </li>\n  <li>\n    <p><strong>End the window: rollback, then invoke the kill switch posture.</strong> Perform rollback steps even if the incident appears resolved. Then halt the job and revoke the CST to guarantee no further privileged calls can succeed under that run.</p>\n    <p>If you need to stop mid-run, the emergency halt is: revoke CST, stop the OpenClaw session, and rotate any credentials touched during the window.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Break-glass failures are rarely “a model went rogue” in isolation. They are usually a combination of overbroad tokens, unclear operator approval, and missing rollback under time pressure.</p>\n<p>The table below lists concrete failure modes and how to control them using shipped Claw Bureau primitives and OpenClaw runtime constraints.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection causes unintended privileged action</td>\n      <td>The agent follows untrusted input and calls a privileged tool path.</td>\n      <td>Permissioned execution: WPC tool allowlist and target constraints, plus CST scope hash and policy hash pinning. Use OpenClaw tool policy and sandboxing; avoid elevated host execution for break-glass unless explicitly required.</td>\n    </tr>\n    <tr>\n      <td>Token replay or lateral use</td>\n      <td>A CST leaks and is reused for another job or by another component.</td>\n      <td>Marketplace anti-replay binding with job-scoped CST binding. Short TTLs and immediate revocation after use.</td>\n    </tr>\n    <tr>\n      <td>Approval spoofing</td>\n      <td>A single operator claims approval without a second reviewer.</td>\n      <td>Two-person rule and step-up approvals as a gating prerequisite. Record approver identities and timestamps in job metadata and require both before CST issuance.</td>\n    </tr>\n    <tr>\n      <td>Privilege does not expire</td>\n      <td>Temporary admin remains active and becomes the new steady state.</td>\n      <td>Timeboxed WPC plus operational rollback checklist. Verify post-rollback state reads as part of the same run.</td>\n    </tr>\n    <tr>\n      <td>Operator cannot prove what the model was asked or what it did</td>\n      <td>After incident, you cannot reconstruct model calls and tool intent.</td>\n      <td>Gateway receipts for model calls routed through clawproxy, bundled into a proof bundle for audit and verification.</td>\n    </tr>\n    <tr>\n      <td>Host escape via elevated execution</td>\n      <td>A “temporary” break-glass job becomes host-level access.</td>\n      <td>Prefer OpenClaw sandboxed tool execution. If elevated is unavoidable, make it explicit in the WPC and keep the window shorter with stricter approvals.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This snippet shows the shape of a timeboxed break-glass policy. Treat it as JSON-like pseudocode to communicate intent, then implement as a signed WPC and enforce it with CST pinning.</p>\n\n<pre>\n{\n  \"policy_name\": \"breakglass-temporary-admin-timeboxed\",\n  \"wpc\": {\n    \"hash\": \"b64u:POLICY_HASH\",\n    \"requires_proxy_fetch_verify\": true\n  },\n  \"approvals\": {\n    \"two_person_rule\": true,\n    \"step_up\": {\n      \"required\": true,\n      \"min_approvers\": 2,\n      \"constraints\": { \"approver_must_not_equal_requester\": true }\n    }\n  },\n  \"timebox\": {\n    \"max_duration_minutes\": 30,\n    \"cst_max_ttl_minutes\": 30,\n    \"no_renew_without_reapproval\": true\n  },\n  \"execution\": {\n    \"runtime\": \"OpenClaw\",\n    \"tools_allowlist\": [\n      \"breakglass.microsoft_graph.write_role_assignment\",\n      \"breakglass.microsoft_graph.read_role_assignment\",\n      \"breakglass.rollback.remove_role_assignment\"\n    ],\n    \"tools_denylist\": [\n      \"shell.exec\",\n      \"tools.elevated\"\n    ],\n    \"target_constraints\": {\n      \"tenant_id\": \"GUID\",\n      \"allowed_principals\": [\"user:alice@corp.example\"],\n      \"allowed_roles\": [\"Privileged Role Administrator\"]\n    }\n  },\n  \"network\": {\n    \"model_calls_must_use\": \"clawproxy\",\n    \"provider\": \"OpenRouter via fal (through clawproxy)\"\n  },\n  \"kill_switch\": {\n    \"on_trigger\": [\"revoke_cst\", \"halt_job\"],\n    \"triggers\": [\"approval_revoked\", \"timebox_expired\", \"unexpected_target_detected\"]\n  },\n  \"audit\": {\n    \"require_gateway_receipts\": true,\n    \"emit_proof_bundle\": true\n  }\n}\n</pre>\n\n<p>Prompt-only guidance cannot enforce any of the above. A prompt can be ignored, overwritten, or become ambiguous under pressure, while a WPC plus CST constrains what can execute even if the model output degrades.</p>\n\n<h2>What proof do you get?</h2>\n<p>For privileged runs, the minimum useful evidence is: which policy was in force, which model calls occurred, and which job the authorization belonged to. Claw EA focuses on producing that evidence as a machine-checkable record.</p>\n<p>You get Gateway receipts for model calls from clawproxy, and a proof bundle that packages receipts plus run metadata so you can verify the run later. If you store the result in Trust Pulse, you have a consistent place to view the artifact and correlate it with the incident ticket.</p>\n<p>Operationally, this means you can answer “did the model ever see secret X,” “did it call the model outside the approved route,” and “was this CST bound to this job and this WPC hash” without relying on screenshots or human recollection.</p>\n\n<h2>Rollback posture</h2>\n<p>Break-glass is only safe if rollback is treated as part of the workflow, not a follow-up task. The rollback plan should be executable even if the original operator is offline.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Grant temporary admin</td>\n      <td>Remove role assignment; confirm no additional principals gained the role; revoke CST; re-run verification reads.</td>\n      <td>Proof bundle with receipts for the privileged call and the rollback call, plus the pinned WPC hash.</td>\n    </tr>\n    <tr>\n      <td>Disable security controls</td>\n      <td>Re-enable the control; validate the effective policy state; rotate any credentials exposed during the window; halt the job.</td>\n      <td>Receipts showing the model call sequence and job-scoped CST binding preventing reuse.</td>\n    </tr>\n    <tr>\n      <td>Suspected compromise mid-run</td>\n      <td>Emergency halt: revoke CST immediately, stop OpenClaw session, and invalidate any temporary admin grants made in the window.</td>\n      <td>CST revocation record (from issuance system) plus proof bundle showing last successful model calls before halt.</td>\n    </tr>\n  </tbody>\n</table>\n\n<p>If you need stronger network containment, egress allowlists enforced outside clawproxy can be implemented as an additional control, but treat it as optional and environment-specific.</p>\n\n<h2>FAQ</h2>\n\n<h3>Why is policy-as-code required instead of putting “do not escalate” in the prompt?</h3>\n<p>Prompts shape model behavior but do not enforce execution. A privileged break-glass workflow needs a hard boundary: the tool calls and targets must be restricted by WPC and CST so the runtime cannot execute outside the approved envelope.</p>\n\n<h3>How do two-person rule and step-up approvals work in practice?</h3>\n<p>Two-person rule means one human requests and a different human approves, with both captured before the CST is issued. Step-up approvals mean the privileged step is blocked until the approval is present, commonly aligned to existing enterprise controls like Entra ID PIM approval flows.</p>\n\n<h3>Can this be used for Microsoft Entra ID and Microsoft Graph?</h3>\n<p>Yes, if your break-glass tool calls Microsoft Graph via official API and the Graph permissions/scopes are narrowly granted for the specific operation. Do not give broad directory write scopes to an agent run; use the minimum permissions that satisfy the change and require verification reads.</p>\n\n<h3>What is the kill switch during a live incident?</h3>\n<p>The practical kill switch is to revoke the CST and halt the job so further privileged calls fail closed. Pair that with immediate rollback steps like removing temporary role assignments and restoring configuration.</p>\n\n<h3>What should be timeboxed: the policy, the token, or the role assignment?</h3>\n<p>All three. The WPC should declare the maximum window, the CST should have an equal or shorter TTL with no silent renewal, and the privileged assignment should be created with an explicit expiration where supported.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/entra/architecture/secure-best-practices\">Best practices to secure with Microsoft Entra ID</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/azure/logic-apps/set-up-authentication-agent-workflows\">Protect Agent Workflows with Easy Auth (Azure Logic Apps)</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "A timeboxed privileged break-glass workflow lets an OpenClaw-based agent perform a narrowly scoped, high-risk action (like temporary admin grant or disabling a control) only after step-up approvals, with an explicit expi",
  "faqs": [
    {
      "q": "Why is policy-as-code required instead of putting “do not escalate” in the prompt?",
      "a": "Prompts shape model behavior but do not enforce execution. A privileged break-glass workflow needs a hard boundary: the tool calls and targets must be restricted by WPC and CST so the runtime cannot execute outside the approved envelope."
    },
    {
      "q": "How do two-person rule and step-up approvals work in practice?",
      "a": "Two-person rule means one human requests and a different human approves, with both captured before the CST is issued. Step-up approvals mean the privileged step is blocked until the approval is present, commonly aligned to existing enterprise controls like Entra ID PIM approval flows."
    },
    {
      "q": "Can this be used for Microsoft Entra ID and Microsoft Graph?",
      "a": "Yes, if your break-glass tool calls Microsoft Graph via official API and the Graph permissions/scopes are narrowly granted for the specific operation. Do not give broad directory write scopes to an agent run; use the minimum permissions that satisfy the change and require verification reads."
    },
    {
      "q": "What is the kill switch during a live incident?",
      "a": "The practical kill switch is to revoke the CST and halt the job so further privileged calls fail closed. Pair that with immediate rollback steps like removing temporary role assignments and restoring configuration."
    },
    {
      "q": "What should be timeboxed: the policy, the token, or the role assignment?",
      "a": "All three. The WPC should declare the maximum window, the CST should have an equal or shorter TTL with no silent renewal, and the privileged assignment should be created with an explicit expiration where supported."
    }
  ],
  "sources": [
    {
      "title": "Best practices to secure with Microsoft Entra ID",
      "uri": "https://learn.microsoft.com/en-us/entra/architecture/secure-best-practices"
    },
    {
      "title": "Protect Agent Workflows with Easy Auth - Azure Logic Apps",
      "uri": "https://learn.microsoft.com/en-us/azure/logic-apps/set-up-authentication-agent-workflows"
    },
    {
      "title": "GENSEC05-BP01 Implement least privilege access and permissions boundaries for agentic workflows",
      "uri": "https://docs.aws.amazon.com/wellarchitected/latest/generative-ai-lens/gensec05-bp01.html"
    },
    {
      "title": "Capability 3. Providing secure access, usage, and implementation of generative AI autonomous agents",
      "uri": "https://docs.aws.amazon.com/prescriptive-guidance/latest/security-reference-architecture/gen-ai-agents.html"
    },
    {
      "title": "Design secure generative AI application workflows with Amazon Verified Permissions and Amazon Bedrock Agents | Amazon Web Services",
      "uri": "https://aws.amazon.com/blogs/machine-learning/design-secure-generative-ai-application-workflows-with-amazon-verified-permissions-and-amazon-bedrock-agents"
    },
    {
      "title": "Agent IAM and the Principle of Least Privilege",
      "uri": "https://community.sap.com/t5/security-and-compliance-blog-posts/limiting-agent-autonomy-least-privilege-and-tool-access-for-agentic-ai/ba-p/14224584"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T11:45:53.620Z",
  "indexable": true
}