{
  "slug": "workflows/siem-evidence-collection",
  "title": "Compliance evidence collection to SIEM | Secure Agent Workflow | Claw EA",
  "category": "workflows",
  "html": "<h1>Compliance evidence collection to SIEM (Permissioned Execution)</h1>\n\n<p>Use OpenClaw as the baseline agent runtime, but treat evidence export as a controlled workflow: policy decides what the agent can read, what it can send out, and what proof it must emit. In Claw EA, you attach a WPC (Work Policy Contract) to the job, issue a CST (scoped token), route model calls through clawproxy for gateway receipts, and emit a proof bundle that your SIEM can ingest via official API.</p>\n<p>This works better than prompt-only controls because prompts do not bind execution. A signed WPC plus scoped credentials is machine-checkable, so the system can fail closed when the job deviates from allowed tools, destinations, or evidence handling rules.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Define the evidence boundary and treat two actions as high risk: exporting logs and sharing evidence artifacts. Decide what the agent is allowed to read (log sources), what transformations it may run (parsing, normalization), and what it may emit (OCSF-like events, summaries, or hashes only).</p>\n  </li>\n  <li>\n    <p>Create and register a WPC (Work Policy Contract) that encodes tool allowlists, evidence redaction requirements, and export constraints. Pin the policy hash in the run so operators can prove exactly which policy governed the job.</p>\n  </li>\n  <li>\n    <p>Issue a CST (scoped token) from clawscope for this specific job, with scope hash and optional WPC hash pinning. Use job-scoped binding to reduce replay risk, so a token stolen from one run does not remain useful for another run.</p>\n  </li>\n  <li>\n    <p>Run the agent in OpenClaw with sandboxing enabled for the sessions that touch data and produce exports. Use OpenClaw tool policy to allow only the minimum tools required for log reading, parsing, and packaging.</p>\n  </li>\n  <li>\n    <p>Route model calls through clawproxy so each call produces gateway receipts. If you use OpenRouter via fal, keep it behind clawproxy so receipts and policy checks remain consistent across models.</p>\n  </li>\n  <li>\n    <p>Transform agent activity and outputs into SIEM-ready events, ideally in an OCSF-aligned structure for correlation with existing security telemetry. Send events to your SIEM via official API (for example, an HTTP event collector endpoint) and keep the raw evidence in controlled storage rather than pushing everything into the SIEM.</p>\n  </li>\n  <li>\n    <p>Emit a proof bundle at the end of the run that includes gateway receipts and metadata required for verification. Store the proof bundle (and optionally publish a Trust Pulse artifact for audit viewing) so compliance teams can validate what ran, under which WPC, and which model calls occurred.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection causes unauthorized evidence export</td>\n      <td>The agent is tricked into sending raw logs or sensitive fields to an external destination, or into “helpfully” attaching extra context.</td>\n      <td>Permissioned execution: WPC restricts export tools and destinations; DLP and redaction rules are enforced as a required pipeline step before any “export logs” or “share evidence artifacts” action.</td>\n    </tr>\n    <tr>\n      <td>Token replay across runs</td>\n      <td>A CST is copied and reused to push evidence outside approved timing or scope, or to call models and regenerate artifacts.</td>\n      <td>Marketplace anti-replay binding with job-scoped CST binding, plus optional policy hash pinning so a token is valid only for the intended WPC context.</td>\n    </tr>\n    <tr>\n      <td>Disputed model-generated conclusion</td>\n      <td>An auditor asks: “Which model saw which inputs and produced which output?” and the team cannot show a verifiable trail.</td>\n      <td>Gateway receipts from clawproxy for model calls, bundled into a proof bundle that can be re-verified later.</td>\n    </tr>\n    <tr>\n      <td>Over-collection into SIEM</td>\n      <td>Raw logs with secrets or regulated fields are pushed into the SIEM, multiplying access paths and retention risk.</td>\n      <td>WPC mandates minimal exports (structured events, hashes, and references), plus DLP/redaction prior to export. Keep raw evidence in controlled storage and export only what detection and audit require.</td>\n    </tr>\n    <tr>\n      <td>Network exfiltration outside intended domains</td>\n      <td>The agent uses a generic HTTP tool to send data to a lookalike host or an unexpected IP.</td>\n      <td>Egress allowlists can be implemented outside clawproxy (optional) and paired with WPC-declared destination allowlists so violations are detected and the job can be stopped.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>This is a compact JSON-like sketch of a WPC payload focusing on evidence export safety. It makes export actions explicit, forces redaction, and limits where evidence can go.</p>\n<pre>\n{\n  \"wpc_version\": \"1\",\n  \"policy_name\": \"siem-evidence-collection\",\n  \"policy_hash_pin\": \"b64u:...\",\n\n  \"runtime\": {\n    \"baseline\": \"OpenClaw\",\n    \"sandbox\": { \"mode\": \"all\", \"workspaceAccess\": \"ro\" },\n    \"tools\": {\n      \"allow\": [\"read_logs\", \"parse\", \"hash\", \"package_evidence\", \"http_export\"],\n      \"deny\": [\"shell\", \"write_filesystem\", \"browser_control\"]\n    }\n  },\n\n  \"egress\": {\n    \"allowlist\": {\n      \"domains\": [\"siem.example.com\", \"logs.example.com\"],\n      \"ips\": [\"203.0.113.10/32\"]\n    },\n    \"enforcement\": \"can be implemented outside clawproxy\"\n  },\n\n  \"dlp\": {\n    \"redaction_required\": true,\n    \"rules\": [\n      { \"type\": \"regex\", \"match\": \"(?i)api[_-]?key\\\\s*[:=]\\\\s*\\\\S+\", \"replace\": \"[REDACTED]\" },\n      { \"type\": \"field\", \"fields\": [\"password\", \"secret\", \"token\", \"ssn\"], \"action\": \"drop_or_mask\" }\n    ],\n    \"export_block_if_unredacted\": true\n  },\n\n  \"irreversible_actions\": {\n    \"export_logs\": { \"require_approval\": true, \"max_records\": 5000 },\n    \"share_evidence_artifacts\": { \"require_approval\": true }\n  },\n\n  \"auth\": {\n    \"cst\": { \"issuer\": \"clawscope\", \"job_scoped_binding\": true }\n  },\n\n  \"budgets\": {\n    \"token_budget\": \"planned_or_enterprise_buildout\",\n    \"cost_budget\": \"planned_or_enterprise_buildout\"\n  },\n\n  \"proof\": {\n    \"require_gateway_receipts\": true,\n    \"emit_proof_bundle\": true\n  }\n}\n</pre>\n<p>The key difference versus a “be careful” prompt is that this contract is signed and hash-addressed. Your runtime and proxy can verify the WPC and refuse to export if redaction is missing or a destination is outside the allowlist.</p>\n\n<h2>What proof do you get?</h2>\n<p>Every model call routed through clawproxy produces gateway receipts, which give you a tamper-evident record of the calls made under the job’s CST and policy context. These receipts are assembled into a proof bundle with the job metadata needed for later verification, including policy hash references and run identifiers.</p>\n<p>For compliance evidence collection, the proof bundle is the artifact you hand to audit and incident review teams. If you use Trust Pulse, you can store and view the audit artifact there without relying on ad hoc screenshots or manual exports.</p>\n\n<h2>Rollback posture</h2>\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Wrong destination configured for SIEM export</td>\n      <td>Rotate or revoke the CST, and re-run the job with a corrected WPC allowlist. Treat previously exported payloads as leaked and follow your IR process.</td>\n      <td>Proof bundle shows which destination was used, plus gateway receipts for the model calls that prepared the payload.</td>\n    </tr>\n    <tr>\n      <td>Redaction rule missed a sensitive pattern</td>\n      <td>Stop exports, update WPC DLP rules, and re-run only on the minimum necessary subset to regenerate sanitized events. If needed, delete impacted SIEM events via official API according to your retention controls.</td>\n      <td>Proof bundle ties the run to the WPC hash, so you can show which redaction rules were in force for the impacted export.</td>\n    </tr>\n    <tr>\n      <td>Unexpected tool usage during collection</td>\n      <td>Tighten OpenClaw tool policy and update the WPC tool allowlist, then re-run in sandboxed mode. Keep the previous proof bundle for postmortem and auditing.</td>\n      <td>OpenClaw configuration plus the job’s proof bundle provide a concrete record of allowed versus observed behavior, and whether model calls were made under policy.</td>\n    </tr>\n    <tr>\n      <td>Suspected token replay attempt</td>\n      <td>Revoke CSTs and require a new job-scoped CST binding for subsequent runs. Re-verify the affected proof bundles and isolate any exports performed outside the expected job window.</td>\n      <td>Job-scoped CST binding metadata in the proof bundle supports replay investigation, alongside gateway receipts for attempted activity.</td>\n    </tr>\n  </tbody>\n</table>\n<p>Rollback is not only about stopping an agent. It is about proving what happened, then re-running with a tighter WPC so your evidence trail stays consistent and reviewable.</p>\n\n<h2>FAQ</h2>\n\n<h3>Why is prompt-only governance not enough for SIEM evidence collection?</h3>\n<p>Prompts do not provide a verifiable boundary around tools, destinations, or redaction. A WPC plus CST makes those constraints machine-checkable, so exports can be blocked when rules are not satisfied.</p>\n\n<h3>What should we send to the SIEM versus keep in evidence storage?</h3>\n<p>Send structured, minimal events that support detection and audit, plus stable references like hashes and run IDs. Keep raw logs and bulky artifacts in controlled storage and export only what you can justify and retain safely.</p>\n\n<h3>How do we normalize agent activity into a SIEM-friendly schema?</h3>\n<p>Map actions into an OCSF-aligned structure where possible, and include job identifiers that link back to the proof bundle. This lets SOC teams correlate agent activity with other telemetry without inventing a new event taxonomy.</p>\n\n<h3>Can we enforce egress allowlists and budgets?</h3>\n<p>Egress allowlists can be implemented outside clawproxy (optional) and driven by the destinations declared in the WPC. Token and cost budgets are planned features; in the meantime, implement them as enterprise buildout controls around CST TTLs, run limits, and upstream provider budgets.</p>\n\n<h3>What is the minimum evidence an auditor will ask for?</h3>\n<p>They usually want to know what ran, under which policy, who authorized exports, and what external calls were made. Gateway receipts and a proof bundle address the “what happened” question without relying on manual operator notes.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security (audit + footguns)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandbox-vs-tool-policy-vs-elevated.md\">OpenClaw: Sandbox vs Tool Policy vs Elevated</a></li>\n  <li><a href=\"https://aos.owasp.org/spec/trace/extend_ocsf\">OWASP AOS: Trace with OCSF (Agent Observability Standard)</a></li>\n  <li><a href=\"https://aws.amazon.com/blogs/security/the-agentic-ai-security-scoping-matrix-a-framework-for-securing-autonomous-ai-systems/\">AWS: Agentic AI Security Scoping Matrix</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Use OpenClaw as the baseline agent runtime, but treat evidence export as a controlled workflow: policy decides what the agent can read, what it can send out, and what proof it must emit. In Claw EA, you attach a WPC (Wor",
  "faqs": [
    {
      "q": "Why is prompt-only governance not enough for SIEM evidence collection?",
      "a": "Prompts do not provide a verifiable boundary around tools, destinations, or redaction. A WPC plus CST makes those constraints machine-checkable, so exports can be blocked when rules are not satisfied."
    },
    {
      "q": "What should we send to the SIEM versus keep in evidence storage?",
      "a": "Send structured, minimal events that support detection and audit, plus stable references like hashes and run IDs. Keep raw logs and bulky artifacts in controlled storage and export only what you can justify and retain safely."
    },
    {
      "q": "How do we normalize agent activity into a SIEM-friendly schema?",
      "a": "Map actions into an OCSF-aligned structure where possible, and include job identifiers that link back to the proof bundle. This lets SOC teams correlate agent activity with other telemetry without inventing a new event taxonomy."
    },
    {
      "q": "Can we enforce egress allowlists and budgets?",
      "a": "Egress allowlists can be implemented outside clawproxy (optional) and driven by the destinations declared in the WPC. Token and cost budgets are planned features; in the meantime, implement them as enterprise buildout controls around CST TTLs, run limits, and upstream provider budgets."
    },
    {
      "q": "What is the minimum evidence an auditor will ask for?",
      "a": "They usually want to know what ran, under which policy, who authorized exports, and what external calls were made. Gateway receipts and a proof bundle address the “what happened” question without relying on manual operator notes."
    }
  ],
  "sources": [
    {
      "title": "Trace with OCSF - Agent Observability Standard",
      "uri": "https://aos.owasp.org/spec/trace/extend_ocsf"
    },
    {
      "title": "The Agentic AI Security Scoping Matrix: A framework for ... - AWS",
      "uri": "https://aws.amazon.com/blogs/security/the-agentic-ai-security-scoping-matrix-a-framework-for-securing-autonomous-ai-systems/"
    },
    {
      "title": "A guide to building AI agents in GxP environments - AWS",
      "uri": "https://aws.amazon.com/blogs/machine-learning/a-guide-to-building-ai-agents-in-gxp-environments/"
    },
    {
      "title": "AWS Partners Demonstrate Enterprise AI Agent Solutions with ...",
      "uri": "https://aws.amazon.com/blogs/apn/aws-partners-demonstrate-enterprise-ai-agent-solutions-with-amazon-bedrock-agentcore/"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T11:49:56.606Z",
  "indexable": true
}