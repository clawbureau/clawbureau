{
  "slug": "channels/microsoft-teams",
  "title": "Microsoft Teams AI Agent Control Plane | Claw EA",
  "category": "channels",
  "html": "<h2>Direct Answer</h2>\n<p>Microsoft Teams can be a practical control plane for enterprise AI agents because it already has identity, chat-based approvals, and administrative controls that security teams understand. Claw EA runs the agent itself in OpenClaw as the baseline agent runtime, then enforces permissioned execution with policy-as-code instead of relying on prompt instructions.</p>\n<p>In this setup, Teams is the operator surface, while Claw Bureau primitives (WPC, CST, gateway receipts, proof bundles) provide machine-checkable authorization and audit artifacts for every run.</p>\n\n<h2>Step-by-step runbook</h2>\n<ol>\n  <li>\n    <p>Install and configure the OpenClaw Microsoft Teams plugin, then stand up a Teams bot (App ID, secret, tenant) and expose the bot webhook. Keep group and channel behavior locked down first (allowlist and mention gating where applicable), then expand access intentionally.</p>\n  </li>\n  <li>\n    <p>Decide how the agent will call Microsoft systems. Use Microsoft Graph via official API where needed, and scope permissions to the minimum set for the workflow, with admin consent controlled through your normal Entra ID process.</p>\n  </li>\n  <li>\n    <p>Create a WPC in clawcontrols that describes what the agent is allowed to do in Teams-triggered runs: which tools are callable, what data can be read or written, and which operations require human approval. Treat this as the source of truth, not the prompt.</p>\n  </li>\n  <li>\n    <p>Issue a CST from clawscope for the job or session, and pin it to the WPC hash when you want strict coupling between the run and the policy. Use job-scoped CST binding to reduce replay risk when an approval is involved.</p>\n  </li>\n  <li>\n    <p>Route model calls through clawproxy so every model request emits gateway receipts. If you use OpenRouter via fal, route it through clawproxy to keep receipts consistent across model providers.</p>\n  </li>\n  <li>\n    <p>Implement chat approvals as a first-class step in the run: the agent posts an approval request to Teams that includes the WPC hash and a summary of the intended action. When the approver responds, the agent continues with a fresh, job-scoped CST so “approve” messages cannot be replayed against a different action.</p>\n  </li>\n  <li>\n    <p>At completion, export the proof bundle for audit and optionally publish it to Trust Pulse for viewing. Keep the proof bundle tied to the Teams message context (conversation and message ids) so an auditor can trace what the agent claimed back to what happened.</p>\n  </li>\n</ol>\n\n<h2>Threat model</h2>\n<p>Teams makes it easy to operationalize approvals, but it also makes it easy to accidentally grant broad reach. The goal is to assume that prompts and chat messages can be malicious, and enforce safety in the execution layer with WPC and CST, then verify what happened with gateway receipts and proof bundles.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Threat</th>\n      <th>What happens</th>\n      <th>Control</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Prompt injection via Teams message or forwarded content</td>\n      <td>The agent is socially engineered to call tools or exfiltrate content, even if the system prompt says “do not”.</td>\n      <td>Use a WPC to restrict tool access and data movement; rely on sandbox and tool policy in OpenClaw, not instructions. Require approvals for high-risk operations and bind approvals to job-scoped CST.</td>\n    </tr>\n    <tr>\n      <td>Over-permissioned Microsoft Graph access</td>\n      <td>A single compromised run can read mail, files, or directory data well outside the intended workflow.</td>\n      <td>Minimize Graph permissions/scopes and separate identities for bots vs back-end services; use Entra ID controls like Conditional Access and PIM for administrative changes.</td>\n    </tr>\n    <tr>\n      <td>Token replay and “approve” message reuse</td>\n      <td>An attacker reuses an old approval or captured token to authorize a new action.</td>\n      <td>Use marketplace anti-replay binding (job-scoped CST binding) and keep CST TTLs short. Pin CST to the WPC hash so a token cannot be reused under a different policy.</td>\n    </tr>\n    <tr>\n      <td>Undetectable model behavior changes</td>\n      <td>Different model parameters or providers produce different outcomes, and you cannot explain which calls were made.</td>\n      <td>Route model calls through clawproxy to emit gateway receipts, then package them into a proof bundle for verification. Keep run metadata (job id, policy hash, scope hash) in the bundle.</td>\n    </tr>\n    <tr>\n      <td>Local execution blast radius</td>\n      <td>If tools run on a host with secrets or broad filesystem access, a bad tool call becomes a host incident.</td>\n      <td>Use OpenClaw sandboxing for tool execution where possible and keep elevated execution rare and explicit. Run OpenClaw security audit regularly to catch common footguns.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>Policy-as-code example</h2>\n<p>Prompt-only constraints fail because they are not enforceable at the moment a tool is invoked or a model call is made. A WPC makes the rules explicit and hash-addressed, so the agent run can prove which policy was in force and the platform can fail closed when the policy does not allow an action.</p>\n\n<p>Example WPC shape for a Teams-triggered run (JSON-like, illustrative):</p>\n<pre>{\n  \"wpc_version\": \"1\",\n  \"policy_name\": \"teams-ops-assistant\",\n  \"channel\": \"msteams\",\n  \"inputs\": {\n    \"allowed_tenants\": [\"&lt;YOUR_TENANT_ID&gt;\"],\n    \"allowed_conversations\": [\"allowlist:team:ops\", \"allowlist:chat:oncall\"]\n  },\n  \"tool_policy\": {\n    \"allow\": [\n      \"read\",\n      \"write\",\n      \"http.fetch:graph.microsoft.com\",\n      \"msteams.reply\",\n      \"msteams.adaptive_card\"\n    ],\n    \"deny\": [\n      \"exec\",\n      \"tools.elevated\",\n      \"http.fetch:*\"\n    ]\n  },\n  \"approvals\": [\n    {\n      \"action\": \"graph.write\",\n      \"require_human\": true,\n      \"approval_surface\": \"msteams\",\n      \"approval_binding\": [\"job_id\", \"wpc_hash\", \"cst_scope_hash\"]\n    }\n  ],\n  \"model_routing\": {\n    \"provider\": \"openrouter_via_fal\",\n    \"must_go_through\": \"clawproxy\",\n    \"receipts_required\": true\n  }\n}</pre>\n\n<p>In practice, the WPC is signed and served by clawcontrols, and the run uses a CST from clawscope that can be pinned to the WPC hash. If the agent attempts a tool call outside policy, execution should fail closed and report the denied action back into the Teams thread.</p>\n\n<h2>What proof do you get?</h2>\n<p>For each model call routed through clawproxy, you get gateway receipts that are signed and can be verified later. Receipts let you answer basic incident questions: which model endpoint was called, when it was called, and which run and policy it was associated with.</p>\n<p>At the end of a run, Claw EA packages receipts and related metadata into a proof bundle. The proof bundle is what you hand to audit or incident response, and it can be stored and viewed as a Trust Pulse artifact when you need a durable viewing surface.</p>\n<p>For approvals in Teams, include the WPC hash, the CST scope hash, and a job id in the approval card text so the approval is anchored to a specific run. That gives reviewers a way to confirm they approved the same action that later appears in the proof bundle.</p>\n\n<h2>Rollback posture</h2>\n<p>Rollback has to be operational and fast because chat channels are high-volume and attackers move quickly. The safest rollback posture is to cut authorization first (CST and WPC), then isolate execution (OpenClaw tool policy and sandbox), and only then expand again after review.</p>\n\n<table>\n  <thead>\n    <tr>\n      <th>Action</th>\n      <th>Safe rollback</th>\n      <th>Evidence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>Stop new high-risk actions immediately</td>\n      <td>Update the WPC to deny the sensitive tool paths, then require the new WPC hash for new CST issuance.</td>\n      <td>New runs show the updated WPC hash; denied actions appear as policy failures rather than silent behavior changes.</td>\n    </tr>\n    <tr>\n      <td>Contain a suspected token leak</td>\n      <td>Revoke the CST (and rotate issuer keys per your process), then re-issue short TTL CST with tighter scopes.</td>\n      <td>Token introspection and revocation events, plus job-scoped CST binding preventing reuse across jobs.</td>\n    </tr>\n    <tr>\n      <td>Contain a Teams bot credential exposure</td>\n      <td>Rotate the bot secret in Entra ID, restrict app access, and temporarily disable the Teams channel in the OpenClaw config.</td>\n      <td>Teams bot sign-in and config change records in Microsoft, plus a clear break in inbound message processing.</td>\n    </tr>\n    <tr>\n      <td>Contain tool execution risk</td>\n      <td>Force OpenClaw sandbox mode to “all” for the agent and remove elevated tool escape hatches until reviewed.</td>\n      <td>OpenClaw sandbox explain output and security audit results showing effective sandbox and tool policy state.</td>\n    </tr>\n  </tbody>\n</table>\n\n<h2>FAQ</h2>\n\n<h3>Why not just put safety rules in the system prompt?</h3>\n<p>Because prompt rules do not stop tool calls when the model is manipulated by a message, attachment, or multi-turn context. Policy-as-code in a WPC is evaluated at execution time, so the platform can deny a specific tool call even if the model tries to proceed.</p>\n\n<h3>How do Teams approvals map to actual authorization?</h3>\n<p>The Teams approval message is an operator signal, not a permission boundary by itself. The permission boundary is the CST plus WPC pinning, with job-scoped CST binding so an approval applies only to the intended job and policy.</p>\n\n<h3>What Microsoft controls should we use alongside this?</h3>\n<p>Use Entra ID to manage the bot and any service principals, keep Microsoft Graph permissions minimal, and gate admin changes with Conditional Access and PIM. Claw EA does not replace these controls; it uses them as the identity and change-management layer around the channel.</p>\n\n<h3>Can we prove what model calls happened for an incident review?</h3>\n<p>Yes, when model traffic is routed through clawproxy you get gateway receipts for those calls. Receipts and run metadata are collected into a proof bundle, which you can hand to audit or store as a Trust Pulse artifact for viewing.</p>\n\n<h3>Is Microsoft Teams a good place to run high-risk workflows?</h3>\n<p>Teams is a good operator surface, but it is still an untrusted input channel. Treat every message as hostile, keep tool access tight in the WPC, and require approvals plus job-scoped CST binding for workflows that write data or trigger external actions.</p>\n\n<h2>Sources</h2>\n<ul>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/channels/msteams.md\">OpenClaw Microsoft Teams (plugin)</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/security/index.md\">OpenClaw Gateway Security</a></li>\n  <li><a href=\"https://github.com/openclaw/openclaw/blob/5d4f42016f3afdbd5218843648d3ea594541dedc/docs/gateway/sandboxing.md\">OpenClaw Sandboxing</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security\">Secure AI agents at scale using Microsoft Agent 365</a></li>\n  <li><a href=\"https://learn.microsoft.com/en-us/microsoft-agent-365/overview\">Overview of Microsoft Agent 365</a></li>\n</ul>\n\n<div class=\"cta-banner\" data-cta=\"bofu-endcap\">\n  <h2>Ready to put this workflow into production?</h2>\n  <p>Get a scoped deployment plan with Work Policy Contracts, approval gates, and cryptographic proof bundles for your team.</p>\n  <a href=\"/contact\" class=\"cta-btn cta-btn-lg\" data-cta=\"bofu-talk-to-sales\">Talk to Sales</a>\n  <a href=\"/trust\" class=\"cta-btn cta-btn-outline cta-btn-lg\" style=\"margin-left:.75rem\" data-cta=\"bofu-trust-layer\">Review Trust Layer</a>\n</div>\n",
  "description": "Microsoft Teams can be a practical control plane for enterprise AI agents because it already has identity, chat-based approvals, and administrative controls that security teams understand. Claw EA runs the agent itself i",
  "faqs": [
    {
      "q": "Why not just put safety rules in the system prompt?",
      "a": "Because prompt rules do not stop tool calls when the model is manipulated by a message, attachment, or multi-turn context. Policy-as-code in a WPC is evaluated at execution time, so the platform can deny a specific tool call even if the model tries to proceed."
    },
    {
      "q": "How do Teams approvals map to actual authorization?",
      "a": "The Teams approval message is an operator signal, not a permission boundary by itself. The permission boundary is the CST plus WPC pinning, with job-scoped CST binding so an approval applies only to the intended job and policy."
    },
    {
      "q": "What Microsoft controls should we use alongside this?",
      "a": "Use Entra ID to manage the bot and any service principals, keep Microsoft Graph permissions minimal, and gate admin changes with Conditional Access and PIM. Claw EA does not replace these controls; it uses them as the identity and change-management layer around the channel."
    },
    {
      "q": "Can we prove what model calls happened for an incident review?",
      "a": "Yes, when model traffic is routed through clawproxy you get gateway receipts for those calls. Receipts and run metadata are collected into a proof bundle, which you can hand to audit or store as a Trust Pulse artifact for viewing."
    },
    {
      "q": "Is Microsoft Teams a good place to run high-risk workflows?",
      "a": "Teams is a good operator surface, but it is still an untrusted input channel. Treat every message as hostile, keep tool access tight in the WPC, and require approvals plus job-scoped CST binding for workflows that write data or trigger external actions."
    }
  ],
  "sources": [
    {
      "title": "Secure AI agents at scale using Microsoft Agent 365",
      "uri": "https://learn.microsoft.com/en-us/security/security-for-ai/agent-365-security"
    },
    {
      "title": "What Is Microsoft Foundry Control Plane?",
      "uri": "https://learn.microsoft.com/en-us/azure/ai-foundry/control-plane/overview?view=foundry"
    },
    {
      "title": "What's new in Microsoft AI security?",
      "uri": "https://learn.microsoft.com/en-us/security/security-for-ai/whats-new"
    },
    {
      "title": "Manage Microsoft Agent 365 agents in the Microsoft 365 admin center",
      "uri": "https://learn.microsoft.com/en-us/microsoft-agent-365/admin/manage-agents"
    },
    {
      "title": "Microsoft Agent 365 documentation",
      "uri": "https://learn.microsoft.com/en-us/microsoft-agent-365/"
    },
    {
      "title": "Overview of Microsoft Agent 365",
      "uri": "https://learn.microsoft.com/en-us/microsoft-agent-365/overview"
    }
  ],
  "model": "candidate-01",
  "generatedAt": "2026-02-11T12:01:34.916Z",
  "indexable": true
}