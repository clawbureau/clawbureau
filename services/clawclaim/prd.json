{
  "project": "clawbureau",
  "branchName": "ralph/clawclaim-phase2",
  "description": "clawclaim.com (DID Binding) \u2014 PRD \u2014 Bind DIDs to accounts and external platforms (GitHub, X, Moltbook) via challenge-response.",
  "userStories": [
    {
      "id": "CCL-US-001",
      "title": "Challenge issuance",
      "description": "As a user, I want a binding challenge so that I can prove key control.",
      "acceptanceCriteria": [
        "Issue short-lived nonce",
        "Store challenge",
        "Expire after 10 minutes",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Implemented POST /v1/challenges backed by KV with TTL (default 600s). Returns deterministic signing message + nonce and stores challenge with expiration."
    },
    {
      "id": "CCL-US-002",
      "title": "Bind DID",
      "description": "As a user, I want to bind my DID so that my identity is portable.",
      "acceptanceCriteria": [
        "Verify signature",
        "Store DID binding",
        "Mark DID as active",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Implemented POST /v1/bind verifying Ed25519 signature (did:key) over stored challenge message; stores binding in KV and marks it active."
    },
    {
      "id": "CCL-US-003",
      "title": "Revoke binding",
      "description": "As a user, I want to revoke a DID so that compromised keys are disabled.",
      "acceptanceCriteria": [
        "Mark binding revoked",
        "Prevent new sessions",
        "Log audit event",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Added POST /v1/bindings/revoke (did:key Ed25519) which marks binding inactive + records revoked_at; blocks new bind challenges for revoked DIDs and logs an audit event in KV (events:bindings:*)."
    },
    {
      "id": "CCL-US-004",
      "title": "Platform claims",
      "description": "As a user, I want to bind external accounts so that trust aggregates cross-platform.",
      "acceptanceCriteria": [
        "Support GitHub/X/Moltbook",
        "Store proof URL",
        "Verify via clawverify",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-005",
      "title": "Primary DID selection",
      "description": "As a user, I want to pick a primary DID so that my profile is consistent.",
      "acceptanceCriteria": [
        "Set is_primary flag",
        "Only one primary per account",
        "Expose in profile API",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-006",
      "title": "Binding audit trail",
      "description": "As an auditor, I want to inspect binding history so that identity claims are traceable.",
      "acceptanceCriteria": [
        "Append-only binding log",
        "Include timestamps",
        "Export for compliance",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-007",
      "title": "Owner attestation registry",
      "description": "As a platform, I want owner attestations so that sybil resistance is possible.",
      "acceptanceCriteria": [
        "Store owner attestation envelope (provider-agnostic)",
        "Record expiry and verification level",
        "Support OneMolt/WorldID lookup references",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-008",
      "title": "Scoped token issuance (CST)",
      "description": "As a developer, I want scoped tokens so that agents can authenticate safely.",
      "acceptanceCriteria": [
        "Exchange DID challenge for token issuance via clawscope",
        "Issue short-lived tokens bound to DID + scope + audience",
        "Include optional owner attestation reference",
        "Log token hash + policy version to clawlogs",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-009",
      "title": "Org/team roster claims",
      "description": "As a team, I want roster claims so that roles can be verified.",
      "acceptanceCriteria": [
        "Register org/team DID + roster members",
        "Issue signed roster manifest",
        "Expose roster verification endpoint",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": false,
      "notes": ""
    },
    {
      "id": "CCL-US-011",
      "title": "Controller-first provisioning hard cutover",
      "description": "As identity operations, we want controller-first registration with owner-bound sensitive policy so downstream token control can fail closed.",
      "acceptanceCriteria": [
        "Register controllers under an owner DID with signed challenge flow",
        "Register agents under a controller with deterministic chain records",
        "Enforce owner-bound sensitive authorization policy artifacts",
        "Expose deterministic controller/agent chain read endpoints",
        "Typecheck and tests pass"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Implemented control-plane provisioning in `services/clawclaim/src/index.ts`: challenge purposes (`register_controller`, `register_agent`, `update_sensitive_policy`), owner-signed controller registration, controller-scoped agent registration, owner-bound sensitive policy updates, and deterministic read/list chain endpoints (`/v1/control-plane/controllers/*`). Added coverage in `services/clawclaim/test/control-plane.test.ts` and passed `npm run typecheck && npm test`. Deploys: staging `7c1cf0b7-af77-4d21-b29d-b902055519a5`, prod `4af46ea4-05b7-43de-ae1f-6f100b4fde56`; smoke artifacts: `artifacts/smoke/identity-control-plane/2026-02-11T21-47-01-985Z-staging/result.json`, `artifacts/smoke/identity-control-plane/2026-02-11T21-47-11-161Z-prod/result.json`."
    }
  ]
}
