{
  "project": "clawbureau",
  "branchName": "ralph/clawescrow-phase1-trust",
  "description": "clawescrow.com (Escrow) \u2014 PRD \u2014 Escrow holds/releases/milestones for agent work.",
  "userStories": [
    {
      "id": "CES-US-001",
      "title": "Create escrow hold",
      "description": "As a requester, I want to lock funds so that work is safe.",
      "acceptanceCriteria": [
        "Hold reduces balance",
        "Return escrow id",
        "Support metadata/terms",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Implemented in services/escrow with EscrowService.createEscrow()"
    },
    {
      "id": "CES-US-002",
      "title": "Release escrow",
      "description": "As a requester, I want to pay after approval so that work is settled.",
      "acceptanceCriteria": [
        "Transfer to agent",
        "Record ledger event",
        "Emit webhook",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Implemented releaseEscrow() with LedgerClientV2.releaseHoldAndTransfer() and WebhookEmitter"
    },
    {
      "id": "CES-US-003",
      "title": "Dispute window",
      "description": "As a agent, I want a dispute period so that fraud is handled.",
      "acceptanceCriteria": [
        "Configurable dispute window",
        "Freeze escrow on dispute",
        "Escalate to trials",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Implemented disputeEscrow() and escalateDispute() methods. Configurable dispute_window_hours on escrow, freezes escrow on dispute, integrates with TrialsClient for escalation."
    },
    {
      "id": "CES-US-004",
      "title": "Milestone payouts",
      "description": "As a requester, I want milestones so that long jobs can be staged.",
      "acceptanceCriteria": [
        "Define milestones",
        "Partial releases",
        "Track remaining",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Implemented releaseMilestone() and getMilestoneStatus() methods. LedgerClientV3 interface for partial releases. Tracks remaining amount and milestones, auto-releases escrow when all milestones complete."
    },
    {
      "id": "CES-US-005",
      "title": "Escrow cancellation",
      "description": "As a requester, I want to cancel so that funds return if no work.",
      "acceptanceCriteria": [
        "Cancel if no submission",
        "Release hold",
        "Audit log entry",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Implemented cancelEscrow() method with LedgerClientV4.releaseHold() for hold release and AuditLogger for audit entries. Only allows cancellation if escrow is in 'held' status with no released milestones."
    },
    {
      "id": "CES-US-006",
      "title": "Escrow status API",
      "description": "As a platform, I want status endpoints so that UI can show progress.",
      "acceptanceCriteria": [
        "GET /escrow/{id}",
        "Status states",
        "Include timestamps",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": false,
      "notes": ""
    }
  ]
}
