## Codebase Patterns
- Trust vNext work is expected to span multiple services: clawverify, clawproxy, clawea, clwbounties/marketplace, and OpenClaw integration points.
- “Replay” should mean **evidence re-validation** + deterministic checks, not bit-identical LLM output reproduction.
- High trust tiers must be **fail-closed** and should not rely on trusting a worker’s local machine.

# Ralph Progress Log
Started: 2026-02-07T19:53:07Z
---

## 2026-02-07T19:53:07Z - Roadmap seeded (planning)
- What was implemented
  - Added a new roadmap folder: `docs/roadmaps/trust-vnext/`.
  - Seeded `prd.json` from the synthesis oracle:
    - `docs/roadmaps/proof-of-harness/oracle/2026-02-07/next-building-blocks-plan.gpt-5.2-pro.md`
  - Created this `progress.txt` for append-only progress tracking (Ralph compatible).
- Files changed
  - docs/roadmaps/trust-vnext/README.md
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
---

## 2026-02-07T23:19:57Z - CVF-US-021
- What was implemented
  - Hardened proof bundle verification by recomputing `event_hash_b64u` for every event using the canonical event header key order (ADAPTER_SPEC_v1 §4.2).
  - Fail-closed: proof bundles are rejected when any `event_hash_b64u` mismatches the recomputed value.
  - Added unit tests to ensure tampering is detected even if the chain links are internally consistent.
- Files changed
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/test/proof-bundle-event-hash.test.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
---

## 2026-02-07T23:22:57Z - CVF-US-022
- What was implemented
  - Enforced proof bundle authorship binding:
    - `envelope.signer_did` MUST equal `payload.agent_did`
  - Added unit test coverage to ensure a signature-valid bundle cannot claim a different `agent_did`.
- Files changed
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/test/proof-bundle-event-hash.test.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
---

## 2026-02-08T00:07:01Z - CVF-US-023
- What was implemented
  - Prevented fake/shape-only attestations from uplifting trust tiers.
  - Proof bundle attestations now only count when:
    - the attester DID is allowlisted (`ATTESTATION_SIGNER_DIDS`)
    - the signature verifies (Ed25519 over RFC8785 JCS canonical bytes with signature field blanked)
    - the attestation is bound to the bundle subject (`subject_did === payload.agent_did`)
- Files changed
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/src/index.ts
  - services/clawverify/src/verify-agent.ts
  - services/clawverify/src/types.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
---

## 2026-02-08T00:48:02Z - CVF-US-024
- What was implemented
  - Added Workers-safe Ajv (draft 2020-12) schema validation gates (standalone validators; no runtime codegen) for:
    - proof bundle envelopes
    - gateway receipt envelopes
  - Fail-closed behavior:
    - schema mismatches (including additionalProperties:false) return `SCHEMA_VALIDATION_FAILED`
    - response includes a deterministic `field` path derived from Ajv errors
  - Added/updated PoH schemas to support strict validation:
    - `packages/schema/poh/proof_bundle_envelope.v1.json`
    - `packages/schema/poh/gateway_receipt.v1.json`
    - `packages/schema/poh/gateway_receipt_envelope.v1.json`
    - tightened `proof_bundle.v1` receipt binding via `$ref` to `receipt_binding.v1.json`
  - Added unit tests to ensure unknown fields are rejected.
- Files changed
  - services/clawverify/src/schema-validation.ts
  - services/clawverify/src/schema-validators.generated.ts
  - services/clawverify/scripts/generate-schema-validators.mjs
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/src/verify-receipt.ts
  - services/clawverify/src/types.ts
  - services/clawverify/test/ajv-schema-validation.test.ts
  - packages/schema/poh/proof_bundle.v1.json
  - packages/schema/poh/gateway_receipt.v1.json
  - packages/schema/poh/gateway_receipt_envelope.v1.json
  - packages/schema/poh/proof_bundle_envelope.v1.json
  - packages/schema/README.md
  - packages/schema/prd.json
  - packages/schema/progress.txt
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
  - services/clawverify/package.json
  - services/clawverify/package-lock.json
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
---

## 2026-02-08T04:29:24Z - CVF-US-025
- What was implemented
  - Receipt numeric hardening in clawverify:
    - Reject non-finite numbers (NaN/Infinity) and non-integer counts for tokens/latency
    - Added reasonable upper bounds for tokens and latency
  - Proof bundle hardening:
    - Enforced max counts for event_chain/receipts/attestations
    - Enforced byte-size limits for metadata blobs (bundle metadata, URM metadata, receipt metadata)
    - Enforced uniqueness of event_id and receipt_id within a bundle (fail-closed)
  - Added unit tests for edge cases.
- Files changed
  - services/clawverify/src/verify-receipt.ts
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/test/receipt-numeric-hardening.test.ts
  - services/clawverify/test/proof-bundle-hardening.test.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
---

## 2026-02-08T23:25:48Z - POH-US-013
- What was implemented
  - Defined canonical proof tiers across verifier + marketplace docs.
  - `clawverify` now outputs `proof_tier` (canonical, marketplace-facing) on:
    - `POST /v1/verify/bundle`
    - `POST /v1/verify/agent`
  - `poh_tier` numeric mapping is now aligned to `proof_tier`:
    - `unknown=0, self=1, gateway=2, sandbox=3, tee=4, witnessed_web=5`
  - Updated `docs/specs/agent-economy/MVP.md` to reference the same tier definitions.
  - Added tests for gateway-tier bundles (valid receipt + binding) and for event-chain-only bundles.
- Files changed
  - services/clawverify/src/types.ts
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/src/verify-agent.ts
  - services/clawverify/src/index.ts
  - services/clawverify/test/proof-tier-gateway.test.ts
  - services/clawverify/test/proof-bundle-event-hash.test.ts
  - services/clawverify/test/proof-bundle-attestations.test.ts
  - docs/specs/agent-economy/MVP.md
  - docs/prds/clawverify.md
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
## 2026-02-08T23:44:30Z - CPX-US-031
- What was implemented
  - Replaced clawproxy in-memory nonce cache with a **durable idempotency store** using Durable Objects (one DO per nonce).
  - Enforced nonce fingerprinting:
    - same nonce + same fingerprint => replay stored response/receipt
    - same nonce + different fingerprint => fail closed
    - same nonce while in-flight => 409 (retry later)
  - Added a `wrangler.toml` DO binding + migration and wired `Env.IDEMPOTENCY`.
  - Added unit tests covering lock/commit/replay/mismatch and simulated restart persistence.
- Files changed
  - services/clawproxy/src/idempotency.ts
  - services/clawproxy/src/index.ts
  - services/clawproxy/src/types.ts
  - services/clawproxy/wrangler.toml
  - services/clawproxy/test/idempotency-do.test.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawproxy && npm test && npm run typecheck
---

## 2026-02-09T01:29:33Z - POH-US-014
- What was implemented
  - Added a D1 replay database for marketplace submissions:
    - `replay_runs`: unique (agent_did, run_id)
    - `replay_receipts`: unique (receipt_signer_did, receipt_id)
  - Submission flow now rejects replayed evidence:
    - Fail-closed binding: `proof_bundle_envelope.payload.agent_did` must match authenticated `worker_did`.
    - For proof-bundle-VALID submissions, reserve replay keys and reject duplicates with deterministic error codes:
      - `REPLAY_RUN_ID_REUSED`
      - `REPLAY_RECEIPT_ID_REUSED`
- Files changed
  - services/clawbounties/migrations/0008_marketplace_replay_db.sql
  - services/clawbounties/src/index.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawbounties && npm run typecheck
---

## 2026-02-09T03:43:25Z - POH-US-015
- What was implemented
  - Added **URM materialization** support (fail-closed) in `clawverify` bundle verification:
    - `POST /v1/verify/bundle` now accepts an optional `urm` document alongside the `envelope`.
    - If the proof bundle includes `payload.urm` (a URM reference), the request MUST provide the materialized URM document (`urm`) or verification returns INVALID (`URM_MISSING`).
    - Verifier validates URM with Workers-safe Ajv standalone validators (`urm.v1`), recomputes the URM hash (SHA-256 base64url), and compares it to `payload.urm.resource_hash_b64u`.
    - Enforces binding: `urm.urm_id`, `urm.agent_did`, and `urm.run_id` (when event_chain is valid) must match the bundle.
  - Updated marketplace (`clawbounties`) submission flow to forward and require URM materialization when the bundle includes a URM reference.
  - Hardened marketplace verifier client behavior to treat 422 verification responses as normal (invalid proofs), not dependency errors.
- Files changed
  - services/clawverify/scripts/generate-schema-validators.mjs
  - services/clawverify/src/schema-validators.generated.ts
  - services/clawverify/src/schema-validation.ts
  - services/clawverify/src/types.ts
  - services/clawverify/src/index.ts
  - services/clawverify/src/verify-proof-bundle.ts
  - services/clawverify/src/verify-agent.ts
  - services/clawverify/test/urm-materialization.test.ts
  - services/clawbounties/src/index.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawverify && npm test && npm run typecheck && npm run lint
  - cd services/clawbounties && npm run typecheck
---

## 2026-02-09T14:10:00Z - POH-US-019
- What was implemented
  - Added streaming/SSE support in `clawproxy` for requests with `stream:true`:
    - Upstream provider responses are forwarded as streams (no full buffering).
    - Response hashes are computed incrementally and used to issue signed gateway receipts.
    - Receipts are committed to the durable idempotency store (receipt-only marker for streaming) and also appended as SSE comment trailers for shim extraction.
  - Updated `@clawbureau/clawproof-adapters` shim to support streaming:
    - Detects streaming requests and forwards SSE from clawproxy without buffering.
    - Injects PoH binding headers (X-Run-Id/X-Event-Hash/X-Idempotency-Key) for streaming flows.
    - Captures canonical `_receipt_envelope` from clawproxy SSE trailer comments, strips them before returning to the harness, and falls back to deterministic nonce receipt lookup (`GET /v1/receipt/:nonce`) when needed.
- Files changed
  - services/clawproxy/src/index.ts
  - services/clawproxy/src/receipt.ts
  - services/clawproxy/package.json
  - services/clawproxy/package-lock.json
  - packages/clawproof-adapters/src/types.ts
  - packages/clawproof-adapters/src/session.ts
  - packages/clawproof-adapters/src/shim.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawproxy && npm test && npm run typecheck
  - cd packages/clawproof-adapters && npm run typecheck
---

## 2026-02-09T16:25:00Z - POH-US-020
- What was implemented
  - Added pre-hash redaction middleware (ported from agentlog/redact.py) to prevent secrets/PII from entering immutable PoH hashes:
    - `packages/clawproof-adapters` now redacts event payloads before computing `payload_hash_b64u` / `event_hash_b64u`.
    - OpenClaw harness recorder (`@openclaw/provider-clawproxy`) now redacts event payloads before hashing.
  - URM `metadata` is redacted and bounded to 16KB to avoid fail-closed verifier rejection.
- Files changed
  - packages/clawproof-adapters/src/redact.ts
  - packages/clawproof-adapters/src/session.ts
  - packages/clawproof-adapters/test/redact-and-trust-pulse.test.ts
  - packages/openclaw-provider-clawproxy/src/redact.ts
  - packages/openclaw-provider-clawproxy/src/recorder.ts
  - packages/openclaw-provider-clawproxy/src/types.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd packages/clawproof-adapters && npm run typecheck && npm test
  - cd packages/openclaw-provider-clawproxy && npm run typecheck
---

## 2026-02-09T16:26:00Z - OCL-US-004
- What was implemented
  - Implemented a small **Trust Pulse** artifact (self-reported, non-tier) that summarizes:
    - tool names used + counts
    - relative file paths touched + touch counts
  - Trust Pulse is:
    - redacted
    - bounded
    - explicitly marked `tier_uplift=false`
  - Producers attach a pointer to the Trust Pulse hash in `URM.metadata.trust_pulse`.
  - Added a versioned schema for the Trust Pulse document.
- Files changed
  - packages/schema/poh/trust_pulse.v1.json
  - packages/schema/README.md
  - packages/clawproof-adapters/src/session.ts
  - packages/clawproof-adapters/src/types.ts
  - packages/clawproof-adapters/src/cli.ts
  - packages/clawproof-adapters/test/redact-and-trust-pulse.test.ts
  - packages/openclaw-provider-clawproxy/src/types.ts
  - packages/openclaw-provider-clawproxy/src/recorder.ts
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd packages/clawproof-adapters && npm run typecheck && npm test
  - cd packages/openclaw-provider-clawproxy && npm run typecheck
---

## 2026-02-09T16:40:00Z - AGL-US-001
- What was implemented
  - Added a local PoH verification UX to `agentlog`:
    - New `agentlog verify <path>` subcommand discovers a proof bundle envelope + materialized URM JSON (e.g. `.clawproof/*-bundle.json` + `*-urm.json`).
    - Calls `POST /v1/verify/bundle` on `clawverify` with `{ envelope, urm }` and prints a derived-only VERIFIED/UNVERIFIED badge.
    - Fail-closed: missing URM or verifier invalidation returns UNVERIFIED and exit code 2.
- Files changed
  - (external repo) /Users/gfw/code/agentlog/cli.py
  - (external repo) /Users/gfw/code/agentlog/README.md
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd /Users/gfw/code/agentlog && python3 -m unittest discover -s tests -q
---

## 2026-02-09T18:54:00Z - Trust Pulse marketplace: storage + auto-load viewer
- What was implemented
  - Added server-side storage for Trust Pulse (self-reported, non-tier) at bounty submission time:
    - `POST /v1/bounties/{bounty_id}/submit` accepts optional `trust_pulse`.
    - Enforces `tier_uplift=false`, binds to proof bundle context (`run_id` + `agent_did`), and validates against authenticated `worker_did`.
    - If URM contains `metadata.trust_pulse.artifact_hash_b64u`, enforces hash match (fail-closed).
  - Added auth-gated retrieval endpoint:
    - `GET /v1/submissions/{submission_id}/trust-pulse` (admin key OR owning worker token).
  - Updated public `/trust-pulse` viewer to fetch by `submission_id` (token via `Authorization` header; no URL tokens).
- Files changed
  - services/clawbounties/src/index.ts
  - services/clawbounties/migrations/0009_submission_trust_pulse.sql
  - services/clawbounties/progress.txt
  - docs/roadmaps/proof-of-harness/oracle/2026-02-09/* (Trust Pulse marketplace prompts/outputs)
  - docs/roadmaps/trust-vnext/progress.txt
- Quality checks
  - cd services/clawbounties && npm run typecheck
---

## 2026-02-09T17:16:38Z - POH-US-016/017 Prompt commitments (prompt_pack + system_prompt_report)
- What was implemented
  - Added prompt commitment evidence (hash-only, non-tier) to reduce prompt injection ambiguity:
    - `prompt_pack` (commitment over prompt-pack input hashes) with `prompt_root_hash_b64u`.
    - `system_prompt_report` (per-llm_call `rendered_system_prompt_hash_b64u`), bound to the proof bundle event chain.
  - OpenClaw recorder (`@openclaw/provider-clawproxy`) now:
    - Computes `rendered_system_prompt_hash_b64u` for llm_call events from the exact system prompt string.
    - Strips prompt plaintext from the hashed event payload (stores only the hash).
    - Optionally computes + embeds a `prompt_pack` from `promptPackEntries` at finalize time.
    - Embeds both objects into proof bundle `payload.metadata`.
  - clawverify now validates these objects when present (fail-closed):
    - Schema validation via Workers-safe Ajv standalone validators.
    - Recomputes + enforces `prompt_root_hash_b64u` against canonical entry list.
    - Enforces system_prompt_report bindings to (run_id + agent_did) and llm_call event references.
- Files changed
  - packages/schema/poh/prompt_pack.v1.json
  - packages/schema/poh/system_prompt_report.v1.json
  - packages/schema/README.md
  - packages/openclaw-provider-clawproxy/src/{types.ts,index.ts,recorder.ts}
  - services/clawverify/src/{verify-proof-bundle.ts,schema-validation.ts,schema-registry.ts,schema-validators.generated.ts,types.ts}
  - services/clawverify/scripts/generate-schema-validators.mjs
  - services/clawverify/test/prompt-commitments.test.ts
  - docs/roadmaps/trust-vnext/{prd.json,progress.txt}
- Quality checks
  - cd packages/openclaw-provider-clawproxy && npm run typecheck
  - cd services/clawverify && npm run typecheck && npm test
---

## 2026-02-10T00:38:35Z - CCO-US-021
- What was implemented
  - Implemented `clawcontrols` Work Policy Contract (WPC) registry API (signed policies):
    - `POST /v1/wpc` (admin-gated) creates a WPC addressed by `policy_hash_b64u = sha256(JCS(payload))` and returns a signed envelope.
    - `GET /v1/wpc/:policy_hash_b64u` fetches the previously created WPC envelope.
  - Added versioned schemas for WPC payloads + envelopes under `packages/schema/policy/`.
  - Updated clawcontrols PRD implementation status and moved the `clawcontrols.com/*` route off `claw-domains` to the new worker.
- Files changed
  - services/clawcontrols/*
  - packages/schema/policy/*
  - packages/schema/{README.md,progress.txt}
  - docs/prds/clawcontrols.md
  - services/claw-domains/wrangler.toml
  - docs/roadmaps/trust-vnext/{prd.json,progress.txt}
- Quality checks
  - cd services/clawcontrols && npm run typecheck && npm test
---

## 2026-02-10T03:00:00Z - CWC-US-001
- What was implemented
  - Added versioned schemas for Confidential Work Contracts (CWC):
    - `packages/schema/policy/confidential_work_contract.v1.json`
    - `packages/schema/policy/confidential_work_contract_envelope.v1.json`
  - Marketplace (clawbounties) now supports storing and enforcing a pinned CWC hash:
    - `POST /v1/bounties` accepts optional `cwc_buyer_envelope` for **direct-hire** bounties.
      - Verifies buyer signature and binds buyer/worker DIDs to the bounty.
      - Stores `cwc_hash_b64u` + `wpc_policy_hash_b64u` + required tier on the bounty.
    - `POST /v1/bounties/{id}/accept` requires `cwc_worker_envelope` countersign when a CWC is pinned.
      - Stores the worker countersign on the bounty.
    - `POST /v1/bounties/{id}/submit` enforces policy binding for otherwise-valid proofs:
      - Requires at least one **verified + run-bound** gateway receipt.
      - Requires `receipt.payload.binding.policy_hash` to match the pinned `wpc_policy_hash_b64u` on all verified+bound receipts.
  - OpenClaw provider-clawproxy plugin config expanded to support WPC headers:
    - `policyHashB64u`, `confidentialMode`, `receiptPrivacyMode`.
    - Sends `X-Policy-Hash` / `X-Confidential-Mode` / `X-Receipt-Privacy-Mode` to clawproxy.
- Files changed
  - packages/schema/policy/confidential_work_contract.v1.json
  - packages/schema/policy/confidential_work_contract_envelope.v1.json
  - packages/schema/bounties/post_bounty_request.v2.json
  - packages/schema/README.md
  - services/clawbounties/migrations/0010_confidential_work_contract.sql
  - services/clawbounties/src/index.ts
  - packages/openclaw-provider-clawproxy/openclaw.plugin.json
  - packages/openclaw-provider-clawproxy/src/{openclaw.ts,provider.ts,types.ts}
  - docs/roadmaps/trust-vnext/{prd.json,progress.txt}
- Quality checks
  - cd services/clawbounties && npm run typecheck
  - cd packages/openclaw-provider-clawproxy && npm run typecheck && npm test
---

## 2026-02-10T13:45:00Z - POH-US-021 (CWC job CST binding)
- What was implemented
  - Extended CWC enforcement with job-scoped CST bindings:
    - New D1 column `cwc_token_scope_hash_b64u` stores the expected deterministic scope hash.
    - `POST /v1/bounties/{id}/accept` computes/stores the expected hash and (best-effort) issues a clawscope CST, returned as `cwc_auth`.
    - New worker endpoint: `POST /v1/bounties/{id}/cst` issues/returns the CST for the accepted worker.
    - `POST /v1/bounties/{id}/submit` enforces `receipt.payload.binding.token_scope_hash_b64u` matches the expected value on verified+run-bound receipts.
- Files changed
  - services/clawbounties/migrations/0011_cwc_job_cst.sql
  - services/clawbounties/src/index.ts
  - docs/roadmaps/proof-of-harness/oracle/2026-02-10/*
- Quality checks
  - cd services/clawbounties && npm run typecheck
---

## 2026-02-10T17:30:00Z - POH-US-022 (job CST binding for non-CWC)
- What was implemented
  - Generalized receipt non-transferability beyond CWC bounties:
    - New bounty field `job_token_scope_hash_b64u` stores deterministic expected v1 scope hash.
    - On acceptance, marketplace computes/persists job scope hash for `min_proof_tier != self` bounties.
    - `/v1/bounties/{id}/cst` now supports non-CWC bounties and returns `job_auth`.
    - Submission verification enforces `binding.token_scope_hash_b64u` on verified+bound gateway receipts matches the expected job hash when configured.
  - Updated worker harness tooling to accept either `cwc_auth` or `job_auth` CST response shapes.
- Files changed
  - services/clawbounties/migrations/0012_job_cst_binding.sql
  - services/clawbounties/src/index.ts
  - packages/clawproof-adapters/src/cli.ts
  - packages/openclaw-provider-clawproxy/src/index.ts
  - scripts/poh/smoke-cwc-job-cst-binding.mjs
- Quality checks
  - cd services/clawbounties && npm run typecheck
  - cd packages/clawproof-adapters && npm run typecheck && npm test
  - cd packages/openclaw-provider-clawproxy && npm run typecheck
---

## 2026-02-10T19:15:00Z - CPX-US-036 (OpenRouter-through-fal via clawproxy)
- What was implemented
  - Added fal OpenRouter router support to clawproxy for OpenAI-compatible endpoints:
    - Routing selector: when request body `model` starts with `openrouter/`, clawproxy routes the request to:
      - base: `https://fal.run/openrouter/router/openai/v1`
      - endpoints: `/chat/completions` and `/responses` (OpenAI-compatible)
    - Upstream auth is enforced as `Authorization: Key <FAL_KEY>` (not Bearer).
    - clawproxy strips the leading `openrouter/` prefix from the upstream request body `model` value, but keeps the original model string in the receipt for auditability.
    - Fail-closed: platform-paid mode is not allowed for `openrouter/*` models.
    - Receipts include `metadata.upstream = "fal_openrouter"` and `metadata.upstream_model` for auditability.
  - Improved harness tooling test coverage:
    - Added unit tests for marketplace `/cst` response parsing (supports `cwc_auth` and `job_auth`).
    - OpenClaw clawproxy provider now routes `openrouter/*` models via `/v1/proxy/openai`.
- Files changed
  - services/clawproxy/src/providers.ts
  - services/clawproxy/src/index.ts
  - services/clawproxy/test/providers.test.ts
  - packages/openclaw-provider-clawproxy/src/{provider.ts,index.ts,marketplace-cst.ts}
  - packages/openclaw-provider-clawproxy/test/{marketplace-cst.test.mjs,openrouter-routing.test.mjs}
  - packages/openclaw-provider-clawproxy/package.json
  - packages/clawproof-adapters/src/{cli.ts,marketplace-cst.ts}
  - packages/clawproof-adapters/test/marketplace-cst.test.ts
- Quality checks
  - cd services/clawproxy && npm run typecheck && npm test
  - cd packages/openclaw-provider-clawproxy && npm run typecheck && npm test
  - cd packages/clawproof-adapters && npm run typecheck && npm test
---

## 2026-02-11T01:00:00Z - CEA-US-010 (sandbox execution attestation MVP)
- What was implemented
  - Marked CEA-US-010 as passing in the trust-vnext execution tracker.
  - Notes link: clawea private PR #3, clawbureau PR #104, submodule bump PR #105, and smoke script `scripts/poh/smoke-execution-attestation.mjs`.
- Files changed
  - docs/roadmaps/trust-vnext/prd.json
  - docs/roadmaps/trust-vnext/progress.txt
---
## 2026-02-11T20:00:00Z - POH-US-018
- What was implemented
  - Added witnessed-web receipt support in schema + verifier:
    - `packages/schema/poh/web_receipt.v1.json`
    - `packages/schema/poh/web_receipt_envelope.v1.json`
    - `services/clawverify/src/verify-web-receipt.ts`
    - `POST /v1/verify/web-receipt`
  - Added fail-closed witness signer allowlist gate:
    - env var `WEB_RECEIPT_SIGNER_DIDS`
    - returns `DEPENDENCY_NOT_CONFIGURED` when unset
  - Preserved trust semantics:
    - web receipts verify to `proof_tier=witnessed_web`
    - not auto-equivalent to gateway receipts (`equivalent_to_gateway=false`)
- Tests & fixtures
  - Added fixture: `packages/schema/fixtures/web_receipt_golden.v1.json`
  - Added unit tests: `services/clawverify/test/web-receipt.test.ts`
- Deploy & smoke
  - Deployed `clawverify` to staging and production
  - Smokes passed:
    - `node scripts/poh/smoke-web-receipt.mjs --env staging`
    - `node scripts/poh/smoke-web-receipt.mjs --env prod`
  - Regression smokes passed:
    - `node scripts/poh/smoke-fal-openrouter-via-clawproxy.mjs --env staging`
    - `node scripts/poh/smoke-fal-openrouter-via-clawproxy.mjs --env prod`
- Quality checks
  - `cd services/clawverify && npm test && npm run typecheck && npm run lint`
---
## 2026-02-11T21:15:00Z - OCL-US-001
- What was implemented
  - Added OpenClaw Airlock controls in `@openclaw/provider-clawproxy`:
    - new plugin config block `airlock` with `enabled`, `identityRoots`, `jobRoots`, `requireTrustedBootstrap`
    - bootstrap files are partitioned into trusted/untrusted/unknown by root
    - prompt-pack capture only includes trusted IdentityRoot files
    - fail-closed guard: when `requireTrustedBootstrap=true`, non-trusted bootstrap discovery triggers `AIRLOCK_BOOTSTRAP_VIOLATION` at agent start
  - Added integration documentation for IdentityRoot vs JobRoot partition pattern:
    - `docs/integration/OPENCLAW_INTEGRATION.md`
- Tests
  - Added regression tests:
    - `packages/openclaw-provider-clawproxy/test/airlock-bootstrap.test.mjs`
  - Local package tests passed:
    - `node --test test/*.test.mjs`
- Notes
  - This enforces sensitive-profile bootstrap partitioning without requiring OpenClaw core changes by using plugin-level fail-closed checks.
---
## 2026-02-11T21:50:00Z - OCL-US-002
- What was implemented
  - Added role-based directive authorization in `provider-clawproxy` plugin:
    - new config block: `directiveAuth` (`enabled`, `operatorRoles`, `buyerRoles`, `restrictedDirectives`)
    - parses slash directives from prompt/messages
    - resolves sender role from event/context metadata
    - fail-closed denies restricted directives for buyer/non-operator roles
  - Deterministic denial paths:
    - `DIRECTIVE_AUTH_ROLE_REQUIRED`
    - `DIRECTIVE_AUTH_DENIED`
  - Updated OpenClaw integration docs with operator-vs-buyer directive auth pattern.
- Tests
  - Extended `packages/openclaw-provider-clawproxy/test/airlock-bootstrap.test.mjs` with directive parsing/authz regression cases.
  - `node --test test/*.test.mjs` passed.
---
## 2026-02-11T22:20:00Z - OCL-US-003
- What was implemented
  - Shipped a sensitive consulting preset artifact:
    - `packages/openclaw-provider-clawproxy/presets/sensitive-consulting.openclaw.json`
    - includes `sandbox.mode=all`, `workspaceAccess=none`, `network=none`, minimal tool profile, and deny defaults for browser/web/session/message/network groups
  - Added plugin-level sensitive profile enforcement:
    - new config block `sensitiveProfile` (`enabled`, `forbidSkillAutoAllowBins`)
    - bootstrap scan detects `skills/*/skill.json` with `autoAllowBins=true`
    - fail-closed denial at run start with `SENSITIVE_PROFILE_SKILL_BIN_AUTOALLOW_FORBIDDEN`
  - Documented preset + trust-tier mapping in `docs/integration/OPENCLAW_INTEGRATION.md`.
- Tests
  - Added/extended regression tests in `packages/openclaw-provider-clawproxy/test/airlock-bootstrap.test.mjs`:
    - preset security defaults validation
    - sensitiveProfile denial for `autoAllowBins=true`
  - `node --test test/*.test.mjs` passed.
---

   ## 2026-02-11T22:45:00Z - clawea secure
 hardening rollout (private clawea + public
 submodule bump)

   - Delivery completed in private repo:
     - PR #8:
 https://github.com/clawbureau/clawea/pull/8
     - Merge:
 2f03e164e0e69d6aa16d20eccd0f1db5b9d8d344
   - Public monorepo rollout:
     - PR #119:
 https://github.com/clawbureau/clawbureau/pull/11
 9
     - Merge:
 a0c81d1e83a91e8c22816f38427f444cd7671908
   - Shipped scope highlights:
     - secure deploy validation + safe-mode smoke
     - real Ed25519 did:key generation
     - secure posture endpoint
     - expanded directive guard + tenant policy
 controls + richer directive-block audit
     - real `/v1/audit/runs` integration + signed
 audit export
     - tenant suspend hard-stop and
 wake/deploy/ws denial when suspended
     - budget/runtime enforcement and
 connector/workspace fail-closed checks
     - execution-attestation clawlogs anchoring
 refs
     - staging path fallback cleanup and CI
 hardening
   - Deploy evidence:
     - staging version:
 `2c007a9d-79e3-4aeb-84a6-d5fde64247ec`
     - prod version:
 `f16a3bc0-9527-4e98-9483-d58b32863329`
   - Smoke evidence:
     - secure deploy staging: PASS
     - secure deploy prod safe-mode: PASS
     - suspend hard-stop staging: PASS

## 2026-02-11T11:05:00Z - clawea enterprise productization slice (post-#120)
- What was implemented
  - Private clawea PR #9 merged:
    - https://github.com/clawbureau/clawea/pull/9
    - Merge: `ca4758fe68822c79605923412778740fe2e6541c`
  - Added skills productization surfaces:
    - D1 migration `0005_productization_skills_templates_billing.sql`
    - tenant custom skill upload API (`/v1/skills/upload`) with hash + manifest safety checks
    - agent skill install/list/remove APIs (`/v1/agents/:id/skills*`)
    - fail-closed startup checks for custom-skill existence + R2 bundle presence
  - Added template revision/governance:
    - immutable revisions (`template_family_id`, `version`, `is_latest`, `is_immutable`)
    - deploy latest vs pin controls
    - secure family governance (`cea_tmpl_secure_enterprise`) with admin-override path only
  - Added channel binding + tenant policy enforcement:
    - `PATCH /v1/agents/:id/channels`
    - tenant `channel_policy` in admin access-policy patch
  - Added billing expansion:
    - normalized `GET /v1/billing/usage`
    - budget alert event ledger + deterministic 100% actions + optional webhook
    - invoice snapshot MVP (`invoices`, `invoice_line_items`, list/detail/generate APIs)
  - Added audit expansion:
    - `GET /v1/audit/runs/:id`
    - richer audit export deltas (`delta=true&cursor=`)
  - Added tests + smoke:
    - new unit tests for skill manifest, template revisions, channel policy, billing usage
    - smoke script: `scripts/smoke-enterprise-productization-next.mjs`
- Rollout evidence
  - Migration applied:
    - staging DB: PASS
    - prod DB: PASS
  - Deploy versions:
    - staging: `f9c19e52-8291-4e05-974c-cbe550617323`
    - prod: `4118c590-3d75-4ef3-8817-64b877c028ab`
  - Smoke artifacts:
    - `services/clawea/artifacts/smoke/productization-next/2026-02-11T11-03-47Z-staging/result.json` (PASS)
    - `services/clawea/artifacts/smoke/productization-next/2026-02-11T11-03-52Z-prod/result.json` (PASS)
- Notes
  - D1 remote migration path rejected CREATE TRIGGER statements with `SQLITE_ERROR code 7500 (incomplete input)` in this environment; equivalent relationship checks are enforced fail-closed in app logic.

## 2026-02-11T16:33:00Z - clawea Finance M2.1 closure (CEA-US-046H + CEA-US-047H)
- What was implemented
  - Private clawea PR #14 merged:
    - https://github.com/clawbureau/clawea/pull/14
    - Merge: `3562b7a125638ac91742d41eba4fd7e67fb376bf`
  - Closed non-degraded settlement verification posture:
    - strict modes now required in clawea (`INVOICE_SETTLEMENT_VERIFICATION_MODE=required`, `INVOICE_SETTLEMENT_OWNERSHIP_MODE=required`)
    - upstream ledger auth contract closed via public PR #134 (`LEDGER_SETTLEMENT_VERIFY_TOKEN` read-path support, mutating endpoints still admin-key gated)
  - Added operator reliability controls:
    - `GET /v1/billing/reconciliation/failures`
    - `GET /v1/billing/settlement-events`
    - `POST /v1/billing/settlement-events/:ingest_id/retry`
    - `POST /v1/billing/invoices/reconcile/retry`
  - Added replay-safe retry outcome upserts + aggregate event status recomputation + explicit retry audit events.
  - Added helper module/tests and expanded finance smoke coverage for operator controls.
- Rollout evidence
  - Migrations:
    - staging/prod apply => `No migrations to apply` (schema unchanged for this increment)
  - Deploy versions:
    - staging: `c52d6df6-b8e8-4524-a824-e5524bd30644`
    - prod: `bb384493-de95-4473-bf91-c9bb7c931508`
  - Smoke artifacts:
    - `services/clawea/artifacts/smoke/finance-m2/2026-02-11T16-26-37Z-staging-nondegraded-npm/result.json` (PASS)
    - `services/clawea/artifacts/smoke/finance-m2/2026-02-11T16-26-44Z-prod-nondegraded-npm/result.json` (PASS)
    - `services/clawea/artifacts/smoke/finance-m2/2026-02-11T16-26-17Z-retry-repair/result.json` (PASS, failed->retry->paid)

## 2026-02-11T18:30:00Z - clawea Finance stripe lane (CEA-US-048H) production closure
- What was implemented
  - Private clawea PR #15 merged:
    - https://github.com/clawbureau/clawea/pull/15
    - Merge: `26302c8f4349e310b50b53aa515ab8d1ba68fef1`
  - Added finance reliability baseline snapshot script + artifacts:
    - `scripts/ops-finance-health-snapshot.mjs`
    - `artifacts/ops/finance-health/*/{summary.json,summary.md}` for staging + prod
  - Added stripe invoice billing bridge in clawea:
    - `POST /v1/billing/invoices/:id/stripe/initiate`
    - `POST /v1/settlements/stripe/webhook`
  - Preserved fail-closed invariant:
    - stripe webhook path does not directly set invoice `paid`
    - webhook feeds settlement ingest + reconciliation state machine
  - Added migration:
    - `migrations/0010_stripe_invoice_payments.sql`
- Rollout evidence
  - Migrations:
    - staging: `0010_stripe_invoice_payments.sql` applied ✅
    - prod: `0010_stripe_invoice_payments.sql` applied ✅
  - Deploy versions:
    - staging: `92897166-0150-4349-97d7-04306382153d`
    - prod: `0ba0be8d-f112-413f-9e5d-5acab1e1c925`
  - Smoke artifacts:
    - `services/clawea/artifacts/smoke/finance-stripe/2026-02-11T17-37-15Z-staging/result.json` (PASS)
    - `services/clawea/artifacts/smoke/finance-stripe/2026-02-11T18-24-18Z-prod/result.json` (PASS)

## 2026-02-11T22:20:00Z - ICP-US-001/002/003 (identity control-plane hard cutover)
- What was implemented
  - **ICP-US-001 (clawclaim)**
    - Added controller-first control-plane challenge + registration flow and owner-bound sensitive policy lifecycle:
      - `POST /v1/control-plane/challenges`
      - `POST /v1/control-plane/controllers/register`
      - `POST /v1/control-plane/controllers/{controller_did}/agents/register`
      - `POST /v1/control-plane/controllers/{controller_did}/sensitive-policy`
      - chain read/list endpoints under `/v1/control-plane/controllers/*`
  - **ICP-US-002 (clawscope)**
    - Added canonical CST issuance lane with chain checks and deterministic migration gate:
      - `POST /v1/tokens/issue/canonical`
      - migration-gated legacy `POST /v1/tokens/issue` (`SCOPE_LEGACY_EXCHANGE_MODE`)
      - `POST /v1/tokens/introspect/matrix`
      - `GET /v1/revocations/stream`
      - `GET /v1/keys/rotation-contract`
    - Extended scoped token claim contract (`packages/schema/auth/scoped_token_claims.v1.json`) with canonical lane claims + hash bindings.
  - **ICP-US-003 (clawverify)**
    - Added deterministic verification APIs with remediation hints:
      - `POST /v1/verify/control-chain`
      - `POST /v1/verify/token-control`
    - Added explicit dependency config for chain/introspection lookups in `services/clawverify/wrangler.toml`.
- Deterministic error codes added (new)
  - clawscope:
    - `CANONICAL_CHAIN_REQUIRED`
    - `CANONICAL_AGENT_SUB_MISMATCH`
    - `CONTROL_CHAIN_INACTIVE`
    - `CONTROL_CHAIN_OWNER_MISMATCH`
    - `CONTROL_CHAIN_CONTEXT_MISMATCH`
    - `CONTROL_POLICY_HASH_MISMATCH`
    - `SENSITIVE_SCOPE_NOT_ALLOWED`
    - `LEGACY_EXCHANGE_DISABLED`
    - `LEGACY_SENSITIVE_SCOPE_FORBIDDEN`
    - `TRANSITION_UNKNOWN`
  - clawverify:
    - `CONTROL_CHAIN_NOT_FOUND`
    - `CONTROL_CHAIN_CONTEXT_MISMATCH`
    - `TOKEN_CONTROL_SCOPE_HASH_MISMATCH`
    - `TOKEN_CONTROL_AUDIENCE_MISMATCH`
    - `TOKEN_CONTROL_SCOPE_MISSING`
    - `TOKEN_CONTROL_TRANSITION_FORBIDDEN`
    - `TOKEN_CONTROL_CHAIN_MISSING`
    - `TOKEN_CONTROL_SUBJECT_MISMATCH`
- Quality checks
  - `cd services/clawclaim && npm run typecheck && npm test`
  - `cd services/clawscope && npm run typecheck && npm test`
  - `cd services/clawverify && npm run typecheck && npm test`
- Deployment status
  - Tracker complete in code + tests.
  - Staging deploy versions:
    - `clawclaim-staging`: `7c1cf0b7-af77-4d21-b29d-b902055519a5`
    - `clawscope-staging`: `37e14c8f-1016-4b5e-b117-70dd372e0131`
    - `clawverify-staging`: `db16bf9e-8c5a-49cb-a9f6-083efd86d476`
  - Production deploy versions:
    - `clawclaim`: `4af46ea4-05b7-43de-ae1f-6f100b4fde56`
    - `clawscope`: `2edbae03-adf5-4b8a-8cce-74ff3613cd79`
    - `clawverify`: `9e4298b9-e129-44f8-ad3a-20a4e52cd15b`
  - Smoke artifacts:
    - staging: `artifacts/smoke/identity-control-plane/2026-02-11T21-47-01-985Z-staging/result.json`
    - prod: `artifacts/smoke/identity-control-plane/2026-02-11T21-47-11-161Z-prod/result.json`

## 2026-02-11T23:15:00Z - CCL-US-013/014/015 (claim lifecycle portability hardening)
- What was implemented
  - Extended clawclaim control-plane challenge purposes for lifecycle operations:
    - `confirm_rotation`
    - `transfer_controller_request`
    - `transfer_controller_confirm`
    - `export_identity`
    - `import_identity`
  - Added rotation continuity endpoint:
    - `POST /v1/control-plane/rotations/confirm`
    - supports controller/agent role confirmations, deterministic alias records, and replay-safe outcomes.
  - Added controller transfer state-machine endpoints:
    - `POST /v1/control-plane/controllers/{controller_did}/transfer/request`
    - `POST /v1/control-plane/controllers/{controller_did}/transfer/confirm`
    - enforces `active -> transfer_pending -> transferred` semantics with mutation freeze while pending.
  - Added signed identity portability endpoints:
    - `POST /v1/control-plane/identity/export`
    - `POST /v1/control-plane/identity/import`
    - HMAC-signed bundle envelope with deterministic hash/signature/freshness validation.
  - Added schema contract:
    - `packages/schema/identity/identity_export_bundle.v1.json`
- Deterministic error codes added (new)
  - `CONTROLLER_TRANSFER_FROZEN`
  - `ROTATION_CONFLICT`
  - `TRANSFER_ALREADY_PENDING`
  - `TRANSFER_NOT_PENDING`
  - `IMPORT_BUNDLE_TAMPERED`
  - `IMPORT_BUNDLE_STALE`
  - `IMPORT_ALIAS_CONFLICT`
- Quality checks
  - `cd services/clawclaim && npm run typecheck && npm test`
  - `cd services/clawscope && npm run typecheck && npm test`
  - `cd services/clawverify && npm run typecheck && npm test`
- Deployment status
  - Updated `clawclaim` deploy versions:
    - `clawclaim-staging`: `ace3a741-85e3-4fcb-b582-aac6993d974f`
    - `clawclaim`: `2b45efe3-7bfd-48b2-a9c2-df5250f51488`
  - Existing `clawscope` + `clawverify` versions reused for smoke matrix:
    - staging: `clawscope=37e14c8f-e14f-4ec7-b2d7-9c22a6d9ce9b`, `clawverify=db16bf9e-af27-499e-a523-f180f9dd8dc0`
    - prod: `clawscope=2edbae03-cf2e-4ba9-9be4-18f9786dd9a5`, `clawverify=9e4298b9-5bf0-415c-8fa4-920242d6fef9`
  - Smoke artifacts:
    - staging: `artifacts/smoke/identity-control-plane/2026-02-11T22-10-50-682Z-staging/result.json`
    - prod: `artifacts/smoke/identity-control-plane/2026-02-11T22-11-02-225Z-prod/result.json`

## 2026-02-11T23:45:00Z - M3/M4 identity lane: kid interoperability + Cloudflare runtime hardening
- What was implemented
  - **P0 blocker fix** (`TOKEN_UNKNOWN_KID`) across staging/prod:
    - Root cause: scope signing key divergence between envs caused downstream cross-env introspection to fail closed on unknown kid.
    - Added verify-only overlap key contract in clawscope (`SCOPE_VERIFY_PUBLIC_KEYS_JSON`) without enabling signing rights.
    - Added deterministic overlap expiry error `TOKEN_KID_EXPIRED`.
    - Added introspection diagnostics (`kid`, `kid_source`) for deterministic triage.
  - **Rotation contract uplift**:
    - `GET /v1/keys/rotation-contract` now returns contract v2 with `signing_kids`, `verify_only_kids`, `expiring_kids`.
    - `GET /v1/jwks` now returns currently accepted (non-expired) keys only.
  - **Verifier hardening for downstream stability**:
    - `verify-token-control` maps upstream kid failures deterministically:
      - `TOKEN_UNKNOWN_KID` -> `TOKEN_CONTROL_KEY_UNKNOWN`
      - `TOKEN_KID_EXPIRED` -> `TOKEN_CONTROL_KEY_EXPIRED`
    - Added deterministic remediation hints for key-overlap reissue/sync flows.
  - **Runtime hygiene uplift (Cloudflare)**:
    - Updated compatibility dates to `2026-02-11` for:
      - `services/clawclaim/wrangler.toml`
      - `services/clawscope/wrangler.toml`
      - `services/clawverify/wrangler.toml`
- Deterministic error codes added (new)
  - clawscope:
    - `TOKEN_KID_EXPIRED`
  - clawverify:
    - `TOKEN_CONTROL_KEY_UNKNOWN`
    - `TOKEN_CONTROL_KEY_EXPIRED`
- Agent C compatibility note (explicit)
  - File: `scripts/identity/COMPATIBILITY-NOTE-AGENT-C-token-kid.md`
  - For requester/token-gate flows:
    - treat `TOKEN_CONTROL_KEY_UNKNOWN` and `TOKEN_CONTROL_KEY_EXPIRED` as deterministic fail-closed outcomes requiring **token reissue** (not blind retries)
    - refresh key overlap metadata from `/v1/keys/rotation-contract` + `/v1/jwks` before retrying with a new token
- Quality checks
  - `cd services/clawclaim && npm run typecheck && npm test`
  - `cd services/clawscope && npm run typecheck && npm test`
  - `cd services/clawverify && npm run typecheck && npm test`
- Deployment status
  - staging:
    - `clawclaim-staging`: `d8df6360-b7b8-4800-9bf7-c7a899c4dd73`
    - `clawscope-staging`: `30cb1291-9cf1-467d-ac2c-f697a9a7b422`
    - `clawverify-staging`: `c2602134-d6ad-4110-b71e-2837edf59082`
  - prod:
    - `clawclaim`: `247f3971-fbb1-4e31-8cd0-1287ac960b07`
    - `clawscope`: `b45c4100-8ba5-44ba-b2e6-e715329bc744`
    - `clawverify`: `8d79f1f9-1a97-4b61-a796-0d1622f0181e`
- Smoke artifacts
  - full identity lane:
    - staging: `artifacts/smoke/identity-control-plane/2026-02-11T22-42-34-634Z-staging/result.json`
    - prod: `artifacts/smoke/identity-control-plane/2026-02-11T22-42-46-640Z-prod/result.json`
  - key interop blocker validation:
    - `artifacts/smoke/identity-control-plane/2026-02-11T22-43-00-300Z-kid-interop/result.json`

## 2026-02-11T23:50:00Z - ICP-M5 identity + observability lane closure (CCL-US-004..009, CSC-US-007..013)
- What was implemented
  - `clawclaim` M5 identity productization shipped (new module `services/clawclaim/src/m5-identity.ts` + route wiring):
    - platform claims (`/v1/platform-claims/*`)
    - primary DID/profile (`/v1/accounts/*/primary-did`, `/profile`)
    - binding audit trail + compliance export (`/v1/bindings/audit*`)
    - owner attestation registry + provider lookup (`/v1/owner-attestations/*`)
    - challenge->CST exchange (`/v1/scoped-tokens/challenges`, `/v1/scoped-tokens/exchange`)
    - org/team roster manifests (`/v1/orgs/*/roster-*`)
  - `clawscope` observability/reporting stack shipped (`services/clawscope/src/observability.ts` + index integration):
    - dashboard/reports (`/v1/metrics/dashboard`, `/v1/reports/*`, `/v1/analytics/cost`, `/v1/missions/aggregate`)
    - alerting + traces (`/v1/alerts/*`, `/v1/traces*`)
    - queue + D1 + DO + R2 + Analytics Engine + cron materialization flow
    - deterministic admin overlap-key support (`SCOPE_ADMIN_KEYS_JSON`) for safe key rotation/testing
- Cloudflare provisioning + hygiene
  - D1 migrations applied:
    - `services/clawclaim/migrations/0001_identity_registry.sql`
    - `services/clawscope/migrations/0001_observability_stack.sql`
  - `wrangler deploy --dry-run` executed for staging/prod env separation across clawclaim/clawscope/clawverify
- Quality checks
  - `cd services/clawclaim && npm run typecheck && npm test`
  - `cd services/clawscope && npm run typecheck && npm test`
  - `cd services/clawverify && npm run typecheck && npm test`
- Deployment status
  - staging:
    - `clawclaim-staging`: `2204a9ff-2376-4910-944c-8b517a526122`
    - `clawscope-staging`: `aa78cace-a561-4efe-908a-8696cbbc40f8`
  - prod:
    - `clawclaim`: `b2be579c-eb85-4c41-b3cd-80a439848368`
    - `clawscope`: `56b88b3f-7914-42dc-a680-a6a9b43f3d8d`
- Smoke artifacts (production evidence gate)
  - staging: `artifacts/smoke/identity-control-plane/2026-02-11T23-49-28-476Z-staging-m5/result.json`
  - prod: `artifacts/smoke/identity-control-plane/2026-02-11T23-49-48-765Z-prod-m5/result.json`
- Baseline identity gate re-run (post-M5 deploys)
  - hard-cutover staging: `artifacts/smoke/identity-control-plane/2026-02-11T23-57-12-636Z-staging/result.json`
  - hard-cutover prod: `artifacts/smoke/identity-control-plane/2026-02-11T23-57-22-079Z-prod/result.json`
  - kid interop: `artifacts/smoke/identity-control-plane/2026-02-11T23-57-43-712Z-kid-interop/result.json`
- Deterministic fail-closed outcomes validated in smoke
  - `TOKEN_EXCHANGE_CHALLENGE_USED`
  - `TRANSITION_UNKNOWN`
  - revoked-token introspection state (`active=false`, `revoked=true`)
