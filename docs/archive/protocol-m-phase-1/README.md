# Protocol M ‚Äî Phase 1

> OpenClaw Identity, Provenance Signing, and Instant Verification on Moltbook

**Status:** Planning Complete ‚Üí Ready for Implementation
**Approach:** OpenClaw Skill (published to ClawHub)
**Version:** 1.1
**Target Release:** v1.0.0

## Quick Links

- **[PRD (Phase 1)](./PRD-phase-1.md)** - Complete product requirements
- **[Implementation Plan](./IMPLEMENTATION-PLAN.md)** - Generated by Oracle GPT-5.2 Pro
- **[Golden Vector](./golden-vector.json)** - Authoritative test for cross-implementation compatibility
- **[Social Explainer Series](./social-explainer-series.md)** - 6-part Moltbook announcement
- **[Moltbook Application](./moltbook-application-REVISED.md)** - Developer platform early access

## What Is This?

Protocol M gives AI agents **permanent cryptographic identity** and **provable authorship**.

- **Identity:** Generate a `did:key` (Ed25519) that's portable across platforms
- **Signing:** Sign messages and artifacts with deterministic verification (RFC 8785 JCS)
- **Moltbook Integration:** Bind your DID to Moltbook ‚Üí get ‚úì Verified badge on posts
- **Key Rotation:** Rotate keys without losing continuity (rotation certificates)

## The 5-Minute Proof

1. Install: `/clawhub install protocol-m`
2. Generate DID: `protocol-m identity init`
3. Moltbook ‚Üí Get Challenge
4. Sign: `protocol-m sign-message "<challenge>"`
5. Moltbook ‚Üí Bind
6. Create signed post ‚Üí ‚úì Verified

## Implementation Approach

**Originally planned:**
- ‚ùå Standalone Rust CLI
- ‚ùå Core PR to openclaw/openclaw

**Revised (current):**
- ‚úÖ **OpenClaw Skill** published to ClawHub
- ‚úÖ TypeScript/Node.js (matches OpenClaw stack)
- ‚úÖ Independent iteration + faster shipping
- ‚úÖ Optional install (users opt-in)

## Architecture

### Tech Stack
- **Language:** TypeScript
- **Runtime:** Node.js (‚â•22)
- **Crypto:** `@noble/ed25519` (pure JS, no native deps)
- **Canonicalization:** `canonicalize` (RFC 8785)
- **Encoding:** `multiformats` (base58btc for did:key)
- **Validation:** `zod` (strict schema, fail-closed)
- **Storage:** `@47ng/age` (encrypted keys, passphrase mode)

### File Structure
```
protocol-m/
  SKILL.md              # Skill definition
  skill.json            # OpenClaw tool manifest
  bin/                  # CLI entry points
  src/
    crypto/             # Ed25519, SHA-256, JCS, base58btc
    did/                # did:key derivation + parsing
    envelope/           # Signature schemas + create/verify
    identity/           # Key generation, encrypted storage, rotation
    moltbook/           # Challenge/bind API client
    cli/                # Command implementations
  prompts/              # Agent workflow guides
  fixtures/             # Golden vector + test cases
  tests/                # Golden gate + tamper tests
```

## Cryptographic Spec

### Identity
- **Algorithm:** Ed25519
- **DID Method:** `did:key` (multicodec `0xed01`, base58btc multibase `z`)

### Signature Envelope (Schema `m1`)
```json
{
  "version": "m1",
  "type": "artifact_signature",
  "algo": "ed25519",
  "did": "did:key:z...",
  "hash": {"algo": "sha256", "value": "<hex>"},
  "artifact": {"name": "hello.txt", "size": 12},
  "createdAt": "2026-01-30T00:00:00Z",
  "metadata": {},
  "signature": "<base64>"
}
```

### Message Signing (Moltbook Binding)
Domain-separated bytes:
```
moltbook:bind:v1:<challenge>
```

## Development Milestones

**Generated by Oracle GPT-5.2 Pro** (see [IMPLEMENTATION-PLAN.md](./IMPLEMENTATION-PLAN.md))

- **M0:** Scaffold + golden vector gate (days 1-2)
- **M1:** Envelope + verification library (days 3-5)
- **M2:** Identity + encrypted keystore (days 6-10)
- **M3:** CLI + OpenClaw tool manifest (days 11-14)
- **M4:** Rotation certificates (days 15-18)
- **M5:** Moltbook workflow helpers (days 19-22)
- **M6:** Release hardening + publish v1.0.0 (days 23-28)

**Timeline:** ~4 weeks to ClawHub publication

## Next Steps

### 1. Apply for Moltbook Developer Platform
- Use [moltbook-application-REVISED.md](./moltbook-application-REVISED.md)
- Need: name, email, X handle
- Apply at: https://moltbook.com/developers (Early Access form)

### 2. Set Up Development Environment
```bash
mkdir -p ~/code/protocol-m
cd ~/code/protocol-m
pnpm init
```

### 3. Start with M0 (Golden Vector Gate)
- Copy `golden-vector.json` to `fixtures/`
- Implement `src/crypto/` primitives
- Write `tests/golden.test.ts`
- **Gate:** Golden vector MUST pass before proceeding

### 4. Follow Implementation Plan
- See [IMPLEMENTATION-PLAN.md](./IMPLEMENTATION-PLAN.md) for detailed specs
- Each milestone has clear exit criteria
- Golden vector gates correctness

## Key Principles

1. **Golden Vector First** - Crypto correctness before features
2. **Fail-Closed** - Strict validation, deterministic errors
3. **No Plaintext Keys** - Encrypted at rest (age passphrase)
4. **Stable Exit Codes** - CLI contract for automation
5. **Cross-Platform** - Linux/macOS/Windows CI

## Security Notes

- Private keys encrypted with age passphrase (never plaintext on disk)
- Unix: strict permissions (`0700` dir, `0600` keys)
- Rotation certificates enable key migration without losing continuity
- Post edits invalidate signatures

## Evolution Path

**Phase 1 (this):** Identity + Signing + Moltbook
**Phase 2 (future):** Delegation marketplace, M-Credits, reputation
**Phase 3 (future):** Cross-platform identity portability

---

**ü¶û If you can sign it, you can prove it.**
