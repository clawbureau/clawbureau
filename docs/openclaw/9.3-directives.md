Menu

## Directives

Relevant source files
- [.npmrc](https://github.com/openclaw/openclaw/blob/bf6ec64f/.npmrc)
- [CHANGELOG.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/CHANGELOG.md)
- [README.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/README.md)
- [assets/avatar-placeholder.svg](https://github.com/openclaw/openclaw/blob/bf6ec64f/assets/avatar-placeholder.svg)
- [docs/tools/slash-commands.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md)
- [extensions/memory-core/package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/extensions/memory-core/package.json)
- [package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/package.json)
- [pnpm-lock.yaml](https://github.com/openclaw/openclaw/blob/bf6ec64f/pnpm-lock.yaml)
- [pnpm-workspace.yaml](https://github.com/openclaw/openclaw/blob/bf6ec64f/pnpm-workspace.yaml)
- [scripts/clawtributors-map.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/clawtributors-map.json)
- [scripts/update-clawtributors.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/update-clawtributors.ts)
- [scripts/update-clawtributors.types.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/update-clawtributors.types.ts)
- [src/agents/pi-embedded-runner-extraparams.live.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/pi-embedded-runner-extraparams.live.test.ts)
- [src/agents/pi-embedded-runner-extraparams.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/pi-embedded-runner-extraparams.test.ts)
- [src/auto-reply/command-detection.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/command-detection.ts)
- [src/auto-reply/commands-args.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/commands-args.ts)
- [src/auto-reply/commands-registry.data.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/commands-registry.data.ts)
- [src/auto-reply/commands-registry.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/commands-registry.test.ts)
- [src/auto-reply/commands-registry.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/commands-registry.ts)
- [src/auto-reply/commands-registry.types.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/commands-registry.types.ts)
- [src/auto-reply/group-activation.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/group-activation.ts)
- [src/auto-reply/reply.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply.ts)
- [src/auto-reply/reply/commands-info.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/commands-info.test.ts)
- [src/auto-reply/reply/commands-info.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/commands-info.ts)
- [src/auto-reply/reply/commands.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/commands.ts)
- [src/auto-reply/reply/directive-handling.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts)
- [src/auto-reply/send-policy.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/send-policy.ts)
- [src/auto-reply/status.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/status.test.ts)
- [src/auto-reply/status.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/status.ts)
- [src/auto-reply/templating.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/templating.ts)
- [src/discord/monitor/native-command.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/discord/monitor/native-command.ts)
- [src/index.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/index.ts)
- [src/slack/monitor/slash.command-arg-menus.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/slack/monitor/slash.command-arg-menus.test.ts)
- [src/slack/monitor/slash.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/slack/monitor/slash.ts)
- [src/telegram/bot-handlers.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/telegram/bot-handlers.ts)
- [src/telegram/bot/types.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/telegram/bot/types.ts)
- [ui/package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/package.json)
- [ui/src/styles.css](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/src/styles.css)
- [ui/src/styles/layout.mobile.css](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/src/styles/layout.mobile.css)

## Purpose and Scope

Directives are inline commands that modify agent behavior mid-conversation. Unlike standalone commands that execute actions, directives adjust session parameters and are stripped from the message before the model sees it. This page covers directive syntax, processing modes, authorization, and implementation.

For general chat command reference, see [Command Reference](https://deepwiki.com/openclaw/openclaw/9.1-command-reference). For platform-specific command implementations (Discord slash commands, Telegram menus), see [Platform-Specific Commands](https://deepwiki.com/openclaw/openclaw/9.2-platform-specific-commands).

---

## Directives vs Commands

| Aspect | Directives | Commands |
| --- | --- | --- |
| **Purpose** | Modify agent behavior/settings | Execute actions or query status |
| **Examples** | `/think high`, `/verbose on`, `/model opus` | `/status`, `/help`, `/restart` |
| **Inline use** | Yes, mixed with regular text | Some shortcuts only (`/status`, `/help`) |
| **Stripped before model** | Always | Only inline shortcuts |
| **Persistence** | Depends on mode (inline vs directive-only) | N/A (immediate execution) |
| **Authorization** | Required (allowlist/pairing) | Required for most commands |
| **Message handling** | Continue to model after stripping | Fast-path reply or model invocation |

**Sources**: [docs/tools/slash-commands.md 12-21](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L12-L21)

---

## Processing Modes

Directives behave differently depending on whether they appear inline with text or as standalone directive-only messages.

### Inline Hints (Transient)

When directives appear with regular text, they act as **transient hints** for the current message only:

```
/think high What's the weather in Paris?
```
- Directive is parsed and applied to the current agent turn
- Directive is stripped from the message text
- Settings do **not** persist to the session
- Remaining text (`What's the weather in Paris?`) is sent to the model

### Directive-Only Messages (Persistent)

When a message contains **only directives** (no other text), settings persist to the session and the Gateway replies with an acknowledgment:

```
/think high /verbose on
→ Reply: "Settings updated: Think: high · Verbose: on"
```
- All directives are parsed and validated
- Settings are written to the session store via `sessions.patch`
- An acknowledgment message is sent back to the user
- No message is sent to the model

**Sources**: [docs/tools/slash-commands.md 16-18](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L16-L18) [src/auto-reply/reply/directive-handling.ts 4](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L4-L4)

---

## Authorization Model

Directives are only processed for **authorized senders**. Unauthorized senders see directives treated as plain text and passed through to the model unchanged.

```
No
(unauthorized)Yes
(allowlisted)No
(has text)Yes
(only directives)Inbound Message
'/think high how are you'Sender Authorized?
(allowlist/pairing)parseInlineDirectives()
Extract directivesTreat as Plain Text
Pass through unchangedisDirectiveOnly()?applyInlineDirectivesFastLane()
Transient hintspersistInlineDirectives()
Save to session storeStrip directives from textSend to Model
'how are you'Send Acknowledgment
'Settings updated'
```

Authorization checks use the same mechanisms as command gating:

- Channel `allowFrom` configuration
- DM pairing policies (`pairing`, `open`, `allowlist`)
- `commands.useAccessGroups` configuration
- Plugin-specific access control lists

**Sources**: [docs/tools/slash-commands.md 19-20](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L19-L20) [src/auto-reply/reply/directive-handling.ts 1-6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L1-L6) [src/channels/command-gating.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/channels/command-gating.ts)

---

## Directive Types

### Think Level (/think, /thinking, /t)

Controls the agent's reasoning depth. Higher levels trigger extended thinking mode (when supported by the model).

**Syntax**:

```
/think <off|minimal|low|medium|high|xhigh>
```

**Levels**:

- `off` — No extended thinking
- `minimal` — Brief reasoning (1-2 lines)
- `low` — Basic reasoning (paragraph)
- `medium` — Moderate reasoning (multiple paragraphs)
- `high` — Deep reasoning (extensive analysis)
- `xhigh` — Maximum reasoning (thorough exploration)

**Model support**: Dynamic based on provider capabilities. OpenAI GPT-5.2 and Google Codex support extended thinking; other models ignore these directives.

**Example**:

```
/think high Explain quantum entanglement
→ Agent thinks for ~30s, produces detailed reasoning
```

**Sources**: [docs/tools/slash-commands.md 83](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L83-L83) [src/auto-reply/reply/directives.ts 3-4](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts#L3-L4) [src/auto-reply/thinking.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/thinking.ts)

---

### Verbose Mode (/verbose, /v)

Controls visibility of tool invocations and internal agent state.

**Syntax**:

```
/verbose <on|full|off>
```

**Modes**:

- `off` — Hide tool calls and internal details (default)
- `on` — Show tool call summaries
- `full` — Show complete tool call details (arguments, results)

**Warning**: Verbose output may leak internal reasoning or sensitive tool parameters. Use cautiously in group chats.

**Example**:

```
/verbose on What's 2+2?
→ [Tool: calculator(expression="2+2")] Result: 4
```

**Sources**: [docs/tools/slash-commands.md 84](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L84-L84) [src/auto-reply/reply/directives.ts 5-6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts#L5-L6)

---

### Reasoning Display (/reasoning, /reason)

Controls how reasoning/thinking blocks are delivered to the user.

**Syntax**:

```
/reasoning <on|off|stream>
```

**Modes**:

- `off` — Hide reasoning blocks entirely
- `on` — Send reasoning as a separate message prefixed with `Reasoning:`
- `stream` — Stream reasoning to a Telegram draft (Telegram-only)

**Example**:

```
/reasoning on Explain photosynthesis
→ Message 1: "Reasoning: I'll break this down into..."
→ Message 2: "Photosynthesis is the process..."
```

**Sources**: [docs/tools/slash-commands.md 85](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L85-L85) [src/auto-reply/reply/directives.ts 2](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts#L2-L2)

---

### Elevated Execution (/elevated, /elev)

Controls host-level command execution privileges (requires `tools.elevated` allowlist).

**Syntax**:

```
/elevated <on|off|ask|full>
```

**Modes**:

- `off` — Disable elevated execution
- `on` — Enable with approval prompts (default when allowlisted)
- `ask` — Prompt for every elevated command
- `full` — Skip approval prompts (dangerous; requires explicit allowlist)

**Example**:

```
/elevated on
→ Agent can now run elevated commands after approval
```

**Sources**: [docs/tools/slash-commands.md 86](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L86-L86) [src/auto-reply/reply/directives.ts 1](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts#L1-L1)

---

### Exec Configuration (/exec)

Configures where and how shell commands execute. Supports key-value syntax.

**Syntax**:

```
/exec host=<sandbox|gateway|node> security=<deny|allowlist|full> ask=<off|on-miss|always> node=<id>
```

**Parameters**:

- `host` — Execution target: `sandbox` (Docker), `gateway` (host), or `node` (paired device)
- `security` — Policy: `deny` (no exec), `allowlist` (safe bins only), `full` (unrestricted)
- `ask` — Approval mode: `off` (auto), `on-miss` (prompt when not allowlisted), `always` (prompt every time)
- `node` — Target node ID when `host=node`

**Example**:

```
/exec host=sandbox security=allowlist
→ Commands run in Docker with safe binary restrictions
```

**Query current settings**:

```
/exec
→ Current: host=gateway security=allowlist ask=on-miss
```

**Sources**: [docs/tools/slash-commands.md 87](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L87-L87) [src/auto-reply/reply/exec.ts 8](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/exec.ts#L8-L8)

---

### Model Selection (/model, /models)

Switches the active model for the session. Supports aliases, fuzzy matching, and provider prefixes.

**Syntax**:

```
/model <name|number|alias|provider/model|provider@profile>
```

**Examples**:

```
/model opus                    → Switch to Claude Opus (fuzzy match)
/model openai/gpt-5.2          → Explicit provider/model
/model 3                       → Select from numbered picker
/model opus@anthropic:default  → Specific auth profile
/model list                    → Show picker
/model status                  → Show detailed model/auth info
```

**Picker format**: When no argument is provided or `list` is used, displays a numbered menu:

```
/model
→ 1. claude-opus-4-5 (anthropic)
→ 2. claude-sonnet-4-5 (anthropic, openai)
→ 3. gpt-5.2 (openai)
```

**Sources**: [docs/tools/slash-commands.md 126-145](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L126-L145) [src/auto-reply/reply/directives.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts)

---

### Queue Mode (/queue)

Configures message queuing behavior for the session. Supports key-value syntax.

**Syntax**:

```
/queue <mode> [debounce:<duration>] [cap:<number>] [drop:<policy>]
```

**Parameters**:

- `mode` — `none` (immediate), `collect` (batch), `sequential` (ordered)
- `debounce` — Wait duration (e.g., `2s`, `500ms`)
- `cap` — Maximum queue size
- `drop` — When full: `old`, `new`, `summarize`

**Examples**:

```
/queue collect debounce:2s     → Batch messages with 2s delay
/queue sequential cap:25       → Process in order, max 25 queued
/queue none                    → Disable queuing
/queue                         → Show current settings
```

**Sources**: [docs/tools/slash-commands.md 89](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L89-L89) [src/auto-reply/reply/queue.ts 9](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/queue.ts#L9-L9)

---

## Processing Pipeline

### Parsing Phase

The `parseInlineDirectives` function scans the message body for directive patterns and extracts them into a structured format.

```
Raw Message Text
'/think high /verbose on hello'Tokenize
Split by whitespaceMatch Directive Patterns
RegExp matchingExtract Directive Values
think=high, verbose=onBuild InlineDirectives
{think: 'high', verbose: 'on'}
```

**Code references**:

- [src/auto-reply/reply/directive-handling.parse.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.parse.ts) — `parseInlineDirectives()` implementation
- [src/auto-reply/reply/directives.ts 1-6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts#L1-L6) — Individual directive extractors (`extractThinkDirective`, `extractVerboseDirective`, etc.)

**Sources**: [src/auto-reply/reply/directive-handling.ts 3-4](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L3-L4)

---

### Application Phase

Directives are applied differently based on message type.

```
Has textOnly directivesParsed Directives
{think: 'high', verbose: 'on'}Message Type?Inline Mode
applyInlineDirectivesFastLane()Directive-Only Mode
persistInlineDirectives()Apply to Current Turn
(transient)Write to Session Store
sessions.patch()Format Acknowledgment
formatDirectiveAck()Strip Directives
Remove from body
```

**Inline mode** (transient hints):

- Directives are applied to the current agent turn context
- Settings do not persist beyond this message
- Message text is stripped and sent to the model

**Directive-only mode** (persistent settings):

- Directives are validated and written to the session store
- A confirmation message is sent back to the user
- No message is sent to the model

**Code references**:

- [src/auto-reply/reply/directive-handling.fast-lane.js](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.fast-lane.js) — `applyInlineDirectivesFastLane()` for transient application
- [src/auto-reply/reply/directive-handling.persist.ts 5](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.persist.ts#L5-L5) — `persistInlineDirectives()` for session persistence
- [src/auto-reply/reply/directive-handling.shared.js](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.shared.js) — `formatDirectiveAck()` for acknowledgment messages

**Sources**: [src/auto-reply/reply/directive-handling.ts 1-6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L1-L6)

---

### Stripping Phase

After directives are extracted and applied, they must be removed from the message body before sending to the model.

**Stripping rules**:

1. Remove directive tokens and their arguments
2. Collapse multiple consecutive whitespace to single space
3. Trim leading/trailing whitespace
4. Preserve non-directive text exactly

**Example**:

```
Input:  "/think high /verbose on What's the weather?"
Output: "What's the weather?"
```

The stripped message is stored in the `BodyForAgent` template context field and passed to the agent runtime.

**Code references**:

- [src/auto-reply/reply/directive-handling.impl.js](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.impl.js) — Directive stripping implementation
- [src/auto-reply/templating.ts 19](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/templating.ts#L19-L19) — `BodyForAgent` field definition

**Sources**: [src/auto-reply/templating.ts 1-175](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/templating.ts#L1-L175)

---

## Session Persistence

When directive-only messages are detected, directives are persisted to the session store via the Gateway's `sessions.patch` WebSocket method.

```
Directive-Only Message
'/think high /verbose on'Validate Directives
Check syntax & valuesBuild Session Patch
{thinkingLevel: 'high', verboseLevel: 'on'}sessions.patch RPC
Write to session storeSession Store
~/.openclaw/sessions.jsonSend Acknowledgment
'Settings updated: Think: high · Verbose: on'
```

**Session fields updated**:

- `thinkingLevel` — `/think` directive
- `verboseLevel` — `/verbose` directive
- `reasoningLevel` — `/reasoning` directive
- `elevatedLevel` — `/elevated` directive
- `modelOverride`, `providerOverride` — `/model` directive
- `queueMode`, `queueDebounceMs`, `queueCap`, `queueDropPolicy` — `/queue` directive
- `execHost`, `execSecurity`, `execAsk`, `execNode` — `/exec` directive

**Code references**:

- [src/auto-reply/reply/directive-handling.persist.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.persist.ts) — `persistInlineDirectives()` implementation
- [src/config/sessions.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/sessions.ts) — Session store schema and persistence
- [src/gateway/server.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/server.ts) — `sessions.patch` WebSocket RPC handler

**Sources**: [src/auto-reply/reply/directive-handling.ts 5](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L5-L5) [src/config/sessions.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/sessions.ts)

---

## Authorization and Security

Directive processing is gated by the same authorization checks as commands:

1. **Channel allowlist** — Sender must be in `channels.<channel>.allowFrom`
2. **DM policy** — DM messages follow `channels.<channel>.dm.policy` (pairing, allowlist, open)
3. **Access groups** — `commands.useAccessGroups` enforces group-level restrictions
4. **Plugin policies** — Extension channels may have custom authorization logic

Unauthorized senders see directives as **plain text** — they are not parsed, not stripped, and passed through to the model unchanged. This prevents directive injection attacks from untrusted users.

**Code references**:

- [src/channels/command-gating.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/channels/command-gating.ts) — `resolveCommandAuthorizedFromAuthorizers()` authorization logic
- [src/auto-reply/reply/inbound-context.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/inbound-context.ts) — `finalizeInboundContext()` sets `CommandAuthorized` flag
- [src/auto-reply/reply/directive-handling.parse.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.parse.ts) — Checks `CommandAuthorized` before parsing

**Sources**: [docs/tools/slash-commands.md 19-20](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L19-L20) [src/channels/command-gating.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/channels/command-gating.ts)

---

## Code Entity Reference

### Core Directive Functions

| Function | File | Purpose |
| --- | --- | --- |
| `parseInlineDirectives()` | [src/auto-reply/reply/directive-handling.parse.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.parse.ts) | Parse directives from message text |
| `isDirectiveOnly()` | [src/auto-reply/reply/directive-handling.parse.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.parse.ts) | Check if message contains only directives |
| `applyInlineDirectivesFastLane()` | [src/auto-reply/reply/directive-handling.fast-lane.js](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.fast-lane.js) | Apply transient directives to current turn |
| `persistInlineDirectives()` | [src/auto-reply/reply/directive-handling.persist.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.persist.ts) | Persist directives to session store |
| `formatDirectiveAck()` | [src/auto-reply/reply/directive-handling.shared.js](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.shared.js) | Format acknowledgment message |
| `extractThinkDirective()` | [src/auto-reply/reply/directives.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts) | Extract `/think` directive |
| `extractVerboseDirective()` | [src/auto-reply/reply/directives.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts) | Extract `/verbose` directive |
| `extractReasoningDirective()` | [src/auto-reply/reply/directives.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts) | Extract `/reasoning` directive |
| `extractElevatedDirective()` | [src/auto-reply/reply/directives.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directives.ts) | Extract `/elevated` directive |
| `extractExecDirective()` | [src/auto-reply/reply/exec.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/exec.ts) | Extract `/exec` directive |
| `extractQueueDirective()` | [src/auto-reply/reply/queue.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/queue.ts) | Extract `/queue` directive |

### Type Definitions

| Type | File | Purpose |
| --- | --- | --- |
| `InlineDirectives` | [src/auto-reply/reply/directive-handling.parse.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.parse.ts) | Parsed directive structure |
| `ThinkLevel` | [src/auto-reply/thinking.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/thinking.ts) | Think level values |
| `VerboseLevel` | [src/auto-reply/thinking.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/thinking.ts) | Verbose mode values |
| `ReasoningLevel` | [src/auto-reply/thinking.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/thinking.ts) | Reasoning display mode |
| `ElevatedLevel` | [src/auto-reply/thinking.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/thinking.ts) | Elevated execution level |

**Sources**: [src/auto-reply/reply.ts 1-11](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply.ts#L1-L11) [src/auto-reply/reply/directive-handling.ts 1-6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/auto-reply/reply/directive-handling.ts#L1-L6)

---

## Configuration

Directive behavior is controlled by configuration flags:

```
{
  commands: {
    text: true,              // Enable text command parsing
    native: "auto",          // Register native commands
    useAccessGroups: true    // Enforce authorization checks
  }
}
```

**Configuration precedence**:

1. Session overrides (from directive-only messages)
2. Agent defaults (`agents.defaults.*`)
3. Global defaults (hardcoded in the codebase)

**Sources**: [docs/tools/slash-commands.md 26-40](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/tools/slash-commands.md#L26-L40) [src/config/commands.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/commands.ts)

<svg id="mermaid-fu8dstus3vp" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-7khuxtjp8f" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg>