Menu

## Protocol Specification

Relevant source files
- [AGENTS.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/AGENTS.md)
- [apps/android/app/build.gradle.kts](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/android/app/build.gradle.kts)
- [apps/ios/Sources/Info.plist](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/ios/Sources/Info.plist)
- [apps/ios/Tests/Info.plist](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/ios/Tests/Info.plist)
- [apps/ios/project.yml](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/ios/project.yml)
- [docs/platforms/fly.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/platforms/fly.md)
- [docs/platforms/mac/release.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/platforms/mac/release.md)
- [docs/reference/RELEASING.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/reference/RELEASING.md)
- [fly.private.toml](https://github.com/openclaw/openclaw/blob/bf6ec64f/fly.private.toml)
- [fly.toml](https://github.com/openclaw/openclaw/blob/bf6ec64f/fly.toml)
- [scripts/protocol-gen-swift.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts)
- [scripts/write-build-info.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/write-build-info.ts)
- [src/cron/run-log.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/cron/run-log.test.ts)
- [src/cron/run-log.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/cron/run-log.ts)
- [src/cron/store.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/cron/store.ts)
- [src/gateway/protocol/index.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts)
- [src/gateway/protocol/schema.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts)
- [src/gateway/server.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/server.ts)
- [src/infra/git-commit.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/infra/git-commit.ts)

The OpenClaw Gateway exposes a **WebSocket-based JSON-RPC protocol** that enables bidirectional communication between the Gateway control plane and connected clients (CLI, Control UI, TUI, mobile apps). This document specifies the protocol's frame structure, method catalog, schema validation architecture, and code generation pipeline for native clients.

For general Gateway architecture and service management, see [Gateway](https://deepwiki.com/openclaw/openclaw/3-gateway). For remote access patterns (SSH tunnels, Tailscale), see [Remote Access](https://deepwiki.com/openclaw/openclaw/3.4-remote-access). For CLI commands that invoke protocol methods, see [CLI Reference](https://deepwiki.com/openclaw/openclaw/12-cli-reference).

---

## Protocol Architecture

The Gateway protocol operates over **WebSocket connections** at the configured port (default 18789). All messages are JSON-encoded frames validated against JSON Schema definitions. The protocol supports three frame types: **Request** (client→server RPC invocation), **Response** (server→client RPC result), and **Event** (server→client push notification).

```
RPC HandlersGateway :18789Client (CLI/UI/App)RequestFrame
{type:'req',method,params,id}WebSocketValid RequestFrameResponseFrame
{type:'res',result,id}EventFrame
{type:'event',event,data}ResponseEventsWebSocket ClientRequest Builder
(method + params)Response HandlerEvent ListenerWebSocket ServerFrame Validator
(Ajv)Method RouterEvent EmitterAgent HandlersNode HandlersSession HandlersConfig HandlersCron Handlers20+ Other Domains
```

**Sources**: [src/gateway/protocol/index.ts 1-435](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L1-L435) [src/gateway/server.ts 1-4](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/server.ts#L1-L4)

---

## Frame Types

The protocol defines a **union type** `GatewayFrame` with three discriminated variants. All frames must include a `type` discriminator field.

### Frame Structure

```
GatewayFrame
(union)RequestFrame
type: 'req'ResponseFrame
type: 'res'EventFrame
type: 'event'• id: string
• method: string
• params: object• id: string
• result?: any
• error?: ErrorShape• event: string
• data?: any
```

**Sources**: [src/gateway/protocol/schema.ts 9](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L9-L9) [src/gateway/protocol/index.ts 90-93](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L90-L93) [scripts/protocol-gen-swift.ts 159-209](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L159-L209)

### RequestFrame

Client-initiated RPC invocations. Each request must include a unique `id` for response correlation.

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| `type` | `"req"` | ✓ | Frame discriminator |
| `id` | `string` | ✓ | Unique request identifier (UUID recommended) |
| `method` | `string` | ✓ | RPC method name (e.g., `"agent.send"`, `"config.get"`) |
| `params` | `object` | ✓ | Method-specific parameters (validated against param schema) |

**Example**:

```
{
  "type": "req",
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "method": "agent.send",
  "params": {
    "message": "Hello from protocol spec"
  }
}
```

**Sources**: [src/gateway/protocol/index.ts 201-202](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L201-L202) [src/gateway/protocol/schema.ts 12](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L12-L12)

### ResponseFrame

Server replies correlated to requests via the `id` field. Contains either `result` (success) or `error` (failure).

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| `type` | `"res"` | ✓ | Frame discriminator |
| `id` | `string` | ✓ | Request ID from original RequestFrame |
| `result` | `any` | ✗ | Method-specific result (present on success) |
| `error` | `ErrorShape` | ✗ | Error details (present on failure) |

**ErrorShape Structure**:

```
{
  code: string;        // Error code from ErrorCodes enum
  message: string;     // Human-readable error message
  details?: any;       // Optional structured error details
}
```

**Sources**: [src/gateway/protocol/index.ts 202](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L202-L202) [src/gateway/protocol/schema.ts 6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L6-L6)

### EventFrame

Server-initiated push notifications. Not correlated to any request. Used for real-time updates (agent events, chat streaming, presence changes).

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| `type` | `"event"` | ✓ | Frame discriminator |
| `event` | `string` | ✓ | Event type name (e.g., `"agent"`, `"chat"`, `"tick"`, `"shutdown"`) |
| `data` | `object` | ✗ | Event-specific payload |

**Common event types**:

- `agent`: Agent execution events (tool calls, reasoning, completion)
- `chat`: Chat message streaming chunks
- `tick`: Periodic heartbeat (presence)
- `shutdown`: Gateway shutdown notification

**Sources**: [src/gateway/protocol/index.ts 203](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L203-L203) [src/gateway/protocol/schema.ts 3-5](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L3-L5) [src/gateway/protocol/schema.ts 10](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L10-L10)

---

## Connection Flow

Clients establish a WebSocket connection, send a `ConnectParams` handshake, and receive a `HelloOk` response before invoking other RPC methods.

```
"Auth Guard""Ajv Validator""Gateway :18789"Client"Auth Guard""Ajv Validator""Gateway :18789"Clientloop[Active Session]alt[Auth failed][Auth success]alt[Invalid params][Valid params]WebSocket ConnectConnection EstablishedRequestFrame{method: "connect", params: ConnectParams}validateConnectParams(params)Validation errorsResponseFrame{error: {code: "invalid_params"}}Close connectionValidCheck token/authUnauthorizedResponseFrame{error: {code: "unauthorized"}}Close connectionAuthorizedResponseFrame{result: HelloOk}RequestFrame (any method)Validate paramsResponseFrameEventFrame (push)
```

**Sources**: [src/gateway/protocol/index.ts 200](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L200-L200) [src/gateway/protocol/schema.ts 1](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L1-L1)

### ConnectParams Schema

| Field | Type | Required | Description |
| --- | --- | --- | --- |
| `version` | `number` | ✓ | Protocol version (must match `PROTOCOL_VERSION`) |
| `token` | `string` | ✗ | Auth token (required for non-loopback bindings) |

### HelloOk Response

| Field | Type | Description |
| --- | --- | --- |
| `version` | `number` | Server protocol version |
| `serverInfo` | `object` | Server metadata (commit hash, uptime, etc.) |

**Sources**: [src/gateway/protocol/index.ts 358-359](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L358-L359)

---

## RPC Method Catalog

The protocol exposes **70+ RPC methods** organized into 18 functional domains. Each method is validated with a dedicated Ajv schema compiler.

### Agent Methods

| Method | Params Schema | Description |
| --- | --- | --- |
| `agent.send` | `SendParamsSchema` | Send message to agent for processing |
| `agent.identity` | `AgentIdentityParamsSchema` | Get agent identity information |
| `agent.wait` | `AgentWaitParamsSchema` | Wait for agent to finish current task |
| `agents.list` | `AgentsListParamsSchema` | List all configured agents |
| `agent.wake` | `WakeParamsSchema` | Wake agent from idle state |
| `agent.poll` | `PollParamsSchema` | Poll for agent state updates |

**Validator functions**: [src/gateway/protocol/index.ts 204-211](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L204-L211)

**Sources**: [src/gateway/protocol/index.ts 204-211](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L204-L211) [src/gateway/protocol/schema.ts 1](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L1-L1)

### Node Methods

Methods for managing paired device nodes (iOS, Android, macOS) and invoking their capabilities.

| Method | Params Schema | Description |
| --- | --- | --- |
| `node.pair.request` | `NodePairRequestParamsSchema` | Initiate node pairing flow |
| `node.pair.list` | `NodePairListParamsSchema` | List pending pairing requests |
| `node.pair.approve` | `NodePairApproveParamsSchema` | Approve pending pairing |
| `node.pair.reject` | `NodePairRejectParamsSchema` | Reject pending pairing |
| `node.pair.verify` | `NodePairVerifyParamsSchema` | Verify pairing code |
| `node.rename` | `NodeRenameParamsSchema` | Rename paired node |
| `node.list` | `NodeListParamsSchema` | List all paired nodes |
| `node.describe` | `NodeDescribeParamsSchema` | Get node capabilities |
| `node.invoke` | `NodeInvokeParamsSchema` | Invoke node capability (camera, location, etc.) |
| `node.invoke.result` | `NodeInvokeResultParamsSchema` | Report invocation result (from node) |
| `node.event` | `NodeEventParamsSchema` | Node-initiated event |

**Validator functions**: [src/gateway/protocol/index.ts 212-232](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L212-L232)

**Sources**: [src/gateway/protocol/index.ts 212-232](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L212-L232) [src/gateway/protocol/schema.ts 8](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L8-L8)

### Session Methods

Manage agent conversation sessions (history, compaction, reset).

| Method | Params Schema | Description |
| --- | --- | --- |
| `sessions.list` | `SessionsListParamsSchema` | List all sessions |
| `sessions.preview` | `SessionsPreviewParamsSchema` | Preview session history |
| `sessions.resolve` | `SessionsResolveParamsSchema` | Resolve session key to ID |
| `sessions.patch` | `SessionsPatchParamsSchema` | Update session metadata |
| `sessions.reset` | `SessionsResetParamsSchema` | Clear session history |
| `sessions.delete` | `SessionsDeleteParamsSchema` | Delete session |
| `sessions.compact` | `SessionsCompactParamsSchema` | Compact session history |

**Validator functions**: [src/gateway/protocol/index.ts 233-249](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L233-L249)

**Sources**: [src/gateway/protocol/index.ts 233-249](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L233-L249) [src/gateway/protocol/schema.ts 13](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L13-L13)

### Config Methods

Read and modify Gateway configuration (openclaw.json).

| Method | Params Schema | Description |
| --- | --- | --- |
| `config.get` | `ConfigGetParamsSchema` | Read config value by path |
| `config.set` | `ConfigSetParamsSchema` | Write config value by path |
| `config.apply` | `ConfigApplyParamsSchema` | Apply full config object |
| `config.patch` | `ConfigPatchParamsSchema` | Patch config (merge) |
| `config.schema` | `ConfigSchemaParamsSchema` | Get config schema (validation) |

**Validator functions**: [src/gateway/protocol/index.ts 250-254](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L250-L254)

**Sources**: [src/gateway/protocol/index.ts 250-254](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L250-L254) [src/gateway/protocol/schema.ts 4](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L4-L4)

### Wizard Methods

Interactive onboarding wizard flow (multi-step configuration).

| Method | Params Schema | Description |
| --- | --- | --- |
| `wizard.start` | `WizardStartParamsSchema` | Start wizard flow |
| `wizard.next` | `WizardNextParamsSchema` | Advance to next step |
| `wizard.cancel` | `WizardCancelParamsSchema` | Cancel wizard |
| `wizard.status` | `WizardStatusParamsSchema` | Get current wizard state |

**Validator functions**: [src/gateway/protocol/index.ts 255-258](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L255-L258)

**Sources**: [src/gateway/protocol/index.ts 255-258](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L255-L258) [src/gateway/protocol/schema.ts 16](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L16-L16)

### Channel Methods

Manage messaging channel integrations (login, logout, status).

| Method | Params Schema | Description |
| --- | --- | --- |
| `channels.status` | `ChannelsStatusParamsSchema` | Get channel connection status |
| `channels.logout` | `ChannelsLogoutParamsSchema` | Logout from channel |
| `weblogin.start` | `WebLoginStartParamsSchema` | Start web-based login (QR code) |
| `weblogin.wait` | `WebLoginWaitParamsSchema` | Wait for web login completion |

**Validator functions**: [src/gateway/protocol/index.ts 260-265](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L260-L265) [src/gateway/protocol/index.ts 319-321](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L319-L321)

**Sources**: [src/gateway/protocol/index.ts 260-265](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L260-L265) [src/gateway/protocol/index.ts 319-321](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L319-L321) [src/gateway/protocol/schema.ts 3](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L3-L3)

### Model Methods

Query available AI model providers and their configurations.

| Method | Params Schema | Description |
| --- | --- | --- |
| `models.list` | `ModelsListParamsSchema` | List available models |

**Validator functions**: [src/gateway/protocol/index.ts 266](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L266-L266)

**Sources**: [src/gateway/protocol/index.ts 266](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L266-L266)

### Skills Methods

Manage workspace skills (install, update, query binaries).

| Method | Params Schema | Description |
| --- | --- | --- |
| `skills.status` | `SkillsStatusParamsSchema` | Get skills installation status |
| `skills.bins` | `SkillsBinsParamsSchema` | List skill binaries |
| `skills.install` | `SkillsInstallParamsSchema` | Install skill |
| `skills.update` | `SkillsUpdateParamsSchema` | Update skill |

**Validator functions**: [src/gateway/protocol/index.ts 267-271](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L267-L271)

**Sources**: [src/gateway/protocol/index.ts 267-271](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L267-L271)

### Cron Methods

Manage scheduled jobs (add, update, remove, list runs).

| Method | Params Schema | Description |
| --- | --- | --- |
| `cron.list` | `CronListParamsSchema` | List all cron jobs |
| `cron.status` | `CronStatusParamsSchema` | Get cron job status |
| `cron.add` | `CronAddParamsSchema` | Add new cron job |
| `cron.update` | `CronUpdateParamsSchema` | Update existing job |
| `cron.remove` | `CronRemoveParamsSchema` | Remove cron job |
| `cron.run` | `CronRunParamsSchema` | Manually trigger job |
| `cron.runs` | `CronRunsParamsSchema` | Get job run history |

**Validator functions**: [src/gateway/protocol/index.ts 272-278](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L272-L278)

**Sources**: [src/gateway/protocol/index.ts 272-278](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L272-L278) [src/gateway/protocol/schema.ts 5](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L5-L5) [src/cron/store.ts 1-46](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/cron/store.ts#L1-L46) [src/cron/run-log.ts 1-87](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/cron/run-log.ts#L1-L87)

### Device Methods

Legacy device pairing (superseded by node methods but retained for compatibility).

| Method | Params Schema | Description |
| --- | --- | --- |
| `device.pair.list` | `DevicePairListParamsSchema` | List device pairings |
| `device.pair.approve` | `DevicePairApproveParamsSchema` | Approve device pairing |
| `device.pair.reject` | `DevicePairRejectParamsSchema` | Reject device pairing |
| `device.token.rotate` | `DeviceTokenRotateParamsSchema` | Rotate device auth token |
| `device.token.revoke` | `DeviceTokenRevokeParamsSchema` | Revoke device token |

**Validator functions**: [src/gateway/protocol/index.ts 279-293](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L279-L293)

**Sources**: [src/gateway/protocol/index.ts 279-293](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L279-L293) [src/gateway/protocol/schema.ts 8](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L8-L8)

### Exec Approval Methods

Manage execution approval policies (manual approval for dangerous commands).

| Method | Params Schema | Description |
| --- | --- | --- |
| `exec.approvals.get` | `ExecApprovalsGetParamsSchema` | Get approval snapshot |
| `exec.approvals.set` | `ExecApprovalsSetParamsSchema` | Set approval policies |
| `exec.approval.request` | `ExecApprovalRequestParamsSchema` | Request approval for command |
| `exec.approval.resolve` | `ExecApprovalResolveParamsSchema` | Resolve pending approval |
| `exec.approvals.node.get` | `ExecApprovalsNodeGetParamsSchema` | Get node approval policies |
| `exec.approvals.node.set` | `ExecApprovalsNodeSetParamsSchema` | Set node approval policies |

**Validator functions**: [src/gateway/protocol/index.ts 294-311](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L294-L311)

**Sources**: [src/gateway/protocol/index.ts 294-311](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L294-L311) [src/gateway/protocol/schema.ts 7](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L7-L7)

### Log Methods

Tail Gateway logs in real-time.

| Method | Params Schema | Description |
| --- | --- | --- |
| `logs.tail` | `LogsTailParamsSchema` | Stream log entries |

**Validator functions**: [src/gateway/protocol/index.ts 312](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L312-L312)

**Sources**: [src/gateway/protocol/index.ts 312](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L312-L312) [src/gateway/protocol/schema.ts 10](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L10-L10)

### Chat Methods

Low-level chat interface (typically used by Control UI).

| Method | Params Schema | Description |
| --- | --- | --- |
| `chat.history` | `ChatHistoryParamsSchema` | Get chat history |
| `chat.send` | `ChatSendParamsSchema` | Send chat message |
| `chat.abort` | `ChatAbortParamsSchema` | Abort in-progress message |
| `chat.inject` | `ChatInjectParamsSchema` | Inject system message |

**Validator functions**: [src/gateway/protocol/index.ts 313-316](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L313-L316)

**Sources**: [src/gateway/protocol/index.ts 313-316](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L313-L316) [src/gateway/protocol/schema.ts 10](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L10-L10)

### Miscellaneous Methods

| Method | Params Schema | Description |
| --- | --- | --- |
| `update.run` | `UpdateRunParamsSchema` | Trigger software update check |
| `talkmode` | `TalkModeParamsSchema` | Enable/disable talk mode (voice) |

**Validator functions**: [src/gateway/protocol/index.ts 259](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L259-L259) [src/gateway/protocol/index.ts 318](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L318-L318)

**Sources**: [src/gateway/protocol/index.ts 259](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L259-L259) [src/gateway/protocol/index.ts 318](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L318-L318)

---

## Schema Validation Architecture

All protocol frames and parameters are validated using **Ajv** (Another JSON Schema Validator) compiled validators. Schema definitions are TypeScript-authored and exported from the schema module.

```
Runtime ValidationAjv CompilationSchema Definition (TypeScript)ajv.compile(schema)valid === falseErrorShapevalid === trueProtocolSchemas
(TypeBox definitions)AgentParamsSchemaNodeInvokeParamsSchemaConfigGetParamsSchema65+ Other SchemasAjv Instance
(allErrors: true)Compiled Validators
(functions)Incoming Framevalidate(frame)ValidationResultformatValidationErrors()
```

**Sources**: [src/gateway/protocol/index.ts 1-2](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L1-L2) [src/gateway/protocol/index.ts 194-321](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L194-L321)

### Ajv Configuration

The Ajv instance is configured with strict validation and comprehensive error reporting:

```
const ajv = new AjvPkg({
  allErrors: true,        // Collect all validation errors
  strict: false,          // Allow extended JSON Schema keywords
  removeAdditional: false // Preserve extra properties
});
```

**Reference**: [src/gateway/protocol/index.ts 194-198](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L194-L198)

### Validator Compilation Pattern

Each schema is pre-compiled into a validation function at module load time:

```
export const validateRequestFrame = ajv.compile<RequestFrame>(RequestFrameSchema);
export const validateAgentParams = ajv.compile(AgentParamsSchema);
export const validateNodeInvokeParams = ajv.compile<NodeInvokeParams>(NodeInvokeParamsSchema);
```

**Benefits**:

- **Performance**: Validators are compiled once, not per-invocation
- **Type safety**: TypeScript generic preserves type information
- **Error reporting**: Ajv provides detailed validation error paths

**Reference**: [src/gateway/protocol/index.ts 200-321](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L200-L321)

The `formatValidationErrors` function transforms Ajv's error array into human-readable strings:

```
formatValidationErrors(errors: ErrorObject[]): string
```

**Example output**:

- `"at /params/agentId: must be string"`
- `"at root: unexpected property 'invalidField'"`
- `"at /params/model: validation error"`

**Implementation**: [src/gateway/protocol/index.ts 323-355](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L323-L355)

**Sources**: [src/gateway/protocol/index.ts 323-355](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L323-L355)

---

## Swift Code Generation

The protocol schema is automatically code-generated into **Swift models** for iOS, macOS, and shared (via OpenClawKit) clients. Generation is idempotent and preserves Codable/Sendable conformance.

```
Swift Outputscripts/protocol-gen-swift.tsTypeScript SourceProtocolSchemas
(schema/protocol-schemas.ts)PROTOCOL_VERSION constLoad schemas
via importMap JSON Schema
to Swift typesEmit structs
(Codable + Sendable)Emit GatewayFrame
(tagged union)Emit ErrorCode
(String enum)apps/macos/.../GatewayModels.swiftapps/shared/.../GatewayModels.swift
```

**Sources**: [scripts/protocol-gen-swift.ts 1-245](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L1-L245)

### Type Mapping

JSON Schema types are mapped to Swift equivalents with nullability preserved:

| JSON Schema Type | Swift Type | Optional Suffix |
| --- | --- | --- |
| `"string"` | `String` | `?` if not required |
| `"integer"` | `Int` | `?` if not required |
| `"number"` | `Double` | `?` if not required |
| `"boolean"` | `Bool` | `?` if not required |
| `"array"` | `[ElementType]` | `?` if not required |
| `"object"` (no props) | `[String: AnyCodable]` | `?` if not required |
| `enum` (strings) | `String` | `?` if not required |
| Named schema | Schema name | `?` if not required |

**Implementation**: [scripts/protocol-gen-swift.ts 91-114](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L91-L114)

### Struct Generation

Each object schema generates a Swift struct with Codable conformance:

```
public struct NodeInvokeParams: Codable, Sendable {
    public let nodeId: String
    public let capability: String
    public let args: [String: AnyCodable]?
    public let timeout: Int?
    
    public init(
        nodeId: String,
        capability: String,
        args: [String: AnyCodable]? = nil,
        timeout: Int? = nil
    ) {
        self.nodeId = nodeId
        self.capability = capability
        self.args = args
        self.timeout = timeout
    }
    
    private enum CodingKeys: String, CodingKey {
        case nodeId = "node_id"
        case capability
        case args
        case timeout
    }
}
```

**Features**:

- **CodingKeys**: Handles snake\_case ↔ camelCase mapping
- **Sendable**: Enables cross-actor passing
- **Memberwise init**: Required for all properties

**Implementation**: [scripts/protocol-gen-swift.ts 116-157](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L116-L157)

### GatewayFrame Discriminated Union

The `GatewayFrame` enum implements manual Codable with type discrimination:

```
public enum GatewayFrame: Codable, Sendable {
    case req(RequestFrame)
    case res(ResponseFrame)
    case event(EventFrame)
    case unknown(type: String, raw: [String: AnyCodable])
    
    private enum CodingKeys: String, CodingKey {
        case type
    }
    
    public init(from decoder: Decoder) throws {
        let typeContainer = try decoder.container(keyedBy: CodingKeys.self)
        let type = try typeContainer.decode(String.self, forKey: .type)
        switch type {
        case "req": self = .req(try RequestFrame(from: decoder))
        case "res": self = .res(try ResponseFrame(from: decoder))
        case "event": self = .event(try EventFrame(from: decoder))
        default:
            let container = try decoder.singleValueContainer()
            let raw = try container.decode([String: AnyCodable].self)
            self = .unknown(type: type, raw: raw)
        }
    }
    
    public func encode(to encoder: Encoder) throws {
        switch self {
        case .req(let v): try v.encode(to: encoder)
        case .res(let v): try v.encode(to: encoder)
        case .event(let v): try v.encode(to: encoder)
        case .unknown(_, let raw):
            var container = encoder.singleValueContainer()
            try container.encode(raw)
        }
    }
}
```

**Features**:

- **Unknown case**: Handles future frame types gracefully
- **Type forwarding**: Delegates encoding/decoding to associated values
- **Pattern matching**: Enables exhaustive switch statements

**Implementation**: [scripts/protocol-gen-swift.ts 159-209](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L159-L209)

The `ErrorCode` enum is generated from TypeScript `ErrorCodes` object:

```
public enum ErrorCode: String, Codable, Sendable {
    case invalidParams = "invalid_params"
    case unauthorized = "unauthorized"
    case notFound = "not_found"
    case timeout = "timeout"
    // ... 15+ more cases
}
```

**Reference**: [scripts/protocol-gen-swift.ts 41-43](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L41-L43) [src/gateway/protocol/schema.ts 6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L6-L6)

### Output Locations

Generated Swift code is written to two locations:

1. **macOS app**: `apps/macos/Sources/OpenClawProtocol/GatewayModels.swift`
2. **Shared kit**: `apps/shared/OpenClawKit/Sources/OpenClawProtocol/GatewayModels.swift`

Both files are **identical** and auto-synced. The shared kit is used by iOS clients and referenced by macOS via Swift Package Manager.

**Configuration**: [scripts/protocol-gen-swift.ts 20-39](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L20-L39)

**Sources**: [scripts/protocol-gen-swift.ts 20-39](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L20-L39) [scripts/protocol-gen-swift.ts 211-240](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L211-L240)

---

## Versioning and Compatibility

The protocol version is exported as a constant and embedded in both client and server:

```
export const PROTOCOL_VERSION = 1;
```

**Swift equivalent**:

```
public let GATEWAY_PROTOCOL_VERSION = 1
```

**Version check flow**:

1. Client sends `ConnectParams` with its `PROTOCOL_VERSION`
2. Gateway validates client version matches server version
3. Mismatch results in connection rejection with `ErrorCode.protocolVersionMismatch`

### Version Locations

| File | Version Identifier | Purpose |
| --- | --- | --- |
| [src/gateway/protocol/schema.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts) | `PROTOCOL_VERSION` constant | Server protocol version |
| [scripts/protocol-gen-swift.ts 41](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L41-L41) | `GATEWAY_PROTOCOL_VERSION` constant | Swift client version |
| [package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/package.json) | `version` field | npm package version (2026.1.29) |
| [apps/ios/Sources/Info.plist 22-24](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/ios/Sources/Info.plist#L22-L24) | `CFBundleShortVersionString` / `CFBundleVersion` | iOS app version |
| [apps/android/app/build.gradle.kts 24-25](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/android/app/build.gradle.kts#L24-L25) | `versionCode` / `versionName` | Android app version |

**Breaking changes**: Protocol version bumps indicate **incompatible changes** (e.g., removing fields, changing types). Clients must upgrade to maintain compatibility.

**Sources**: [src/gateway/protocol/schema.ts 1](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L1-L1) [scripts/protocol-gen-swift.ts 41](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/protocol-gen-swift.ts#L41-L41) [apps/ios/Sources/Info.plist 22-24](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/ios/Sources/Info.plist#L22-L24) [apps/android/app/build.gradle.kts 24-25](https://github.com/openclaw/openclaw/blob/bf6ec64f/apps/android/app/build.gradle.kts#L24-L25)

---

Protocol errors are returned in `ResponseFrame.error` using the standardized `ErrorShape` structure.

### ErrorShape Structure

```
{
  code: string;        // ErrorCode enum value
  message: string;     // Human-readable description
  details?: any;       // Optional structured details (method-specific)
}
```

### ErrorCodes Enum

The `ErrorCodes` enum defines standard error codes:

| Code | Meaning |
| --- | --- |
| `invalid_params` | Request parameters failed validation |
| `unauthorized` | Missing or invalid authentication token |
| `not_found` | Requested resource does not exist |
| `timeout` | Operation exceeded time limit |
| `internal_error` | Unhandled server error |
| `rate_limited` | Too many requests |
| `unavailable` | Service temporarily unavailable |
| `protocol_version_mismatch` | Client/server version incompatibility |

**Sources**: [src/gateway/protocol/schema.ts 6](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L6-L6) [src/gateway/protocol/index.ts 86-88](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L86-L88)

When `code === "invalid_params"`, the `details` field contains formatted validation errors from `formatValidationErrors()`:

```
{
  "type": "res",
  "id": "550e8400-...",
  "error": {
    "code": "invalid_params",
    "message": "Validation failed",
    "details": "at /params/nodeId: must be string; at /params/timeout: must be integer"
  }
}
```

**Sources**: [src/gateway/protocol/index.ts 323-355](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L323-L355)

---

## Build Information Embedding

The Gateway embeds build metadata (version, commit hash, build timestamp) in runtime for diagnostics and version display. This metadata is generated at build time and read from `dist/build-info.json`.

### Build Info Schema

```
{
  "version": "2026.1.29",
  "commit": "a1b2c3d",
  "builtAt": "2026-01-29T12:00:00.000Z"
}
```

**Generation**: [scripts/write-build-info.ts 1-48](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/write-build-info.ts#L1-L48)

### Commit Hash Resolution

The build system resolves commit hash from multiple sources (in priority order):

1. `GIT_COMMIT` or `GIT_SHA` environment variables
2. `git rev-parse HEAD` (if `.git` available)
3. `package.json` `gitHead` field (npm pack)
4. `dist/build-info.json` `commit` field (post-build)

**Implementation**: [src/infra/git-commit.ts 66-109](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/infra/git-commit.ts#L66-L109)

**Sources**: [scripts/write-build-info.ts 20-32](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/write-build-info.ts#L20-L32) [src/infra/git-commit.ts 66-109](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/infra/git-commit.ts#L66-L109)

---

## Protocol Usage Examples

### Example: Send Message to Agent

**Request**:

```
{
  "type": "req",
  "id": "req-1",
  "method": "agent.send",
  "params": {
    "message": "What is the weather?",
    "agentId": "main"
  }
}
```

**Response** (immediate):

```
{
  "type": "res",
  "id": "req-1",
  "result": {
    "sessionId": "main:user123",
    "status": "processing"
  }
}
```

**Events** (streaming):

```
{"type":"event","event":"agent","data":{"type":"tool_call","tool":"exec","args":{"cmd":"curl wttr.in"}}}
{"type":"event","event":"agent","data":{"type":"tool_result","result":"Weather: 72°F, Sunny"}}
{"type":"event","event":"agent","data":{"type":"text","text":"The current weather is 72°F and sunny."}}
{"type":"event","event":"agent","data":{"type":"done"}}
```

### Example: List Paired Nodes

**Request**:

```
{
  "type": "req",
  "id": "req-2",
  "method": "node.list",
  "params": {}
}
```

**Response**:

```
{
  "type": "res",
  "id": "req-2",
  "result": {
    "nodes": [
      {
        "id": "iphone-12-pro",
        "name": "Peter's iPhone",
        "platform": "ios",
        "capabilities": ["camera.photo", "camera.video", "location.current"],
        "lastSeen": 1706515200000
      }
    ]
  }
}
```

### Example: Get Config Value

**Request**:

```
{
  "type": "req",
  "id": "req-3",
  "method": "config.get",
  "params": {
    "path": "agents.defaults.model.primary"
  }
}
```

**Response**:

```
{
  "type": "res",
  "id": "req-3",
  "result": {
    "value": "anthropic/claude-opus-4-5"
  }
}
```

**Sources**: All examples derived from schema definitions in [src/gateway/protocol/schema.ts 1-16](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/schema.ts#L1-L16)

---

## Implementation Notes

### Performance Considerations

- **Pre-compiled validators**: Ajv schemas are compiled once at module load (not per-request)
- **Binary WebSocket**: Consider MessagePack for high-throughput deployments (protocol supports pluggable serialization)
- **Frame batching**: Multiple requests can be pipelined over a single WebSocket connection

### Security Considerations

- **Token validation**: Non-loopback bindings (`--bind lan`, `--bind tailnet`) require `token` in `ConnectParams`
- **Origin checks**: WebSocket connections validate Origin header when not on loopback
- **Rate limiting**: Protocol supports `rate_limited` error code for throttling
- **Schema validation**: All inputs are validated before handler invocation (prevents injection attacks)

### Testing

The protocol schemas are validated in CI via:

- TypeScript compilation (type checking)
- Ajv compilation (schema validity)
- Swift generation (cross-platform consistency)
- Live integration tests ([docs/reference/RELEASING.md 43-48](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/reference/RELEASING.md#L43-L48))

**Sources**: [src/gateway/protocol/index.ts 194-198](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/protocol/index.ts#L194-L198) [docs/reference/RELEASING.md 43-48](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/reference/RELEASING.md#L43-L48)

<svg id="mermaid-fu8dstus3vp" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-7khuxtjp8f" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-5cnv3xfsc84" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-hmbioix2qbm" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-z5tp3lz1enf" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg>