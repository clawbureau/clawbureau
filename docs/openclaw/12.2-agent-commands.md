Menu

## Agent Commands

Relevant source files
- [.npmrc](https://github.com/openclaw/openclaw/blob/bf6ec64f/.npmrc)
- [CHANGELOG.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/CHANGELOG.md)
- [README.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/README.md)
- [assets/avatar-placeholder.svg](https://github.com/openclaw/openclaw/blob/bf6ec64f/assets/avatar-placeholder.svg)
- [docs/cli/index.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md)
- [docs/gateway/index.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/gateway/index.md)
- [docs/gateway/troubleshooting.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/gateway/troubleshooting.md)
- [docs/index.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/index.md)
- [docs/start/getting-started.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/getting-started.md)
- [docs/start/wizard.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md)
- [extensions/memory-core/package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/extensions/memory-core/package.json)
- [package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/package.json)
- [pnpm-lock.yaml](https://github.com/openclaw/openclaw/blob/bf6ec64f/pnpm-lock.yaml)
- [pnpm-workspace.yaml](https://github.com/openclaw/openclaw/blob/bf6ec64f/pnpm-workspace.yaml)
- [scripts/clawtributors-map.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/clawtributors-map.json)
- [scripts/update-clawtributors.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/update-clawtributors.ts)
- [scripts/update-clawtributors.types.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/scripts/update-clawtributors.types.ts)
- [src/agents/pi-embedded-runner-extraparams.live.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/pi-embedded-runner-extraparams.live.test.ts)
- [src/agents/pi-embedded-runner-extraparams.test.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/pi-embedded-runner-extraparams.test.ts)
- [src/index.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/index.ts)
- [ui/package.json](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/package.json)
- [ui/src/styles.css](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/src/styles.css)
- [ui/src/styles/layout.mobile.css](https://github.com/openclaw/openclaw/blob/bf6ec64f/ui/src/styles/layout.mobile.css)

## Purpose and Scope

This page documents the CLI commands for agent operations: executing agent turns (`openclaw agent`), managing multi-agent configurations (`openclaw agents`), sending direct messages (`openclaw message send`), and viewing session state (`openclaw sessions`). These commands provide direct control over agent execution and routing.

For agent execution internals and the Pi agent runtime architecture, see [Agent System](https://deepwiki.com/openclaw/openclaw/5-agent-system). For configuring agent behavior, model selection, and multi-agent routing policies, see [Multi-Agent Configuration](https://deepwiki.com/openclaw/openclaw/4.3-multi-agent-configuration).

## Overview

Agent commands interact with the Gateway control plane to execute agent turns, manage isolated agent configurations, and control message routing. The Gateway routes inbound messages to agents based on channel bindings and session keys, while CLI commands provide direct programmatic access to agent execution and configuration management.

**Command categories:**

| Command | Purpose |
| --- | --- |
| `openclaw agent` | Execute a single agent turn (immediate execution) |
| `openclaw agents list/add/delete` | Manage isolated agent configurations with dedicated workspaces and auth |
| `openclaw message send` | Send messages directly to channels (bypasses agent execution) |
| `openclaw sessions` | View and query stored conversation state |

Sources: [docs/cli/index.md 438-510](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L438-L510) [README.md 438-480](https://github.com/openclaw/openclaw/blob/bf6ec64f/README.md#L438-L480)

---

## Agent Command Flow

```
Model Provider(Anthropic/OpenAI/etc)Pi Agent Core@mariozechner/pi-agent-corePi Embedded Runnerpiembeddedrunner.tsAgent RouterresolveAgent()Gateway WebSocketws://127.0.0.1:18789CLI ProcessModel Provider(Anthropic/OpenAI/etc)Pi Agent Core@mariozechner/pi-agent-corePi Embedded Runnerpiembeddedrunner.tsAgent RouterresolveAgent()Gateway WebSocketws://127.0.0.1:18789CLI Processopenclaw agent --message "..." --to targetalt[Tool Call]loop[Agent Turn]opt[--deliver flag]RPC: agent.run{message, to?, sessionId?, thinking, verbose}resolveAgent(envelope, session)Check bindings + session keyagentId + workspace + authcreateAgentRunner(agentId, config)Load workspace bootstrap files(AGENTS.md, SOUL.md, TOOLS.md)Build system prompt + tool schemasagent.run(message, context, tools)Stream request with toolsText/Tool Call/Thinking eventsexecuteTool(name, args)Tool resultStream eventEvent notificationFinal response + usageRPC response: {runId, status, summary}Route response to target channel
```

**Execution modes:**

- **Gateway mode (default)**: CLI sends RPC request to Gateway; Gateway coordinates execution
- **Local mode** (`--local`): CLI runs embedded agent directly without Gateway (development/testing)
- **Embedded runner**: [src/agents/piembeddedrunner.ts](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/piembeddedrunner.ts) wraps Pi Agent Core for OpenClaw integration

Sources: [docs/cli/index.md 438-480](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L438-L480) [src/agents/piembeddedrunner.ts 1-500](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/piembeddedrunner.ts#L1-L500)

---

## openclaw agent - Execute Agent Turns

### Purpose

Execute a single agent turn via the Gateway (or embedded locally). The agent processes the message, invokes tools as needed, and returns a response. Optionally deliver the response back to a messaging channel.

### Command Syntax

```
openclaw agent --message <text> [options]
```

### Required Arguments

| Argument | Description |
| --- | --- |
| `--message <text>` | Input message for the agent to process |

### Options

| Option | Description | Default |
| --- | --- | --- |
| `--to <dest>` | Target for session key derivation and optional delivery | `main` session |
| `--session-id <id>` | Explicit session ID (overrides `--to` derivation) | Derived from `--to` |
| `--thinking <level>` | Extended thinking level: `off\|minimal\|low\|medium\|high\|xhigh` | Per-session default |
| `--verbose <mode>` | Verbose mode: `on\|full\|off` | Per-session default |
| `--channel <name>` | Channel for session key derivation: `whatsapp\|telegram\|discord\|slack\|signal\|imessage` | `whatsapp` |
| `--local` | Run embedded agent locally without Gateway | `false` (use Gateway) |
| `--deliver` | Deliver response to target channel after execution | `false` (return only) |
| `--json` | Output JSON response | `false` (human-readable) |
| `--timeout <seconds>` | RPC timeout for gateway calls | `120` |

### Session Key Resolution

The `--to` flag determines the session key for context isolation:

```
# DM session (main key by default)
openclaw agent --message "Hello" --to +15555550123

# Group session (isolated from DM sessions)
openclaw agent --message "Status check" --to whatsapp:group:12345@g.us --channel whatsapp

# Explicit session ID (advanced)
openclaw agent --message "Continue" --session-id "main"
```

**Session key patterns** (see [Session Management](https://deepwiki.com/openclaw/openclaw/5.3-session-management)):

- `main` - Default direct interaction session
- `dm:<channel>:<id>` - Channel-specific DM sessions (when `session.dmScope` is enabled)
- `group:<channel>:<id>` - Group chat sessions

Sources: [docs/cli/index.md 462-477](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L462-L477) [src/config/sessions.ts 1-100](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/sessions.ts#L1-L100)

### Examples

**Basic agent execution:**

```
# Simple query (no delivery)
openclaw agent --message "What's the current time?"

# With extended thinking (GPT-5.2/Codex models)
openclaw agent --message "Analyze this codebase" --thinking high

# Verbose output with full tool traces
openclaw agent --message "Debug the gateway" --verbose full
```

**Execution with delivery:**

```
# Execute and send response to WhatsApp contact
openclaw agent --message "Send status report" --to +15555550123 --deliver

# Execute in group context and reply back
openclaw agent --message "Summarize discussion" \
  --to whatsapp:group:12345@g.us \
  --channel whatsapp \
  --deliver
```

**Local embedded execution (development):**

```
# Run without Gateway (uses local config + embedded Pi runtime)
openclaw agent --local --message "Test agent response"
```

**JSON output (automation):**

```
# Machine-readable response
openclaw agent --message "List files" --json
```

Sources: [docs/cli/index.md 462-477](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L462-L477) [docs/start/getting-started.md 186-194](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/getting-started.md#L186-L194)

### Local vs Gateway Execution

| Mode | Gateway Connection | Use Case |
| --- | --- | --- |
| **Gateway (default)** | Connects to running Gateway via WebSocket | Production use, multi-channel routing, session persistence |
| **Local** (`--local`) | Embedded Pi runtime, no Gateway | Development, testing, offline execution |

**Gateway execution:**

- Requires running Gateway: `openclaw gateway status`
- Uses Gateway's agent routing and session management
- Respects multi-agent bindings and workspace isolation
- Supports delivery to channels (`--deliver`)

**Local execution:**

- No Gateway required
- Uses CLI process environment and config
- Limited to single agent (no multi-agent routing)
- No channel delivery support

Sources: [docs/cli/index.md 462-477](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L462-L477) [src/agents/piembeddedrunner.ts 1-100](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/piembeddedrunner.ts#L1-L100)

---

## openclaw agents - Multi-Agent Management

### Purpose

Manage isolated agent configurations with dedicated workspaces, authentication profiles, and channel bindings. Each agent has its own:

- **Workspace directory** (`agents.list[].workspace`) containing `AGENTS.md`, `SOUL.md`, `TOOLS.md`, skills
- **Auth profiles** (`~/.openclaw/agents/<agentId>/agent/auth-profiles.json`) with OAuth tokens and API keys
- **Session store** (`~/.openclaw/agents/<agentId>/sessions/`) for conversation history
- **Channel bindings** (`agents.bindings[]`) to route inbound messages

Multi-agent routing enables scenarios like:

- Work vs personal agent isolation
- Per-customer agent instances
- Dedicated rescue/fallback agents

Sources: [docs/cli/index.md 479-510](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L479-L510) [docs/start/wizard.md 162-180](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md#L162-L180)

### Agent Configuration Structure

**Binding resolution:**

1. Gateway extracts `channel` + `accountId` from inbound envelope
2. Matches against `agents.bindings[].bind` patterns (e.g., `whatsapp:biz`)
3. Routes to matched agent or falls back to `main`
4. Agent-specific workspace and auth are loaded

Sources: [docs/start/wizard.md 162-180](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md#L162-L180) [src/routing/agents.ts 1-200](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/routing/agents.ts#L1-L200)

---

## openclaw agents list - List Configured Agents

### Purpose

Display all configured agents with their workspace paths, bindings, and configuration overrides.

### Command Syntax

```
openclaw agents list [options]
```

### Options

| Option | Description |
| --- | --- |
| `--json` | Output JSON (includes full config details) |
| `--bindings` | Show channel bindings for each agent |

### Output Fields

| Field | Description |
| --- | --- |
| Agent ID | Unique identifier (e.g., `main`, `work`, `personal`) |
| Workspace | Workspace directory path |
| Model | Configured model (if overridden from defaults) |
| Bindings | Channel routing patterns (when `--bindings` is set) |

### Examples

```
# List all agents (human-readable)
openclaw agents list

# Show with channel bindings
openclaw agents list --bindings

# JSON output (for automation)
openclaw agents list --json
```

**Sample output:**

```
Agents:
  main
    Workspace: ~/.openclaw/workspace
    Model: anthropic/claude-opus-4-5
    
  work
    Workspace: ~/.openclaw/workspace-work
    Model: openai/gpt-5.2
    Bindings: whatsapp:biz, telegram:work
```

Sources: [docs/cli/index.md 479-488](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L479-L488)

---

## openclaw agents add - Create New Agents

### Purpose

Create a new isolated agent with a dedicated workspace, optional model configuration, and channel bindings. The command runs an interactive wizard unless non-interactive flags are provided.

### Command Syntax

```
openclaw agents add [name] [options]
```

### Arguments

| Argument | Description |
| --- | --- |
| `[name]` | Agent identifier (e.g., `work`, `personal`) |

### Options

| Option | Required (non-interactive) | Description |
| --- | --- | --- |
| `--workspace <dir>` | Yes | Workspace directory path |
| `--model <id>` | No | Override default model (e.g., `openai/gpt-5.2`) |
| `--agent-dir <dir>` | No | Agent state directory (default: `~/.openclaw/agents/<name>`) |
| `--bind <pattern>` | No | Channel binding (repeatable) |
| `--non-interactive` | No | Skip wizard (requires `--workspace`) |
| `--json` | No | Output JSON result |

### Channel Binding Patterns

Bindings use the format `channel[:accountId]`:

| Pattern | Matches |
| --- | --- |
| `whatsapp` | Default WhatsApp account |
| `whatsapp:biz` | WhatsApp account with ID `biz` |
| `telegram:alerts` | Telegram account with ID `alerts` |
| `discord:work` | Discord bot with ID `work` |

**Multiple bindings:**

- Use `--bind` multiple times: `--bind whatsapp:biz --bind telegram:work`
- Agent receives all inbound messages from matched channels

Sources: [docs/cli/index.md 489-502](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L489-L502) [docs/start/wizard.md 162-180](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md#L162-L180)

### Examples

**Interactive wizard (recommended for first-time setup):**

```
# Guided setup with prompts
openclaw agents add work
```

The wizard prompts for:

1. Workspace location (default: `~/.openclaw/workspace-<name>`)
2. Model override (or inherit from defaults)
3. Channel bindings (optional)
4. Confirmation

**Non-interactive (automation/scripts):**

```
# Minimal agent with workspace only
openclaw agents add work \
  --workspace ~/.openclaw/workspace-work \
  --non-interactive

# Agent with model override
openclaw agents add personal \
  --workspace ~/agents/personal \
  --model anthropic/claude-opus-4-5 \
  --non-interactive

# Agent with channel bindings
openclaw agents add work \
  --workspace ~/.openclaw/workspace-work \
  --model openai/gpt-5.2 \
  --bind whatsapp:biz \
  --bind telegram:work \
  --non-interactive \
  --json
```

**Configuration written:**

The command writes to `~/.openclaw/openclaw.json`:

```
{
  "agents": {
    "list": [
      {
        "id": "work",
        "workspace": "~/.openclaw/workspace-work",
        "model": "openai/gpt-5.2"
      }
    ],
    "bindings": [
      {
        "bind": "whatsapp:biz",
        "agent": "work"
      },
      {
        "bind": "telegram:work",
        "agent": "work"
      }
    ]
  }
}
```

Sources: [docs/cli/index.md 489-502](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L489-L502) [docs/start/wizard.md 162-180](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md#L162-L180)

### Workspace Initialization

When creating an agent, the workspace is seeded with bootstrap files:

| File | Purpose |
| --- | --- |
| `AGENTS.md` | Agent identity and behavior guidelines |
| `SOUL.md` | Personality and tone instructions |
| `TOOLS.md` | Available tool descriptions and usage examples |
| `skills/` | Optional skill modules (installed separately) |

These files are injected into the system prompt by the Pi Embedded Runner during agent execution.

Sources: [src/agents/piembeddedrunner.ts 100-200](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/agents/piembeddedrunner.ts#L100-L200) [docs/reference/templates/AGENTS](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/reference/templates/AGENTS)

---

## openclaw agents delete - Remove Agents

### Purpose

Delete an agent configuration and optionally remove its workspace and state directories.

### Command Syntax

```
openclaw agents delete <id> [options]
```

### Arguments

| Argument | Required | Description |
| --- | --- | --- |
| `<id>` | Yes | Agent identifier to delete |

### Options

| Option | Description |
| --- | --- |
| `--force` | Skip confirmation prompt |
| `--json` | Output JSON result |

### Deletion Scope

**Config cleanup:**

- Removes agent from `agents.list[]`
- Removes associated bindings from `agents.bindings[]`
- Preserves workspace and state directories by default

**Optional workspace/state removal:**

- The command prompts whether to delete workspace and agent state
- Use `--force` to auto-confirm without prompts

### Examples

```
# Delete agent (interactive confirmation)
openclaw agents delete work

# Force delete without prompt
openclaw agents delete work --force

# JSON output
openclaw agents delete work --force --json
```

**Sample interaction:**

```
Delete agent 'work'?
  Config: ~/.openclaw/openclaw.json
  Workspace: ~/.openclaw/workspace-work
  State: ~/.openclaw/agents/work

Remove workspace and state? [y/N]: y
Agent 'work' deleted.
```

Sources: [docs/cli/index.md 504-510](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L504-L510)

---

## Multi-Agent Binding Resolution

**Binding precedence:**

1. **Exact match**: `whatsapp:biz` matches channel `whatsapp` with account ID `biz`
2. **Channel-only match**: `telegram` matches any Telegram account
3. **Fallback**: No matches → use `main` agent

**Example routing table:**

| Inbound Message | Binding Match | Agent |
| --- | --- | --- |
| WhatsApp account `default` from +1234567890 | No explicit binding | `main` |
| WhatsApp account `biz` from +0987654321 | `whatsapp:biz` → `work` | `work` |
| Telegram bot `alerts` from user 12345 | `telegram:alerts` → `personal` | `personal` |
| Discord bot `work` from guild 67890 | `discord:work` → `work` | `work` |

Sources: [src/routing/agents.ts 1-200](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/routing/agents.ts#L1-L200) [docs/start/wizard.md 162-180](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/start/wizard.md#L162-L180)

---

## openclaw message send - Direct Messaging

### Purpose

Send messages directly to channels without invoking agent execution. Useful for:

- Testing channel connectivity
- Sending notifications/alerts
- Delivering pre-formatted content
- Bypassing agent processing

This is distinct from `openclaw agent --deliver`, which executes the agent first then delivers the response.

### Command Syntax

```
openclaw message send --target <target> --message <text> [options]
```

### Required Arguments

| Argument | Description |
| --- | --- |
| `--target <target>` | Destination identifier (phone number, channel ID, username) |
| `--message <text>` | Message text to send |

### Options

See [Message Commands](https://deepwiki.com/openclaw/openclaw/12.3-channel-commands) for the full `openclaw message` command reference including advanced options like reactions, editing, attachments, and channel-specific actions.

### Examples

```
# Send to WhatsApp contact
openclaw message send --target +15555550123 --message "Hello from OpenClaw"

# Send to Telegram chat
openclaw message send --channel telegram --target 123456789 --message "Alert: Service restarted"

# Send to Discord channel
openclaw message send --channel discord --target channel:1234567890 --message "Status update"
```

Sources: [docs/cli/index.md 438-460](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L438-L460) [README.md 189-194](https://github.com/openclaw/openclaw/blob/bf6ec64f/README.md#L189-L194)

---

## openclaw sessions - Session Management

### Purpose

List and query stored conversation sessions with filtering by activity, agent, and session type.

### Command Syntax

```
openclaw sessions [options]
```

### Options

| Option | Description | Default |
| --- | --- | --- |
| `--json` | Output JSON | Human-readable |
| `--verbose` | Include full session metadata | Summary only |
| `--store <path>` | Explicit session store path | Per-agent default |
| `--active <minutes>` | Filter to sessions active within N minutes | All sessions |

### Output Fields

| Field | Description |
| --- | --- |
| Session Key | Session identifier (e.g., `main`, `dm:whatsapp:+1234567890`, `group:telegram:12345`) |
| Agent | Associated agent ID |
| Last Activity | Timestamp of most recent message |
| Message Count | Total messages in session |
| Context Size | Approximate token count (if available) |

### Session Key Patterns

| Pattern | Description | Example |
| --- | --- | --- |
| `main` | Default direct interaction session | `main` |
| `dm:<channel>:<id>` | Channel-specific DM session | `dm:telegram:123456789` |
| `group:<channel>:<id>` | Group chat session | `group:whatsapp:12345@g.us` |

**Session isolation:**

- Each agent has a separate session store
- DM and group sessions are isolated by channel and identifier
- Sessions persist across Gateway restarts

Sources: [docs/cli/index.md 551-558](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L551-L558) [src/config/sessions.ts 1-100](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/sessions.ts#L1-L100)

### Examples

```
# List all sessions
openclaw sessions

# Show verbose session details
openclaw sessions --verbose

# Filter to recently active sessions (last 60 minutes)
openclaw sessions --active 60

# JSON output for automation
openclaw sessions --json
```

**Sample output:**

```
Sessions:
  main (agent: main)
    Last activity: 2 minutes ago
    Messages: 45
    Context: ~12K tokens
    
  dm:telegram:123456789 (agent: personal)
    Last activity: 1 hour ago
    Messages: 23
    Context: ~8K tokens
    
  group:whatsapp:12345@g.us (agent: work)
    Last activity: 5 hours ago
    Messages: 78
    Context: ~24K tokens (compacted)
```

Sources: [docs/cli/index.md 551-558](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L551-L558)

### Session Store Location

Sessions are stored per-agent under `~/.openclaw/agents/<agentId>/sessions/`:

```
~/.openclaw/agents/
├── main/
│   └── sessions/
│       ├── main.json
│       ├── dm_telegram_123456789.json
│       └── group_whatsapp_12345@g.us.json
└── work/
    └── sessions/
        ├── main.json
        └── group_discord_67890.json
```

**Session persistence:**

- JSON files contain message history, context state, and metadata
- Sessions are loaded on-demand during agent execution
- Automatic compaction when context exceeds model limits

Sources: [src/config/sessions.ts 1-100](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/config/sessions.ts#L1-L100) [docs/concepts/session.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/concepts/session.md)

---

## Integration with Gateway RPC

All agent commands communicate with the Gateway via WebSocket RPC when Gateway mode is used (default). The CLI establishes a connection, sends requests, and receives responses/events.

```
RPC Handlerrpc-handlers.tsGateway Serverserver.tsWebSocket Clientws://127.0.0.1:18789CLI ProcessRPC Handlerrpc-handlers.tsGateway Serverserver.tsWebSocket Clientws://127.0.0.1:18789CLI Processloop[Streaming Events]connect()auth token from configWebSocket handshakeValidate auth tokenHandshake completeRPC request{type:"req", method:"agent.run", params}Forward requestRoute to agent.run handlerValidate params, resolve agentExecute agent turnEvent: {type:"event", event:"agent.stream"}Forward eventEmit event to CLI handlerResponse: {type:"res", ok:true, payload}Forward responseResolve RPC promise
```

**Authentication:**

- Gateway auth token: `gateway.auth.token` or `OPENCLAW_GATEWAY_TOKEN`
- CLI loads token from config or environment
- Tailscale Serve identity bypass: `gateway.auth.allowTailscale`

**RPC methods used:**

- `agent.run` - Execute agent turn
- `agents.list` - List configured agents
- `agents.add` - Create new agent
- `agents.delete` - Remove agent
- `message.send` - Send direct message
- `sessions.list` - Query sessions

Sources: [src/gateway/server.ts 1-200](https://github.com/openclaw/openclaw/blob/bf6ec64f/src/gateway/server.ts#L1-L200) [docs/gateway/protocol.md](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/gateway/protocol.md)

---

### Common Issues

| Issue | Cause | Solution |
| --- | --- | --- |
| "No auth configured for provider" | Missing API keys or OAuth tokens in agent's auth store | Run `openclaw models auth setup-token` or re-run onboarding |
| "Gateway not responding" | Gateway not running or connection failure | Check `openclaw gateway status`, verify port and token |
| "Session not found" | Invalid session ID or key | Use `openclaw sessions` to list valid sessions |
| "Agent 'work' not found" | Agent ID doesn't exist in config | Verify with `openclaw agents list` |
| "Binding pattern already exists" | Duplicate binding in `agents.bindings[]` | Remove duplicate or modify pattern |

### Diagnostic Commands

```
# Check Gateway connectivity
openclaw gateway status
openclaw gateway probe

# Verify agent configuration
openclaw agents list --bindings --json

# Check session state
openclaw sessions --verbose

# View recent logs
openclaw logs --follow

# Full system status
openclaw status --all
```

Sources: [docs/gateway/troubleshooting.md 1-100](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/gateway/troubleshooting.md#L1-L100) [docs/cli/index.md 514-527](https://github.com/openclaw/openclaw/blob/bf6ec64f/docs/cli/index.md#L514-L527)

---

## See Also

- [Gateway Commands](https://deepwiki.com/openclaw/openclaw/12.1-gateway-commands) - Gateway service management and control
- [Channel Commands](https://deepwiki.com/openclaw/openclaw/12.3-channel-commands) - Channel setup and message routing
- [Agent System](https://deepwiki.com/openclaw/openclaw/5-agent-system) - Agent execution flow and internals
- [Multi-Agent Configuration](https://deepwiki.com/openclaw/openclaw/4.3-multi-agent-configuration) - Configuring isolated agents
- [Session Management](https://deepwiki.com/openclaw/openclaw/5.3-session-management) - Session lifecycle and context handling

<svg id="mermaid-fu8dstus3vp" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-7khuxtjp8f" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-5cnv3xfsc84" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-hmbioix2qbm" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg> <svg id="mermaid-z5tp3lz1enf" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 2412 512" style="max-width: 512px;" role="graphics-document document" aria-roledescription="error"><g></g><g><path class="error-icon" d="m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"></path><path class="error-icon" d="m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"></path><path class="error-icon" d="m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"></path><path class="error-icon" d="m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"></path><path class="error-icon" d="m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"></path><path class="error-icon" d="m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"></path><text class="error-text" x="1440" y="250" font-size="150px" style="text-anchor: middle;">Syntax error in text</text> <text class="error-text" x="1250" y="400" font-size="100px" style="text-anchor: middle;">mermaid version 11.12.2</text></g></svg>