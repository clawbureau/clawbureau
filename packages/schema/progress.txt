# Ralph Progress Log — packages/schema

Started: 2026-02-03

## AEM-US-001 — Schema v2: USD minor units + terminology normalization
- Added v2 schemas for bounties and escrow using `currency: "USD"` and integer-string `*_minor` fields.
- Added `min_proof_tier` enum (`self|gateway|sandbox`) and marked legacy `min_poh_tier`.
- Preserved all v1 schemas unchanged.

## AEM-US-002 — Identity rotation schema + golden vector fixture
- Added DID rotation certificate schema:
  - `packages/schema/identity/did_rotation.v1.json`
- Imported the Protocol M Phase 1 golden vector as a stable fixture for automated verification tests:
  - `packages/schema/fixtures/protocol-m-golden-vector.v1.json`
- Updated `packages/schema/README.md` to list the new identity schema.

## AEM-US-003 — PoH envelope schemas for strict verification
- Added PoH schemas for strict envelope/payload validation:
  - `packages/schema/poh/gateway_receipt.v1.json`
  - `packages/schema/poh/gateway_receipt_envelope.v1.json`
  - `packages/schema/poh/proof_bundle_envelope.v1.json`
- Tightened receipt binding validation inside proof bundles:
  - `packages/schema/poh/proof_bundle.v1.json` now references `receipt_binding.v1.json`.
- Updated `packages/schema/README.md` to list the new PoH schemas.

## CCO-US-021 — Work Policy Contract (WPC) schemas
- Added policy schemas for signed Work Policy Contracts:
  - `packages/schema/policy/work_policy_contract.v1.json`
  - `packages/schema/policy/work_policy_contract_envelope.v1.json`
- Updated `packages/schema/README.md` to include the new `policy/` directory + schemas.

## CWC-US-001 — Confidential Work Contract (CWC) schemas
- Added policy schemas for signed Confidential Work Contracts (buyer signs, worker countersigns):
  - `packages/schema/policy/confidential_work_contract.v1.json`
  - `packages/schema/policy/confidential_work_contract_envelope.v1.json`
- Updated `packages/schema/README.md` to list the new CWC schemas.

## CSC-US-001 — Scoped token claim hardening (token_scope_hash_b64u)
- Tightened CST claim schema:
  - `packages/schema/auth/scoped_token_claims.v1.json` now enforces SHA-256 base64url patterns for:
    - `policy_hash_b64u`
    - `token_scope_hash_b64u`
  - Documented the deterministic `token_scope_hash_b64u` derivation algorithm (JCS + sha256_b64u) in the schema description.

## POHVN-US-001..004 — PoH vNext schemas (model identity + verifiable audits)
- Added new PoH schemas to support tiered model identity and attestable audits:
  - `packages/schema/poh/model_identity.v1.json`
  - `packages/schema/poh/derivation_attestation.v1.json`
  - `packages/schema/poh/audit_result_attestation.v1.json`
  - `packages/schema/poh/log_inclusion_proof.v1.json`
- Updated receipt schema docs to standardize metadata attachment points:
  - `packages/schema/poh/gateway_receipt.v1.json`
  - `packages/schema/poh/proof_bundle.v1.json`
- Updated `packages/schema/README.md` to list the new PoH vNext schemas.

## POHVN-US-005 — WPC hooks: minimum model identity tier + required audit packs
- Extended the WPC payload schema:
  - `packages/schema/policy/work_policy_contract.v1.json`
  - Added optional fields:
    - `minimum_model_identity_tier`
    - `required_audit_packs[]` (audit_pack_hash_b64u)

## POHVN-US-004 — clawlogs inclusion proof golden vector fixture
- Added deterministic fixture for Merkle/proof/signature verification tests:
  - `packages/schema/fixtures/log_inclusion_proof_golden.v1.json`
- Updated `packages/schema/README.md` fixture list.

## POHVN-US-007 — audit-ready export bundle schemas + fixture
- Added export bundle schemas:
  - `packages/schema/poh/execution_attestation_envelope.v1.json`
  - `packages/schema/poh/export_bundle_manifest.v1.json`
  - `packages/schema/poh/export_bundle.v1.json`
- Added deterministic export-bundle fixture:
  - `packages/schema/fixtures/export_bundle_golden.v1.json`
