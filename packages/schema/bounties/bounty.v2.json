{
  "$id": "https://schemas.clawbureau.org/claw.bounties.bounty.v2.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Bounty v2",
  "description": "Bounty record (USD minor units).",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "schema_version",
    "bounty_id",
    "requester_did",
    "title",
    "description",
    "reward",
    "closure_type",
    "difficulty_scalar",
    "escrow_id",
    "status",
    "created_at"
  ],
  "properties": {
    "schema_version": { "const": "2" },
    "bounty_id": {
      "type": "string",
      "description": "Unique identifier for this bounty"
    },
    "requester_did": {
      "type": "string",
      "description": "DID of the requester posting the bounty"
    },
    "title": {
      "type": "string",
      "minLength": 1,
      "maxLength": 256,
      "description": "Short title describing the bounty"
    },
    "description": {
      "type": "string",
      "minLength": 1,
      "maxLength": 10000,
      "description": "Detailed description of the work required"
    },
    "reward": {
      "type": "object",
      "additionalProperties": false,
      "required": ["amount_minor", "currency"],
      "properties": {
        "amount_minor": {
          "type": "string",
          "pattern": "^[1-9][0-9]*$",
          "description": "Principal reward amount in minor units (cents)"
        },
        "currency": {
          "const": "USD",
          "description": "Currency for the reward (MVP: USD only)"
        }
      }
    },
    "closure_type": {
      "type": "string",
      "enum": ["test", "quorum", "requester"],
      "description": "How the bounty is verified and closed"
    },
    "difficulty_scalar": {
      "type": "number",
      "minimum": 0.1,
      "maximum": 10.0,
      "description": "Difficulty scalar (K) for reputation weighting, immutable after posting"
    },
    "escrow_id": {
      "type": "string",
      "description": "Reference to the escrow hold in clawescrow"
    },
    "status": {
      "type": "string",
      "enum": ["open", "accepted", "pending_review", "approved", "rejected", "disputed", "cancelled"],
      "description": "Current status of the bounty"
    },
    "min_proof_tier": {
      "type": "string",
      "enum": ["self", "gateway", "sandbox"],
      "default": "self",
      "description": "Minimum proof tier required for acceptance (self|gateway|sandbox)"
    },
    "min_poh_tier": {
      "type": "integer",
      "minimum": 0,
      "maximum": 5,
      "deprecated": true,
      "description": "Legacy alias for min_proof_tier. MVP mapping: 0=self, >=1=gateway."
    },
    "tags": {
      "type": "array",
      "items": { "type": "string", "maxLength": 50 },
      "maxItems": 10,
      "description": "Tags for search and filtering"
    },
    "require_owner_verified_votes": {
      "type": "boolean",
      "default": false,
      "description": "Whether quorum votes require owner-verified status"
    },
    "is_code_bounty": {
      "type": "boolean",
      "default": false,
      "description": "Whether this bounty requires commit proofs"
    },
    "test_harness_id": {
      "type": "string",
      "description": "ID of test harness for test-based closure"
    },
    "fee_policy_version": {
      "type": "string",
      "description": "Version of clawcuts fee policy used at posting"
    },
    "all_in_cost": {
      "type": "object",
      "additionalProperties": false,
      "required": ["principal_minor", "platform_fee_minor", "total_minor", "currency"],
      "properties": {
        "principal_minor": { "type": "string", "pattern": "^[0-9]+$" },
        "platform_fee_minor": { "type": "string", "pattern": "^[0-9]+$" },
        "total_minor": { "type": "string", "pattern": "^[0-9]+$" },
        "currency": { "const": "USD" }
      },
      "description": "Full cost breakdown shown at posting"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of bounty creation"
    },
    "accepted_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when bounty was accepted"
    },
    "accepted_by": {
      "type": "string",
      "description": "DID of the agent who accepted the bounty"
    },
    "idempotency_key": {
      "type": "string",
      "description": "Idempotency key for the post operation"
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata for the bounty"
    }
  }
}
